<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" />

    <!-- Generated with Sphinx 7.2.6 and Furo 2024.01.29 -->
        <title>arkouda.dataframe - arkouda documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">arkouda  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  
  <span class="sidebar-brand-text">arkouda  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../setup/REQUIREMENTS.html">Requirements</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../setup/install_menu.html">Installation</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Installation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../setup/LINUX_INSTALL.html">Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../setup/WINDOWS_INSTALL.html">Windows (WSL2)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../setup/MAC_INSTALL.html">MacOS</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../setup/BUILD.html">Building the Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../setup/MODULAR.html">Modular Server Builds</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../setup/testing.html">Performance Testing</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../file_io/io_menu.html">File I/O</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of File I/O</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../file_io/HDF5.html">HDF5</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../file_io/PARQUET.html">Parquet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../file_io/CSV.html">CSV</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../file_io/IMPORT_EXPORT.html">Import/Export</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../usage.html">Usage Guide</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Usage Guide</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../usage/startup.html">Startup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/pdarray.html">The <code class="docutils literal notranslate"><span class="pre">pdarray</span></code> class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/creation.html">Creating Arrays</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/arithmetic.html">Arithmetic and Numeric Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/indexing.html">Indexing and Assignment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/histogram.html">Summarizing Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/argsort.html">Sorting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/setops.html">Array Set Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/groupby.html">GroupBy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/strings.html">Strings in Arkouda</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/categorical.html">Categoricals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/segarray.html">SegArrays in Arkouda</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/arrayview.html">ArrayView in Arkouda</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CONTRIBUTING_LINK.html">Contributing</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../autoapi/index.html">API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of API Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../autoapi/arkouda/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">arkouda</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of arkouda</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../autoapi/arkouda/akscipy/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">arkouda.akscipy</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of arkouda.akscipy</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../autoapi/arkouda/akscipy/special/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">arkouda.akscipy.special</span></code></a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../autoapi/arkouda/array_api/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">arkouda.array_api</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of arkouda.array_api</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../autoapi/arkouda/array_api/linalg/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">arkouda.array_api.linalg</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/arkouda/random/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">arkouda.random</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/arkouda/accessor/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">arkouda.accessor</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/arkouda/alignment/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">arkouda.alignment</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/arkouda/array_view/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">arkouda.array_view</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/arkouda/categorical/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">arkouda.categorical</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/arkouda/client/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">arkouda.client</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/arkouda/client_dtypes/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">arkouda.client_dtypes</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/arkouda/dataframe/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">arkouda.dataframe</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/arkouda/dtypes/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">arkouda.dtypes</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/arkouda/groupbyclass/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">arkouda.groupbyclass</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/arkouda/history/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">arkouda.history</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/arkouda/index/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">arkouda.index</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/arkouda/infoclass/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">arkouda.infoclass</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/arkouda/io/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">arkouda.io</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/arkouda/io_util/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">arkouda.io_util</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/arkouda/join/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">arkouda.join</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/arkouda/logger/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">arkouda.logger</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/arkouda/match/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">arkouda.match</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/arkouda/matcher/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">arkouda.matcher</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/arkouda/numeric/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">arkouda.numeric</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/arkouda/pdarrayclass/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">arkouda.pdarrayclass</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/arkouda/pdarraycreation/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">arkouda.pdarraycreation</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/arkouda/pdarraysetops/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">arkouda.pdarraysetops</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/arkouda/plotting/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">arkouda.plotting</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/arkouda/row/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">arkouda.row</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/arkouda/security/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">arkouda.security</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/arkouda/segarray/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">arkouda.segarray</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/arkouda/series/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">arkouda.series</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/arkouda/sorting/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">arkouda.sorting</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/arkouda/strings/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">arkouda.strings</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/arkouda/timeclass/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">arkouda.timeclass</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/arkouda/util/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">arkouda.util</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../server/index.html">Chapel API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../genindex.html">Index</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../developer/dev_menu.html">Developer Documentation</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of Developer Documentation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../developer/TIPS.html">Speeding up Arkouda Compilation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developer/USER_BUGS.html">Tips for Reproducing User Bugs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developer/MEMORY.html">Reducing Memory Usage of Arkouda Builds</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developer/GASNET.html">GASNet Development</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developer/RELEASE_PROCESS.html">Release Process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developer/BENCHMARK.html">PyTest Benchmarks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developer/ADDING_FEATURES.html">Adding Your First Feature</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <h1>Source code for arkouda.dataframe</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>

<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">UserDict</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">cast</span>
<span class="kn">from</span> <span class="nn">warnings</span> <span class="kn">import</span> <span class="n">warn</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>  <span class="c1"># type: ignore</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>  <span class="c1"># type: ignore</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">ndarray</span>
<span class="kn">from</span> <span class="nn">typeguard</span> <span class="kn">import</span> <span class="n">typechecked</span>

<span class="kn">from</span> <span class="nn">arkouda.categorical</span> <span class="kn">import</span> <span class="n">Categorical</span>
<span class="kn">from</span> <span class="nn">arkouda.client</span> <span class="kn">import</span> <span class="n">generic_msg</span><span class="p">,</span> <span class="n">maxTransferBytes</span>
<span class="kn">from</span> <span class="nn">arkouda.client_dtypes</span> <span class="kn">import</span> <span class="n">BitVector</span><span class="p">,</span> <span class="n">Fields</span><span class="p">,</span> <span class="n">IPv4</span>
<span class="kn">from</span> <span class="nn">arkouda.dtypes</span> <span class="kn">import</span> <span class="n">BigInt</span>
<span class="kn">from</span> <span class="nn">arkouda.dtypes</span> <span class="kn">import</span> <span class="nb">bool</span> <span class="k">as</span> <span class="n">akbool</span>
<span class="kn">from</span> <span class="nn">arkouda.dtypes</span> <span class="kn">import</span> <span class="n">float64</span> <span class="k">as</span> <span class="n">akfloat64</span>
<span class="kn">from</span> <span class="nn">arkouda.dtypes</span> <span class="kn">import</span> <span class="n">int64</span> <span class="k">as</span> <span class="n">akint64</span>
<span class="kn">from</span> <span class="nn">arkouda.dtypes</span> <span class="kn">import</span> <span class="n">uint64</span> <span class="k">as</span> <span class="n">akuint64</span>
<span class="kn">from</span> <span class="nn">arkouda.groupbyclass</span> <span class="kn">import</span> <span class="n">GROUPBY_REDUCTION_TYPES</span>
<span class="kn">from</span> <span class="nn">arkouda.groupbyclass</span> <span class="kn">import</span> <span class="n">GroupBy</span> <span class="k">as</span> <span class="n">akGroupBy</span>
<span class="kn">from</span> <span class="nn">arkouda.groupbyclass</span> <span class="kn">import</span> <span class="n">unique</span>
<span class="kn">from</span> <span class="nn">arkouda.index</span> <span class="kn">import</span> <span class="n">Index</span><span class="p">,</span> <span class="n">MultiIndex</span>
<span class="kn">from</span> <span class="nn">arkouda.join</span> <span class="kn">import</span> <span class="n">inner_join</span>
<span class="kn">from</span> <span class="nn">arkouda.numeric</span> <span class="kn">import</span> <span class="n">cast</span> <span class="k">as</span> <span class="n">akcast</span>
<span class="kn">from</span> <span class="nn">arkouda.numeric</span> <span class="kn">import</span> <span class="n">cumsum</span><span class="p">,</span> <span class="n">where</span>
<span class="kn">from</span> <span class="nn">arkouda.pdarrayclass</span> <span class="kn">import</span> <span class="n">RegistrationError</span><span class="p">,</span> <span class="n">pdarray</span>
<span class="kn">from</span> <span class="nn">arkouda.pdarraycreation</span> <span class="kn">import</span> <span class="n">arange</span><span class="p">,</span> <span class="n">array</span><span class="p">,</span> <span class="n">create_pdarray</span><span class="p">,</span> <span class="n">full</span><span class="p">,</span> <span class="n">zeros</span>
<span class="kn">from</span> <span class="nn">arkouda.pdarraysetops</span> <span class="kn">import</span> <span class="n">concatenate</span><span class="p">,</span> <span class="n">in1d</span><span class="p">,</span> <span class="n">intersect1d</span>
<span class="kn">from</span> <span class="nn">arkouda.row</span> <span class="kn">import</span> <span class="n">Row</span>
<span class="kn">from</span> <span class="nn">arkouda.segarray</span> <span class="kn">import</span> <span class="n">SegArray</span>
<span class="kn">from</span> <span class="nn">arkouda.series</span> <span class="kn">import</span> <span class="n">Series</span>
<span class="kn">from</span> <span class="nn">arkouda.sorting</span> <span class="kn">import</span> <span class="n">argsort</span><span class="p">,</span> <span class="n">coargsort</span>
<span class="kn">from</span> <span class="nn">arkouda.strings</span> <span class="kn">import</span> <span class="n">Strings</span>
<span class="kn">from</span> <span class="nn">arkouda.timeclass</span> <span class="kn">import</span> <span class="n">Datetime</span><span class="p">,</span> <span class="n">Timedelta</span>

<span class="c1"># This is necessary for displaying DataFrames with BitVector columns,</span>
<span class="c1"># because pandas _html_repr automatically truncates the number of displayed bits</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;display.max_colwidth&quot;</span><span class="p">,</span> <span class="mi">65</span><span class="p">)</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;DataFrame&quot;</span><span class="p">,</span>
    <span class="s2">&quot;DiffAggregate&quot;</span><span class="p">,</span>
    <span class="s2">&quot;intersect&quot;</span><span class="p">,</span>
    <span class="s2">&quot;invert_permutation&quot;</span><span class="p">,</span>
    <span class="s2">&quot;intx&quot;</span><span class="p">,</span>
    <span class="s2">&quot;merge&quot;</span><span class="p">,</span>
<span class="p">]</span>


<span class="k">def</span> <span class="nf">groupby_operators</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">GROUPBY_REDUCTION_TYPES</span><span class="p">:</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_make_aggop</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
    <span class="k">return</span> <span class="bp">cls</span>


<span class="nd">@groupby_operators</span>
<span class="k">class</span> <span class="nc">GroupBy</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A DataFrame that has been grouped by a subset of columns.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    gb_key_names : str or list(str), default=None</span>
<span class="sd">        The column name(s) associated with the aggregated columns.</span>
<span class="sd">    as_index : bool, default=True</span>
<span class="sd">        If True, interpret aggregated column as index</span>
<span class="sd">        (only implemented for single dimensional aggregates).</span>
<span class="sd">        Otherwise, treat aggregated column as a dataframe column.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    gb : arkouda.groupbyclass.GroupBy</span>
<span class="sd">        GroupBy object, where the aggregation keys are values of column(s) of a dataframe,</span>
<span class="sd">        usually in preparation for aggregating with respect to the other columns.</span>
<span class="sd">    df : arkouda.dataframe.DataFrame</span>
<span class="sd">        The dataframe containing the original data.</span>
<span class="sd">    gb_key_names : str or list(str)</span>
<span class="sd">        The column name(s) associated with the aggregated columns.</span>
<span class="sd">    as_index : bool, default=True</span>
<span class="sd">        If True the grouped values of the aggregation keys will be treated as an index.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gb</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">gb_key_names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gb</span> <span class="o">=</span> <span class="n">gb</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gb_key_names</span> <span class="o">=</span> <span class="n">gb_key_names</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">as_index</span> <span class="o">=</span> <span class="n">as_index</span>
        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;nkeys&quot;</span><span class="p">,</span> <span class="s2">&quot;permutation&quot;</span><span class="p">,</span> <span class="s2">&quot;unique_keys&quot;</span><span class="p">,</span> <span class="s2">&quot;segments&quot;</span><span class="p">]:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">gb</span><span class="p">,</span> <span class="n">attr</span><span class="p">))</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_make_aggop</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">opname</span><span class="p">):</span>
        <span class="n">numerical_dtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">akfloat64</span><span class="p">,</span> <span class="n">akint64</span><span class="p">,</span> <span class="n">akuint64</span><span class="p">]</span>

        <span class="k">def</span> <span class="nf">aggop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">colnames</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Aggregate the operation, with the grouped column(s) values as keys.</span>

<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>

<span class="sd">            colnames : (list of) str, default=None</span>
<span class="sd">                Column name or list of column names to compute the aggregation over.</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            arkouda.dataframe.DataFrame</span>

<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="n">colnames</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">colnames</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">colnames</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">colnames</span> <span class="o">=</span> <span class="p">[</span><span class="n">colnames</span><span class="p">]</span>
            <span class="n">colnames</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">c</span>
                <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">colnames</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">type</span> <span class="ow">in</span> <span class="n">numerical_dtypes</span><span class="p">)</span>
                    <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">BigInt</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="ow">and</span> <span class="p">(</span>
                    <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gb_key_names</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">c</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gb_key_names</span><span class="p">))</span>
                    <span class="ow">or</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gb_key_names</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="n">c</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gb_key_names</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="p">]</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">colnames</span><span class="p">,</span> <span class="n">List</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gb_key_names</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span>
                        <span class="p">{</span><span class="n">c</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">gb</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">c</span><span class="p">],</span> <span class="n">opname</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">colnames</span><span class="p">},</span>
                        <span class="n">index</span><span class="o">=</span><span class="n">Index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gb</span><span class="o">.</span><span class="n">unique_keys</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gb_key_names</span><span class="p">),</span>
                    <span class="p">)</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gb_key_names</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gb_key_names</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span>
                        <span class="p">{</span><span class="n">c</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">gb</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">c</span><span class="p">],</span> <span class="n">opname</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">colnames</span><span class="p">},</span>
                        <span class="n">index</span><span class="o">=</span><span class="n">Index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gb</span><span class="o">.</span><span class="n">unique_keys</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gb_key_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                    <span class="p">)</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gb_key_names</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="n">column_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gb_key_names</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unique_keys</span><span class="p">))</span>
                    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">colnames</span><span class="p">:</span>
                        <span class="n">column_dict</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gb</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">c</span><span class="p">],</span> <span class="n">opname</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">column_dict</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">aggop</span>

    <span class="k">def</span> <span class="nf">count</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">as_series</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute the count of each value as the total number of rows, including NaN values.</span>
<span class="sd">        This is an alias for size(), and may change in the future.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        as_series : bool, default=None</span>
<span class="sd">            Indicates whether to return arkouda.dataframe.DataFrame (if as_series = False) or</span>
<span class="sd">            arkouda.series.Series (if as_series = True)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        arkouda.dataframe.DataFrame or arkouda.series.Series</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; import arkouda as ak</span>
<span class="sd">        &gt;&gt;&gt; ak.connect()</span>
<span class="sd">        &gt;&gt;&gt; df = ak.DataFrame({&quot;A&quot;:[1,2,2,3],&quot;B&quot;:[3,4,5,6]})</span>
<span class="sd">        &gt;&gt;&gt; display(df)</span>

<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |    |   A |   B |</span>
<span class="sd">        +====+=====+=====+</span>
<span class="sd">        |  0 |   1 |   3 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  1 |   2 |   4 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  2 |   2 |   5 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  3 |   3 |   6 |</span>
<span class="sd">        +----+-----+-----+</span>

<span class="sd">        &gt;&gt;&gt; df.groupby(&quot;A&quot;).count(as_series = False)</span>

<span class="sd">        +----+---------+</span>
<span class="sd">        |    |   count |</span>
<span class="sd">        +====+=========+</span>
<span class="sd">        |  0 |       1 |</span>
<span class="sd">        +----+---------+</span>
<span class="sd">        |  1 |       2 |</span>
<span class="sd">        +----+---------+</span>
<span class="sd">        |  2 |       1 |</span>
<span class="sd">        +----+---------+</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">as_series</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">or</span> <span class="p">(</span><span class="n">as_series</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">as_index</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_return_agg_series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gb</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_return_agg_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gb</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="s2">&quot;count&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">as_series</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sort_index</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute the size of each value as the total number of rows, including NaN values.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        as_series : bool, default=None</span>
<span class="sd">            Indicates whether to return arkouda.dataframe.DataFrame (if as_series = False) or</span>
<span class="sd">            arkouda.series.Series (if as_series = True)</span>
<span class="sd">        sort_index : bool, default=True</span>
<span class="sd">            If True, results will be returned with index values sorted in ascending order.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        arkouda.dataframe.DataFrame or arkouda.series.Series</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; import arkouda as ak</span>
<span class="sd">        &gt;&gt;&gt; ak.connect()</span>
<span class="sd">        &gt;&gt;&gt; df = ak.DataFrame({&quot;A&quot;:[1,2,2,3],&quot;B&quot;:[3,4,5,6]})</span>
<span class="sd">        &gt;&gt;&gt; display(df)</span>

<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |    |   A |   B |</span>
<span class="sd">        +====+=====+=====+</span>
<span class="sd">        |  0 |   1 |   3 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  1 |   2 |   4 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  2 |   2 |   5 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  3 |   3 |   6 |</span>
<span class="sd">        +----+-----+-----+</span>

<span class="sd">        &gt;&gt;&gt; df.groupby(&quot;A&quot;).size(as_series = False)</span>

<span class="sd">        +----+---------+</span>
<span class="sd">        |    |   size  |</span>
<span class="sd">        +====+=========+</span>
<span class="sd">        |  0 |       1 |</span>
<span class="sd">        +----+---------+</span>
<span class="sd">        |  1 |       2 |</span>
<span class="sd">        +----+---------+</span>
<span class="sd">        |  2 |       1 |</span>
<span class="sd">        +----+---------+</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">as_series</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">or</span> <span class="p">(</span><span class="n">as_series</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">as_index</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_return_agg_series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gb</span><span class="o">.</span><span class="n">size</span><span class="p">(),</span> <span class="n">sort_index</span><span class="o">=</span><span class="n">sort_index</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_return_agg_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gb</span><span class="o">.</span><span class="n">size</span><span class="p">(),</span> <span class="s2">&quot;size&quot;</span><span class="p">,</span> <span class="n">sort_index</span><span class="o">=</span><span class="n">sort_index</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_return_agg_series</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">sort_index</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">as_index</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gb_key_names</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">series</span> <span class="o">=</span> <span class="n">Series</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">Index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gb</span><span class="o">.</span><span class="n">unique_keys</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gb_key_names</span><span class="p">))</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gb_key_names</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gb_key_names</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">series</span> <span class="o">=</span> <span class="n">Series</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">Index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gb</span><span class="o">.</span><span class="n">unique_keys</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gb_key_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gb_key_names</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gb_key_names</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="kn">from</span> <span class="nn">arkouda.index</span> <span class="kn">import</span> <span class="n">MultiIndex</span>

                <span class="n">series</span> <span class="o">=</span> <span class="n">Series</span><span class="p">(</span>
                    <span class="n">values</span><span class="p">,</span>
                    <span class="n">index</span><span class="o">=</span><span class="n">MultiIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gb</span><span class="o">.</span><span class="n">unique_keys</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gb_key_names</span><span class="p">),</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">series</span> <span class="o">=</span> <span class="n">Series</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">sort_index</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">series</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">series</span>

    <span class="k">def</span> <span class="nf">_return_agg_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">sort_index</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gb_key_names</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">as_index</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">df</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span>
                    <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">]},</span>
                    <span class="n">index</span><span class="o">=</span><span class="n">Index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gb</span><span class="o">.</span><span class="n">unique_keys</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gb_key_names</span><span class="p">),</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">df</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">({</span><span class="bp">self</span><span class="o">.</span><span class="n">gb_key_names</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">gb</span><span class="o">.</span><span class="n">unique_keys</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">]})</span>

            <span class="k">if</span> <span class="n">sort_index</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>

            <span class="k">return</span> <span class="n">df</span>

        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gb_key_names</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">as_index</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">df</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span>
                    <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">]},</span>
                    <span class="n">index</span><span class="o">=</span><span class="n">Index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gb</span><span class="o">.</span><span class="n">unique_keys</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gb_key_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">df</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span>
                    <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">gb_key_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="bp">self</span><span class="o">.</span><span class="n">gb</span><span class="o">.</span><span class="n">unique_keys</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">]},</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="n">sort_index</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>

            <span class="k">return</span> <span class="n">df</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Series</span><span class="p">(</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">(</span><span class="n">index_labels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gb_key_names</span><span class="p">,</span> <span class="n">value_label</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">diff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">colname</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a difference aggregate for the given column.</span>

<span class="sd">        For each group, the difference between successive values is calculated.</span>
<span class="sd">        Aggregate operations (mean,min,max,std,var) can be done on the results.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        colname:  str</span>
<span class="sd">            Name of the column to compute the difference on.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        DiffAggregate</span>
<span class="sd">            Object containing the differences, which can be aggregated.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; import arkouda as ak</span>
<span class="sd">        &gt;&gt;&gt; ak.connect()</span>
<span class="sd">        &gt;&gt;&gt; df = ak.DataFrame({&quot;A&quot;:[1,2,2,2,3,3],&quot;B&quot;:[3,9,11,27,86,100]})</span>
<span class="sd">        &gt;&gt;&gt; display(df)</span>

<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |    |   A |   B |</span>
<span class="sd">        +====+=====+=====+</span>
<span class="sd">        |  0 |   1 |   3 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  1 |   2 |   9 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  2 |   2 |  11 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  3 |   2 |  27 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  4 |   3 |  86 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  5 |   3 | 100 |</span>
<span class="sd">        +----+-----+-----+</span>

<span class="sd">        &gt;&gt;&gt; gb = df.groupby(&quot;A&quot;)</span>
<span class="sd">        &gt;&gt;&gt; gb.diff(&quot;B&quot;).values</span>
<span class="sd">        array([nan nan 2.00000000000000000 16.00000000000000000 nan 14.00000000000000000])</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">DiffAggregate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gb</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">colname</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">broadcast</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">permute</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fill each groups segment with a constant value.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x :  Series or pdarray</span>
<span class="sd">            The values to put in each groups segment.</span>
<span class="sd">        permute : bool, default=True</span>
<span class="sd">            If True (default), permute broadcast values back to the</span>
<span class="sd">            ordering of the original array on which GroupBy was called.</span>
<span class="sd">            If False, the broadcast values are grouped by value.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        arkouda.series.Series</span>
<span class="sd">            A Series with the Index of the original frame and the values of the broadcast.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; import arkouda as ak</span>
<span class="sd">        &gt;&gt;&gt; ak.connect()</span>
<span class="sd">        &gt;&gt;&gt; from arkouda.dataframe import GroupBy</span>
<span class="sd">        &gt;&gt;&gt; df = ak.DataFrame({&quot;A&quot;:[1,2,2,3],&quot;B&quot;:[3,4,5,6]})</span>

<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |    |   A |   B |</span>
<span class="sd">        +====+=====+=====+</span>
<span class="sd">        |  0 |   1 |   3 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  1 |   2 |   4 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  2 |   2 |   5 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  3 |   3 |   6 |</span>
<span class="sd">        +----+-----+-----+</span>

<span class="sd">        &gt;&gt;&gt; gb = df.groupby(&quot;A&quot;)</span>
<span class="sd">        &gt;&gt;&gt; x = ak.array([10,11,12])</span>
<span class="sd">        &gt;&gt;&gt; s = GroupBy.broadcast(gb, x)</span>
<span class="sd">        &gt;&gt;&gt; df[&quot;C&quot;] = s.values</span>
<span class="sd">        &gt;&gt;&gt; display(df)</span>

<span class="sd">        +----+-----+-----+-----+</span>
<span class="sd">        |    |   A |   B |   C |</span>
<span class="sd">        +====+=====+=====+=====+</span>
<span class="sd">        |  0 |   1 |   3 |  10 |</span>
<span class="sd">        +----+-----+-----+-----+</span>
<span class="sd">        |  1 |   2 |   4 |  11 |</span>
<span class="sd">        +----+-----+-----+-----+</span>
<span class="sd">        |  2 |   2 |   5 |  11 |</span>
<span class="sd">        +----+-----+-----+-----+</span>
<span class="sd">        |  3 |   3 |   6 |  12 |</span>
<span class="sd">        +----+-----+-----+-----+</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Series</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gb</span><span class="o">.</span><span class="n">broadcast</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">permute</span><span class="o">=</span><span class="n">permute</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gb</span><span class="o">.</span><span class="n">broadcast</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">permute</span><span class="o">=</span><span class="n">permute</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>


<div class="viewcode-block" id="DiffAggregate">
<a class="viewcode-back" href="../../autoapi/arkouda/index.html#arkouda.dataframe.DiffAggregate">[docs]</a>
<span class="nd">@groupby_operators</span>
<span class="k">class</span> <span class="nc">DiffAggregate</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A column in a GroupBy that has been differenced.</span>
<span class="sd">    Aggregation operations can be done on the result.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    gb : arkouda.groupbyclass.GroupBy</span>
<span class="sd">        GroupBy object, where the aggregation keys are values of column(s) of a dataframe.</span>
<span class="sd">    values : arkouda.series.Series.</span>
<span class="sd">        A column to compute the difference on.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gb</span><span class="p">,</span> <span class="n">series</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gb</span> <span class="o">=</span> <span class="n">gb</span>

        <span class="n">values</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">series</span><span class="p">),</span> <span class="s2">&quot;float64&quot;</span><span class="p">)</span>
        <span class="n">series_permuted</span> <span class="o">=</span> <span class="n">series</span><span class="p">[</span><span class="n">gb</span><span class="o">.</span><span class="n">permutation</span><span class="p">]</span>
        <span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">akcast</span><span class="p">(</span><span class="n">series_permuted</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">series_permuted</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;float64&quot;</span><span class="p">)</span>
        <span class="n">values</span><span class="p">[</span><span class="n">gb</span><span class="o">.</span><span class="n">segments</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="n">values</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_make_aggop</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">opname</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">aggop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gb</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">opname</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">aggop</span></div>



<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">DataFrame structure based on Arkouda arrays.</span>
<span class="sd">&quot;&quot;&quot;</span>


<div class="viewcode-block" id="DataFrame">
<a class="viewcode-back" href="../../usage/dataframe.html#arkouda.dataframe.DataFrame">[docs]</a>
<span class="k">class</span> <span class="nc">DataFrame</span><span class="p">(</span><span class="n">UserDict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A DataFrame structure based on arkouda arrays.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    initialdata : List or dictionary of lists, tuples, or pdarrays</span>
<span class="sd">        Each list/dictionary entry corresponds to one column of the data and</span>
<span class="sd">        should be a homogenous type. Different columns may have different</span>
<span class="sd">        types. If using a dictionary, keys should be strings.</span>

<span class="sd">    index : Index, pdarray, or Strings</span>
<span class="sd">        Index for the resulting frame. Defaults to an integer range.</span>

<span class="sd">    columns : List, tuple, pdarray, or Strings</span>
<span class="sd">        Column labels to use if the data does not include them. Elements must</span>
<span class="sd">        be strings. Defaults to an stringified integer range.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    Create an empty DataFrame and add a column of data:</span>

<span class="sd">    &gt;&gt;&gt; import arkouda as ak</span>
<span class="sd">    &gt;&gt;&gt; ak.connect()</span>
<span class="sd">    &gt;&gt;&gt; df = ak.DataFrame()</span>
<span class="sd">    &gt;&gt;&gt; df[&#39;a&#39;] = ak.array([1,2,3])</span>
<span class="sd">    &gt;&gt;&gt; display(df)</span>

<span class="sd">    +----+-----+</span>
<span class="sd">    |    |   a |</span>
<span class="sd">    +====+=====+</span>
<span class="sd">    |  0 |   1 |</span>
<span class="sd">    +----+-----+</span>
<span class="sd">    |  1 |   2 |</span>
<span class="sd">    +----+-----+</span>
<span class="sd">    |  2 |   3 |</span>
<span class="sd">    +----+-----+</span>

<span class="sd">    Create a new DataFrame using a dictionary of data:</span>

<span class="sd">    &gt;&gt;&gt; userName = ak.array([&#39;Alice&#39;, &#39;Bob&#39;, &#39;Alice&#39;, &#39;Carol&#39;, &#39;Bob&#39;, &#39;Alice&#39;])</span>
<span class="sd">    &gt;&gt;&gt; userID = ak.array([111, 222, 111, 333, 222, 111])</span>
<span class="sd">    &gt;&gt;&gt; item = ak.array([0, 0, 1, 1, 2, 0])</span>
<span class="sd">    &gt;&gt;&gt; day = ak.array([5, 5, 6, 5, 6, 6])</span>
<span class="sd">    &gt;&gt;&gt; amount = ak.array([0.5, 0.6, 1.1, 1.2, 4.3, 0.6])</span>
<span class="sd">    &gt;&gt;&gt; df = ak.DataFrame({&#39;userName&#39;: userName, &#39;userID&#39;: userID,</span>
<span class="sd">    &gt;&gt;&gt;            &#39;item&#39;: item, &#39;day&#39;: day, &#39;amount&#39;: amount})</span>
<span class="sd">    &gt;&gt;&gt; display(df)</span>

<span class="sd">    +----+------------+----------+--------+-------+----------+</span>
<span class="sd">    |    | userName   |   userID |   item |   day |   amount |</span>
<span class="sd">    +====+============+==========+========+=======+==========+</span>
<span class="sd">    |  0 | Alice      |      111 |      0 |     5 |      0.5 |</span>
<span class="sd">    +----+------------+----------+--------+-------+----------+</span>
<span class="sd">    |  1 | Bob        |      222 |      0 |     5 |      0.6 |</span>
<span class="sd">    +----+------------+----------+--------+-------+----------+</span>
<span class="sd">    |  2 | Alice      |      111 |      1 |     6 |      1.1 |</span>
<span class="sd">    +----+------------+----------+--------+-------+----------+</span>
<span class="sd">    |  3 | Carol      |      333 |      1 |     5 |      1.2 |</span>
<span class="sd">    +----+------------+----------+--------+-------+----------+</span>
<span class="sd">    |  4 | Bob        |      222 |      2 |     6 |      4.3 |</span>
<span class="sd">    +----+------------+----------+--------+-------+----------+</span>
<span class="sd">    |  5 | Alice      |      111 |      0 |     6 |      0.6 |</span>
<span class="sd">    +----+------------+----------+--------+-------+----------+</span>

<span class="sd">    Indexing works slightly differently than with pandas:</span>

<span class="sd">    &gt;&gt;&gt; df[0]</span>

<span class="sd">    +------------+----------+</span>
<span class="sd">    | keys       |   values |</span>
<span class="sd">    +============+==========+</span>
<span class="sd">    | userName   |    Alice |</span>
<span class="sd">    +------------+----------+</span>
<span class="sd">    |userID      |      111 |</span>
<span class="sd">    +------------+----------+</span>
<span class="sd">    | item       |      0   |</span>
<span class="sd">    +------------+----------+</span>
<span class="sd">    | day        |      5   |</span>
<span class="sd">    +------------+----------+</span>
<span class="sd">    | amount     |     0.5  |</span>
<span class="sd">    +------------+----------+</span>

<span class="sd">    &gt;&gt;&gt; df[&#39;userID&#39;]</span>
<span class="sd">    array([111, 222, 111, 333, 222, 111])</span>

<span class="sd">    &gt;&gt;&gt; df[&#39;userName&#39;]</span>
<span class="sd">    array([&#39;Alice&#39;, &#39;Bob&#39;, &#39;Alice&#39;, &#39;Carol&#39;, &#39;Bob&#39;, &#39;Alice&#39;])</span>

<span class="sd">    &gt;&gt;&gt; df[ak.array([1,3,5])]</span>

<span class="sd">    +----+------------+----------+--------+-------+----------+</span>
<span class="sd">    |    | userName   |   userID |   item |   day |   amount |</span>
<span class="sd">    +====+============+==========+========+=======+==========+</span>
<span class="sd">    |  0 | Bob        |      222 |      0 |     5 |      0.6 |</span>
<span class="sd">    +----+------------+----------+--------+-------+----------+</span>
<span class="sd">    |  1 | Carol      |      333 |      1 |     5 |      1.2 |</span>
<span class="sd">    +----+------------+----------+--------+-------+----------+</span>
<span class="sd">    |  2 | Alice      |      111 |      0 |     6 |      0.6 |</span>
<span class="sd">    +----+------------+----------+--------+-------+----------+</span>

<span class="sd">    Compute the stride:</span>

<span class="sd">    &gt;&gt;&gt; df[1:5:1]</span>

<span class="sd">    +----+------------+----------+--------+-------+----------+</span>
<span class="sd">    |    | userName   |   userID |   item |   day |   amount |</span>
<span class="sd">    +====+============+==========+========+=======+==========+</span>
<span class="sd">    |  0 | Bob        |      222 |      0 |     5 |      0.6 |</span>
<span class="sd">    +----+------------+----------+--------+-------+----------+</span>
<span class="sd">    |  1 | Alice      |      111 |      1 |     6 |      1.1 |</span>
<span class="sd">    +----+------------+----------+--------+-------+----------+</span>
<span class="sd">    |  2 | Carol      |      333 |      1 |     5 |      1.2 |</span>
<span class="sd">    +----+------------+----------+--------+-------+----------+</span>
<span class="sd">    |  3 | Bob        |      222 |      2 |     6 |      4.3 |</span>
<span class="sd">    +----+------------+----------+--------+-------+----------+</span>

<span class="sd">    &gt;&gt;&gt; df[ak.array([1,2,3])]</span>

<span class="sd">    +----+------------+----------+--------+-------+----------+</span>
<span class="sd">    |    | userName   |   userID |   item |   day |   amount |</span>
<span class="sd">    +====+============+==========+========+=======+==========+</span>
<span class="sd">    |  0 | Bob        |      222 |      0 |     5 |      0.6 |</span>
<span class="sd">    +----+------------+----------+--------+-------+----------+</span>
<span class="sd">    |  1 | Alice      |      111 |      1 |     6 |      1.1 |</span>
<span class="sd">    +----+------------+----------+--------+-------+----------+</span>
<span class="sd">    |  2 | Carol      |      333 |      1 |     5 |      1.2 |</span>
<span class="sd">    +----+------------+----------+--------+-------+----------+</span>

<span class="sd">    &gt;&gt;&gt; df[[&#39;userID&#39;, &#39;day&#39;]]</span>

<span class="sd">    +----+----------+-------+</span>
<span class="sd">    |    |   userID |   day |</span>
<span class="sd">    +====+==========+=======+</span>
<span class="sd">    |  0 |      111 |     5 |</span>
<span class="sd">    +----+----------+-------+</span>
<span class="sd">    |  1 |      222 |     5 |</span>
<span class="sd">    +----+----------+-------+</span>
<span class="sd">    |  2 |      111 |     6 |</span>
<span class="sd">    +----+----------+-------+</span>
<span class="sd">    |  3 |      333 |     5 |</span>
<span class="sd">    +----+----------+-------+</span>
<span class="sd">    |  4 |      222 |     6 |</span>
<span class="sd">    +----+----------+-------+</span>
<span class="sd">    |  5 |      111 |     6 |</span>
<span class="sd">    +----+----------+-------+</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_COLUMN_CLASSES</span> <span class="o">=</span> <span class="p">(</span><span class="n">pdarray</span><span class="p">,</span> <span class="n">Strings</span><span class="p">,</span> <span class="n">Categorical</span><span class="p">,</span> <span class="n">SegArray</span><span class="p">)</span>

    <span class="n">objType</span> <span class="o">=</span> <span class="s2">&quot;DataFrame&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">initialdata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">registered_name</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">initialdata</span><span class="p">,</span> <span class="n">DataFrame</span><span class="p">):</span>
            <span class="c1"># Copy constructor</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_nrows</span> <span class="o">=</span> <span class="n">initialdata</span><span class="o">.</span><span class="n">_nrows</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_bytes</span> <span class="o">=</span> <span class="n">initialdata</span><span class="o">.</span><span class="n">_bytes</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_empty</span> <span class="o">=</span> <span class="n">initialdata</span><span class="o">.</span><span class="n">_empty</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span> <span class="o">=</span> <span class="n">initialdata</span><span class="o">.</span><span class="n">_columns</span>
            <span class="k">if</span> <span class="n">index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_set_index</span><span class="p">(</span><span class="n">initialdata</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_set_index</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">initialdata</span><span class="o">.</span><span class="n">data</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_nrows</span><span class="p">()</span>
            <span class="k">return</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">initialdata</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="c1"># copy pd.DataFrame data into the ak.DataFrame object</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_nrows</span> <span class="o">=</span> <span class="n">initialdata</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_bytes</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_empty</span> <span class="o">=</span> <span class="n">initialdata</span><span class="o">.</span><span class="n">empty</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span> <span class="o">=</span> <span class="n">initialdata</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_set_index</span><span class="p">(</span><span class="n">initialdata</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_set_index</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">initialdata</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">SegArray</span><span class="o">.</span><span class="n">from_multi_array</span><span class="p">([</span><span class="n">array</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">initialdata</span><span class="p">[</span><span class="n">key</span><span class="p">]])</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">initialdata</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">))</span>
                    <span class="k">else</span> <span class="n">array</span><span class="p">(</span><span class="n">initialdata</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
                <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="c1"># Some metadata about this dataframe.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nrows</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bytes</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_empty</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># Initial attempts to keep an order on the columns</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_index</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>

        <span class="c1"># Add data to the DataFrame if there is any</span>
        <span class="k">if</span> <span class="n">initialdata</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Used to prevent uneven array length in initialization.</span>
            <span class="n">sizes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

            <span class="c1"># Initial data is a dictionary of arkouda arrays</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">initialdata</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">initialdata</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
                        <span class="n">val</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_COLUMN_CLASSES</span><span class="p">):</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Values must be one of </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_COLUMN_CLASSES</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;index&quot;</span><span class="p">:</span>
                        <span class="c1"># handles the index as an Index object instead of a column</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_set_index</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
                        <span class="k">continue</span>
                    <span class="n">sizes</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sizes</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input arrays must have equal size.&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_empty</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="n">UserDict</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
                    <span class="c1"># Update the column index</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

            <span class="c1"># Initial data is a list of arkouda arrays</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">initialdata</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="c1"># Create string IDs for the columns</span>
                <span class="n">keys</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">if</span> <span class="n">columns</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">):</span>
                        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Column labels must be strings.&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">initialdata</span><span class="p">):</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Must have as many labels as columns&quot;</span><span class="p">)</span>
                    <span class="n">keys</span> <span class="o">=</span> <span class="n">columns</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">initialdata</span><span class="p">))]</span>

                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">initialdata</span><span class="p">):</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
                        <span class="n">col</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_COLUMN_CLASSES</span><span class="p">):</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Values must be one of </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_COLUMN_CLASSES</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
                    <span class="n">sizes</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">col</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sizes</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input arrays must have equal size.&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_empty</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="n">UserDict</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
                    <span class="c1"># Update the column index</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

            <span class="c1"># Initial data is invalid.</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Initialize with dict or list of </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_COLUMN_CLASSES</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

            <span class="c1"># Update the dataframe indices and metadata.</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sizes</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_nrows</span> <span class="o">=</span> <span class="n">sizes</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

            <span class="c1"># If the index param was passed in, use that instead of</span>
            <span class="c1"># creating a new one.</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_set_index</span><span class="p">(</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nrows</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_set_index</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_nrows</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Attribute </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> not found&quot;</span><span class="p">)</span>
        <span class="c1"># Should this be cached?</span>
        <span class="k">return</span> <span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__dir__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">dir</span><span class="p">(</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;columns&quot;</span><span class="p">]</span>

    <span class="c1"># delete a column</span>
    <span class="k">def</span> <span class="fm">__delitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="c1"># This function is a backdoor to messing up the indices and columns.</span>
        <span class="c1"># I needed to reimplement it to prevent bad behavior</span>
        <span class="n">UserDict</span><span class="o">.</span><span class="fm">__delitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

        <span class="c1"># If removing this column emptied the dataframe</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_index</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_empty</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_nrows</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="c1"># convert series to underlying values</span>
        <span class="c1"># Should check for index alignment</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">Series</span><span class="p">):</span>
            <span class="n">key</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">values</span>

        <span class="c1"># Select rows using an integer pdarray</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">pdarray</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="n">akbool</span><span class="p">:</span>
                <span class="n">key</span> <span class="o">=</span> <span class="n">arange</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">size</span><span class="p">)[</span><span class="n">key</span><span class="p">]</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">:</span>
                <span class="n">result</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">UserDict</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">)[</span><span class="n">key</span><span class="p">]</span>
            <span class="c1"># To stay consistent with numpy, provide the old index values</span>
            <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">initialdata</span><span class="o">=</span><span class="n">result</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>

        <span class="c1"># Select rows or columns using a list</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">result</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">({</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">key</span><span class="p">})</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Invalid selector: too many types in list.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">UserDict</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">_columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
                <span class="n">result</span><span class="o">.</span><span class="n">_empty</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">result</span><span class="o">.</span><span class="n">_set_index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>  <span class="c1"># column lens remain the same. Copy the indexing</span>
                <span class="k">return</span> <span class="n">result</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="s2">&quot;DataFrames only support lists for column indexing. &quot;</span>
                    <span class="s2">&quot;All list entries must be of type str.&quot;</span>
                <span class="p">)</span>

        <span class="c1"># Select a single row using an integer</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">row</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="n">key</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">:</span>
                <span class="n">result</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">UserDict</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">)[</span><span class="n">row</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">Row</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

        <span class="c1"># Select a single column using a string</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid column name &#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">UserDict</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>

        <span class="c1"># Select rows using a slice</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
            <span class="c1"># result = DataFrame()</span>
            <span class="n">rtn_data</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">key</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">:</span>
                <span class="n">rtn_data</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">UserDict</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">)[</span><span class="n">s</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">initialdata</span><span class="o">=</span><span class="n">rtn_data</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nrows</span><span class="p">)[</span><span class="n">s</span><span class="p">]])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;Invalid selector: unknown error.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_nrows</span><span class="p">()</span>

        <span class="c1"># If this is the first column added, we must create an index column.</span>
        <span class="n">add_index</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_empty</span><span class="p">:</span>
            <span class="n">add_index</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># Set a single row in the dataframe using a dict of values</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">Strings</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="s2">&quot;This DataFrame has a column of type ak.Strings;&quot;</span>
                        <span class="s2">&quot; so this DataFrame is immutable. This feature could change&quot;</span>
                        <span class="s2">&quot; if arkouda supports mutable Strings in the future.&quot;</span>
                    <span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_empty</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Initial data must be dict of arkouda arrays.&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">dict</span><span class="p">,</span> <span class="n">UserDict</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Expected dict or Row type.&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">key</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nrows</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;The row index is out of range.&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">value</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="c1"># maintaining to prevent adding index column</span>
                    <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s2">&quot;index&quot;</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>

        <span class="c1"># Set a single column in the dataframe using a an arkouda array</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_COLUMN_CLASSES</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column must be one of </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_COLUMN_CLASSES</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nrows</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nrows</span> <span class="o">!=</span> <span class="n">value</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected size </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_nrows</span><span class="si">}</span><span class="s2"> but received size </span><span class="si">{</span><span class="n">value</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_empty</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">UserDict</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                <span class="c1"># Update the index values</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

        <span class="c1"># Do nothing and return if there&#39;s no valid data</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No valid data received.&quot;</span><span class="p">)</span>

        <span class="c1"># Update the dataframe indices and metadata.</span>
        <span class="k">if</span> <span class="n">add_index</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_nrows</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_index</span><span class="p">(</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nrows</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the number of rows.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nrows</span>

    <span class="k">def</span> <span class="nf">_ncols</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Number of columns.</span>
<span class="sd">        If index appears, we now want to utilize this</span>
<span class="sd">        because the actual index has been moved to a property</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a summary string of this dataframe.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_nrows</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_empty</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;DataFrame([ -- ][ 0 rows : 0 B])&quot;</span>

        <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">)]</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="n">key</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">]</span>
        <span class="n">keystr</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span>

        <span class="c1"># first call to memory_usage() initializes self._bytes</span>
        <span class="n">mem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">()</span>

        <span class="c1"># Get units that make the most sense.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bytes</span> <span class="o">&lt;</span> <span class="mi">1024</span><span class="p">:</span>
            <span class="n">mem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="s2">&quot;B&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bytes</span> <span class="o">&lt;</span> <span class="mi">1024</span><span class="o">**</span><span class="mi">2</span><span class="p">:</span>
            <span class="n">mem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="s2">&quot;KB&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bytes</span> <span class="o">&lt;</span> <span class="mi">1024</span><span class="o">**</span><span class="mi">3</span><span class="p">:</span>
            <span class="n">mem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="s2">&quot;MB&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">mem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="s2">&quot;GB&quot;</span><span class="p">)</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="s2">&quot; rows&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nrows</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">rows</span> <span class="o">=</span> <span class="s2">&quot; row&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;DataFrame([&quot;</span> <span class="o">+</span> <span class="n">keystr</span> <span class="o">+</span> <span class="s2">&quot;], </span><span class="si">{:,}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nrows</span><span class="p">)</span> <span class="o">+</span> <span class="n">rows</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">mem</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>

    <span class="k">def</span> <span class="nf">_get_head_tail</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_empty</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_nrows</span><span class="p">()</span>
        <span class="n">maxrows</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_option</span><span class="p">(</span><span class="s2">&quot;display.max_rows&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nrows</span> <span class="o">&lt;=</span> <span class="n">maxrows</span><span class="p">:</span>
            <span class="n">newdf</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">Categorical</span><span class="p">):</span>
                    <span class="n">newdf</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">codes</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">newdf</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
            <span class="n">newdf</span><span class="o">.</span><span class="n">_set_index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">newdf</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">(</span><span class="n">retain_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Being 1 above the threshold causes the PANDAS formatter to split the data frame vertically</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span>
            <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">maxrows</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nrows</span> <span class="o">-</span> <span class="p">(</span><span class="n">maxrows</span> <span class="o">//</span> <span class="mi">2</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nrows</span><span class="p">))</span>
        <span class="p">)</span>
        <span class="n">newdf</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">Categorical</span><span class="p">):</span>
                <span class="n">newdf</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">codes</span><span class="p">[</span><span class="n">idx</span><span class="p">]]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">newdf</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span>
        <span class="n">newdf</span><span class="o">.</span><span class="n">_set_index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">newdf</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">(</span><span class="n">retain_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_head_tail_server</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_empty</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_nrows</span><span class="p">()</span>
        <span class="n">maxrows</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_option</span><span class="p">(</span><span class="s2">&quot;display.max_rows&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nrows</span> <span class="o">&lt;=</span> <span class="n">maxrows</span><span class="p">:</span>
            <span class="n">newdf</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">Categorical</span><span class="p">):</span>
                    <span class="n">newdf</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">codes</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">newdf</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
            <span class="n">newdf</span><span class="o">.</span><span class="n">_set_index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">newdf</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">(</span><span class="n">retain_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Being 1 above the threshold causes the PANDAS formatter to split the data frame vertically</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span>
            <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">maxrows</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nrows</span> <span class="o">-</span> <span class="p">(</span><span class="n">maxrows</span> <span class="o">//</span> <span class="mi">2</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nrows</span><span class="p">))</span>
        <span class="p">)</span>
        <span class="n">msg_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">Categorical</span><span class="p">):</span>
                <span class="n">msg_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Categorical+</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">+</span><span class="si">{</span><span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">codes</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">+</span><span class="si">{</span><span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">categories</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">SegArray</span><span class="p">):</span>
                <span class="n">msg_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SegArray+</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">+</span><span class="si">{</span><span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">segments</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">+</span><span class="si">{</span><span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">Strings</span><span class="p">):</span>
                <span class="n">msg_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Strings+</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">+</span><span class="si">{</span><span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">Fields</span><span class="p">):</span>
                <span class="n">msg_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fields+</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">+</span><span class="si">{</span><span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">IPv4</span><span class="p">):</span>
                <span class="n">msg_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;IPv4+</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">+</span><span class="si">{</span><span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">Datetime</span><span class="p">):</span>
                <span class="n">msg_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Datetime+</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">+</span><span class="si">{</span><span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">BitVector</span><span class="p">):</span>
                <span class="n">msg_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;BitVector+</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">+</span><span class="si">{</span><span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">msg_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;pdarray+</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">+</span><span class="si">{</span><span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">repMsg</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
            <span class="nb">str</span><span class="p">,</span>
            <span class="n">generic_msg</span><span class="p">(</span>
                <span class="n">cmd</span><span class="o">=</span><span class="s2">&quot;dataframe_idx&quot;</span><span class="p">,</span>
                <span class="n">args</span><span class="o">=</span><span class="p">{</span>
                    <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">msg_list</span><span class="p">),</span>
                    <span class="s2">&quot;idx_name&quot;</span><span class="p">:</span> <span class="n">idx</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                    <span class="s2">&quot;columns&quot;</span><span class="p">:</span> <span class="n">msg_list</span><span class="p">,</span>
                <span class="p">},</span>
            <span class="p">),</span>
        <span class="p">)</span>
        <span class="n">msgList</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">repMsg</span><span class="p">)</span>

        <span class="n">df_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">msgList</span><span class="p">:</span>
            <span class="c1"># Split to [datatype, column, create]</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">msg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;Strings&quot;</span><span class="p">:</span>
                <span class="c1"># Categorical is returned as a strings by indexing categories[codes[idx]]</span>
                <span class="n">df_dict</span><span class="p">[</span><span class="n">msg</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">Strings</span><span class="o">.</span><span class="n">from_return_msg</span><span class="p">(</span><span class="n">msg</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="k">elif</span> <span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;SegArray&quot;</span><span class="p">:</span>
                <span class="c1"># split creates for segments and values</span>
                <span class="n">eles</span> <span class="o">=</span> <span class="n">msg</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;+&quot;</span><span class="p">)</span>
                <span class="n">df_dict</span><span class="p">[</span><span class="n">msg</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">SegArray</span><span class="p">(</span><span class="n">create_pdarray</span><span class="p">(</span><span class="n">eles</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">create_pdarray</span><span class="p">(</span><span class="n">eles</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
            <span class="k">elif</span> <span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;Fields&quot;</span><span class="p">:</span>
                <span class="n">df_dict</span><span class="p">[</span><span class="n">msg</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">Fields</span><span class="p">(</span>
                    <span class="n">create_pdarray</span><span class="p">(</span><span class="n">msg</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
                    <span class="bp">self</span><span class="p">[</span><span class="n">msg</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
                    <span class="n">MSB_left</span><span class="o">=</span><span class="bp">self</span><span class="p">[</span><span class="n">msg</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">MSB_left</span><span class="p">,</span>
                    <span class="n">pad</span><span class="o">=</span><span class="bp">self</span><span class="p">[</span><span class="n">msg</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">padchar</span><span class="p">,</span>
                    <span class="n">separator</span><span class="o">=</span><span class="bp">self</span><span class="p">[</span><span class="n">msg</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">separator</span><span class="p">,</span>
                    <span class="n">show_int</span><span class="o">=</span><span class="bp">self</span><span class="p">[</span><span class="n">msg</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">show_int</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;IPv4&quot;</span><span class="p">:</span>
                <span class="n">df_dict</span><span class="p">[</span><span class="n">msg</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">IPv4</span><span class="p">(</span><span class="n">create_pdarray</span><span class="p">(</span><span class="n">msg</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
            <span class="k">elif</span> <span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;Datetime&quot;</span><span class="p">:</span>
                <span class="n">df_dict</span><span class="p">[</span><span class="n">msg</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">Datetime</span><span class="p">(</span><span class="n">create_pdarray</span><span class="p">(</span><span class="n">msg</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
            <span class="k">elif</span> <span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;BitVector&quot;</span><span class="p">:</span>
                <span class="n">df_dict</span><span class="p">[</span><span class="n">msg</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">BitVector</span><span class="p">(</span>
                    <span class="n">create_pdarray</span><span class="p">(</span><span class="n">msg</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
                    <span class="n">width</span><span class="o">=</span><span class="bp">self</span><span class="p">[</span><span class="n">msg</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
                    <span class="n">reverse</span><span class="o">=</span><span class="bp">self</span><span class="p">[</span><span class="n">msg</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">reverse</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">df_dict</span><span class="p">[</span><span class="n">msg</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">create_pdarray</span><span class="p">(</span><span class="n">msg</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

        <span class="n">new_df</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">df_dict</span><span class="p">)</span>
        <span class="n">new_df</span><span class="o">.</span><span class="n">_set_index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">new_df</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">(</span><span class="n">retain_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">]</span>

<div class="viewcode-block" id="DataFrame.transfer">
<a class="viewcode-back" href="../../autoapi/arkouda/index.html#arkouda.dataframe.DataFrame.transfer">[docs]</a>
    <span class="k">def</span> <span class="nf">transfer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hostname</span><span class="p">,</span> <span class="n">port</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sends a DataFrame to a different Arkouda server.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        hostname : str</span>
<span class="sd">            The hostname where the Arkouda server intended to</span>
<span class="sd">            receive the DataFrame is running.</span>
<span class="sd">        port : int_scalars</span>
<span class="sd">            The port to send the array over. This needs to be an</span>
<span class="sd">            open port (i.e., not one that the Arkouda server is</span>
<span class="sd">            running on). This will open up `numLocales` ports,</span>
<span class="sd">            each of which in succession, so will use ports of the</span>
<span class="sd">            range {port..(port+numLocales)} (e.g., running an</span>
<span class="sd">            Arkouda server of 4 nodes, port 1234 is passed as</span>
<span class="sd">            `port`, Arkouda will use ports 1234, 1235, 1236,</span>
<span class="sd">            and 1237 to send the array data).</span>
<span class="sd">            This port much match the port passed to the call to</span>
<span class="sd">            `ak.receive_array()`.</span>


<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            A message indicating a complete transfer.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Raised if the op is not within the pdarray.BinOps set</span>
<span class="sd">        TypeError</span>
<span class="sd">            Raised if other is not a pdarray or the pdarray.dtype is not</span>
<span class="sd">            a supported dtype</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_nrows</span><span class="p">()</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span>
        <span class="n">msg_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">Categorical</span><span class="p">):</span>
                <span class="n">msg_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Categorical+</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">+</span><span class="si">{</span><span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">codes</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">                +</span><span class="si">{</span><span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">categories</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">+</span><span class="si">{</span><span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">_akNAcode</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">SegArray</span><span class="p">):</span>
                <span class="n">msg_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SegArray+</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">+</span><span class="si">{</span><span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">segments</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">+</span><span class="si">{</span><span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">Strings</span><span class="p">):</span>
                <span class="n">msg_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Strings+</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">+</span><span class="si">{</span><span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">Fields</span><span class="p">):</span>
                <span class="n">msg_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fields+</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">+</span><span class="si">{</span><span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">IPv4</span><span class="p">):</span>
                <span class="n">msg_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;IPv4+</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">+</span><span class="si">{</span><span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">Datetime</span><span class="p">):</span>
                <span class="n">msg_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Datetime+</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">+</span><span class="si">{</span><span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">BitVector</span><span class="p">):</span>
                <span class="n">msg_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;BitVector+</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">+</span><span class="si">{</span><span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">msg_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;pdarray+</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">+</span><span class="si">{</span><span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">repMsg</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
            <span class="nb">str</span><span class="p">,</span>
            <span class="n">generic_msg</span><span class="p">(</span>
                <span class="n">cmd</span><span class="o">=</span><span class="s2">&quot;sendDataframe&quot;</span><span class="p">,</span>
                <span class="n">args</span><span class="o">=</span><span class="p">{</span>
                    <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">msg_list</span><span class="p">),</span>
                    <span class="s2">&quot;idx_name&quot;</span><span class="p">:</span> <span class="n">idx</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                    <span class="s2">&quot;columns&quot;</span><span class="p">:</span> <span class="n">msg_list</span><span class="p">,</span>
                    <span class="s2">&quot;hostname&quot;</span><span class="p">:</span> <span class="n">hostname</span><span class="p">,</span>
                    <span class="s2">&quot;port&quot;</span><span class="p">:</span> <span class="n">port</span><span class="p">,</span>
                <span class="p">},</span>
            <span class="p">),</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">repMsg</span></div>


    <span class="k">def</span> <span class="nf">_shape_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_nrows</span><span class="si">}</span><span class="s2"> rows x </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_ncols</span><span class="p">()</span><span class="si">}</span><span class="s2"> columns&quot;</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return ascii-formatted version of the dataframe.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">prt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_head_tail_server</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">pd</span><span class="o">.</span><span class="n">option_context</span><span class="p">(</span><span class="s2">&quot;display.show_dimensions&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="n">retval</span> <span class="o">=</span> <span class="n">prt</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>
        <span class="n">retval</span> <span class="o">+=</span> <span class="s2">&quot; (&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shape_str</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
        <span class="k">return</span> <span class="n">retval</span>

    <span class="k">def</span> <span class="nf">_repr_html_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return html-formatted version of the dataframe.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">prt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_head_tail_server</span><span class="p">()</span>

        <span class="k">with</span> <span class="n">pd</span><span class="o">.</span><span class="n">option_context</span><span class="p">(</span><span class="s2">&quot;display.show_dimensions&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="n">retval</span> <span class="o">=</span> <span class="n">prt</span><span class="o">.</span><span class="n">_repr_html_</span><span class="p">()</span>
        <span class="n">retval</span> <span class="o">+=</span> <span class="s2">&quot;&lt;p&gt;&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shape_str</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&lt;/p&gt;&quot;</span>
        <span class="k">return</span> <span class="n">retval</span>

    <span class="k">def</span> <span class="nf">_ipython_key_completions_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span>

<div class="viewcode-block" id="DataFrame.from_pandas">
<a class="viewcode-back" href="../../autoapi/arkouda/index.html#arkouda.dataframe.DataFrame.from_pandas">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_pandas</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">pd_df</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Copy the data from a pandas DataFrame into a new arkouda.dataframe.DataFrame.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pd_df : pandas.DataFrame</span>
<span class="sd">            A pandas DataFrame to convert.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        arkouda.dataframe.DataFrame</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; import arkouda as ak</span>
<span class="sd">        &gt;&gt;&gt; ak.connect()</span>
<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; pd_df = pd.DataFrame({&quot;A&quot;:[1,2],&quot;B&quot;:[3,4]})</span>
<span class="sd">        &gt;&gt;&gt; type(pd_df)</span>
<span class="sd">        pandas.core.frame.DataFrame</span>
<span class="sd">        &gt;&gt;&gt; display(pd_df)</span>

<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |    |   A |   B |</span>
<span class="sd">        +====+=====+=====+</span>
<span class="sd">        |  0 |   1 |   3 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  1 |   2 |   4 |</span>
<span class="sd">        +----+-----+-----+</span>

<span class="sd">        &gt;&gt;&gt; ak_df = DataFrame.from_pandas(pd_df)</span>
<span class="sd">        &gt;&gt;&gt; type(ak_df)</span>
<span class="sd">        arkouda.dataframe.DataFrame</span>
<span class="sd">        &gt;&gt;&gt; display(ak_df)</span>

<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |    |   A |   B |</span>
<span class="sd">        +====+=====+=====+</span>
<span class="sd">        |  0 |   1 |   3 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  1 |   2 |   4 |</span>
<span class="sd">        +----+-----+-----+</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">initialdata</span><span class="o">=</span><span class="n">pd_df</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">_drop_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keys</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Drop a column or columns from the dataframe, in-place.</span>

<span class="sd">        keys : list</span>
<span class="sd">            The labels to be dropped on the given axis</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
            <span class="c1"># This will raise an exception if key does not exist</span>
            <span class="c1"># Use self.pop(key, None) if we do not want to error</span>
            <span class="k">del</span> <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_drop_row</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keys</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Drop a row or rows from the dataframe, in-place.</span>

<span class="sd">        keys : list</span>
<span class="sd">            The indexes to be dropped on the given axis</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">idx_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">last_idx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="c1"># sort to ensure we go in ascending order.</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Index keys must be integers.&quot;</span><span class="p">)</span>
            <span class="n">idx_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">index</span><span class="p">[(</span><span class="n">last_idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="p">:</span> <span class="n">k</span><span class="p">])</span>
            <span class="n">last_idx</span> <span class="o">=</span> <span class="n">k</span>

        <span class="n">idx_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">index</span><span class="p">[(</span><span class="n">last_idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="p">:])</span>

        <span class="n">idx_to_keep</span> <span class="o">=</span> <span class="n">concatenate</span><span class="p">(</span><span class="n">idx_list</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="c1"># using the UserDict.__setitem__ here because we know all the columns are being</span>
            <span class="c1"># reset to the same size</span>
            <span class="c1"># This avoids the size checks we would do when only setting a single column</span>
            <span class="n">UserDict</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="n">idx_to_keep</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_index</span><span class="p">(</span><span class="n">idx_to_keep</span><span class="p">)</span>

<div class="viewcode-block" id="DataFrame.drop">
<a class="viewcode-back" href="../../autoapi/arkouda/index.html#arkouda.dataframe.DataFrame.drop">[docs]</a>
    <span class="nd">@typechecked</span>
    <span class="k">def</span> <span class="nf">drop</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">keys</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]],</span>
        <span class="n">axis</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">DataFrame</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Drop column/s or row/s from the dataframe.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        keys : str, int or list</span>
<span class="sd">            The labels to be dropped on the given axis.</span>
<span class="sd">        axis : int or str</span>
<span class="sd">            The axis on which to drop from. 0/&#39;index&#39; - drop rows, 1/&#39;columns&#39; - drop columns.</span>
<span class="sd">        inplace: bool, default=False</span>
<span class="sd">            When True, perform the operation on the calling object.</span>
<span class="sd">            When False, return a new object.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        arkouda.dataframe.DataFrame or None</span>
<span class="sd">            DateFrame when `inplace=False`;</span>
<span class="sd">            None when `inplace=True`</span>

<span class="sd">        Examples</span>
<span class="sd">        ----------</span>

<span class="sd">        &gt;&gt;&gt; import arkouda as ak</span>
<span class="sd">        &gt;&gt;&gt; ak.connect()</span>
<span class="sd">        &gt;&gt;&gt; df = ak.DataFrame({&#39;col1&#39;: [1, 2], &#39;col2&#39;: [3, 4]})</span>
<span class="sd">        &gt;&gt;&gt; display(df)</span>

<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |    |   col1 |   col2 |</span>
<span class="sd">        +====+========+========+</span>
<span class="sd">        |  0 |      1 |      3 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  1 |      2 |      4 |</span>
<span class="sd">        +----+--------+--------+</span>

<span class="sd">        Drop column</span>

<span class="sd">        &gt;&gt;&gt; df.drop(&#39;col1&#39;, axis = 1)</span>

<span class="sd">        +----+--------+</span>
<span class="sd">        |    |   col2 |</span>
<span class="sd">        +====+========+</span>
<span class="sd">        |  0 |      3 |</span>
<span class="sd">        +----+--------+</span>
<span class="sd">        |  1 |      4 |</span>
<span class="sd">        +----+--------+</span>

<span class="sd">        Drop row</span>

<span class="sd">        &gt;&gt;&gt; df.drop(0, axis = 0)</span>

<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |    |   col1 |   col2 |</span>
<span class="sd">        +====+========+========+</span>
<span class="sd">        |  0 |      2 |      4 |</span>
<span class="sd">        +----+--------+--------+</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">keys</span><span class="p">]</span>

        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span> <span class="k">if</span> <span class="n">inplace</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;index&quot;</span><span class="p">:</span>
            <span class="c1"># drop a row</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">_drop_row</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">axis</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;columns&quot;</span><span class="p">:</span>
            <span class="c1"># drop column</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">_drop_column</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No axis named </span><span class="si">{</span><span class="n">axis</span><span class="si">}</span><span class="s2"> for object type DataFrame&quot;</span><span class="p">)</span>

        <span class="c1"># If the dataframe just became empty...</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">_columns</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">_set_index</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">_empty</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">update_nrows</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">obj</span>

        <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="DataFrame.drop_duplicates">
<a class="viewcode-back" href="../../autoapi/arkouda/index.html#arkouda.dataframe.DataFrame.drop_duplicates">[docs]</a>
    <span class="k">def</span> <span class="nf">drop_duplicates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="s2">&quot;first&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Drops duplcated rows and returns resulting DataFrame.</span>

<span class="sd">        If a subset of the columns are provided then only one instance of each</span>
<span class="sd">        duplicated row will be returned (keep determines which row).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        subset : Iterable</span>
<span class="sd">            Iterable of column names to use to dedupe.</span>
<span class="sd">        keep : {&#39;first&#39;, &#39;last&#39;}, default=&#39;first&#39;</span>
<span class="sd">            Determines which duplicates (if any) to keep.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        arkouda.dataframe.DataFrame</span>
<span class="sd">            DataFrame with duplicates removed.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>

<span class="sd">        &gt;&gt;&gt; df = ak.DataFrame({&#39;col1&#39;: [1, 2, 2, 3], &#39;col2&#39;: [4, 5, 5, 6]})</span>
<span class="sd">        &gt;&gt;&gt; display(df)</span>

<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |    |   col1 |   col2 |</span>
<span class="sd">        +====+========+========+</span>
<span class="sd">        |  0 |      1 |      4 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  1 |      2 |      5 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  2 |      2 |      5 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  3 |      3 |      6 |</span>
<span class="sd">        +----+--------+--------+</span>

<span class="sd">        &gt;&gt;&gt; df.drop_duplicates()</span>

<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |    |   col1 |   col2 |</span>
<span class="sd">        +====+========+========+</span>
<span class="sd">        |  0 |      1 |      4 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  1 |      2 |      5 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  2 |      3 |      6 |</span>
<span class="sd">        +----+--------+--------+</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_empty</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">subset</span><span class="p">:</span>
            <span class="n">subset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">subset</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">subset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">subset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> is not a column in the DataFrame.&quot;</span><span class="p">)</span>
            <span class="n">gp</span> <span class="o">=</span> <span class="n">akGroupBy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">subset</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">subset</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">subset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> is not a column in the DataFrame.&quot;</span><span class="p">)</span>

            <span class="n">gp</span> <span class="o">=</span> <span class="n">akGroupBy</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">subset</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">keep</span> <span class="o">==</span> <span class="s2">&quot;last&quot;</span><span class="p">:</span>
            <span class="n">_segment_ends</span> <span class="o">=</span> <span class="n">concatenate</span><span class="p">([</span><span class="n">gp</span><span class="o">.</span><span class="n">segments</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">array</span><span class="p">([</span><span class="n">gp</span><span class="o">.</span><span class="n">permutation</span><span class="o">.</span><span class="n">size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])])</span>
            <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">gp</span><span class="o">.</span><span class="n">permutation</span><span class="p">[</span><span class="n">_segment_ends</span><span class="p">]]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">gp</span><span class="o">.</span><span class="n">permutation</span><span class="p">[</span><span class="n">gp</span><span class="o">.</span><span class="n">segments</span><span class="p">]]</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the number of bytes on the arkouda server.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">            The number of bytes on the arkouda server.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; import arkouda as ak</span>
<span class="sd">        &gt;&gt;&gt; ak.connect()</span>
<span class="sd">        &gt;&gt;&gt; df = ak.DataFrame({&#39;col1&#39;: [1, 2, 3], &#39;col2&#39;: [4, 5, 6]})</span>
<span class="sd">        &gt;&gt;&gt; df</span>

<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |    |   col1 |   col2 |</span>
<span class="sd">        +====+========+========+</span>
<span class="sd">        |  0 |      1 |      4 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  1 |      2 |      5 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  2 |      3 |      6 |</span>
<span class="sd">        +----+--------+--------+</span>

<span class="sd">        &gt;&gt;&gt; df.size</span>
<span class="sd">        6</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_nrows</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nrows</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">dtypes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The dtypes of the dataframe.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dtypes :  arkouda.row.Row</span>
<span class="sd">            The dtypes of the dataframe.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; import arkouda as ak</span>
<span class="sd">        &gt;&gt;&gt; ak.connect()</span>
<span class="sd">        &gt;&gt;&gt; df = ak.DataFrame({&#39;col1&#39;: [1, 2], &#39;col2&#39;: [&quot;a&quot;, &quot;b&quot;]})</span>
<span class="sd">        &gt;&gt;&gt; df</span>

<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |    |   col1 | col2   |</span>
<span class="sd">        +====+========+========+</span>
<span class="sd">        |  0 |      1 | a      |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  1 |      2 | b      |</span>
<span class="sd">        +----+--------+--------+</span>

<span class="sd">        &gt;&gt;&gt; df.dtypes</span>

<span class="sd">        +----+--------+</span>
<span class="sd">        |keys| values |</span>
<span class="sd">        +====+========+</span>
<span class="sd">        |col1|  int64 |</span>
<span class="sd">        +----+--------+</span>
<span class="sd">        |col2|    str |</span>
<span class="sd">        +----+--------+</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dtypes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">pdarray</span><span class="p">):</span>
                <span class="n">dtypes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">dtype</span><span class="p">))</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Strings</span><span class="p">):</span>
                <span class="n">dtypes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;str&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Categorical</span><span class="p">):</span>
                <span class="n">dtypes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Categorical&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">SegArray</span><span class="p">):</span>
                <span class="n">dtypes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;SegArray&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unsupported type encountered for ak.DataFrame, </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">Row</span><span class="p">({</span><span class="n">key</span><span class="p">:</span> <span class="n">dtype</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">dtype</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">dtypes</span><span class="p">)})</span>
        <span class="k">return</span> <span class="n">res</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">empty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Whether the dataframe is empty.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            True if the dataframe is empty, otherwise False.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; import arkouda as ak</span>
<span class="sd">        &gt;&gt;&gt; ak.connect()</span>
<span class="sd">        &gt;&gt;&gt; df = ak.DataFrame({})</span>
<span class="sd">        &gt;&gt;&gt; df</span>
<span class="sd">         0 rows x 0 columns</span>
<span class="sd">        &gt;&gt;&gt; df.empty</span>
<span class="sd">        True</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_empty</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The shape of the dataframe.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tuple of int</span>
<span class="sd">            Tuple of array dimensions.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; import arkouda as ak</span>
<span class="sd">        &gt;&gt;&gt; ak.connect()</span>
<span class="sd">        &gt;&gt;&gt; df = ak.DataFrame({&#39;col1&#39;: [1, 2, 3], &#39;col2&#39;: [4, 5, 6]})</span>
<span class="sd">        &gt;&gt;&gt; df</span>

<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |    |   col1 |   col2 |</span>
<span class="sd">        +====+========+========+</span>
<span class="sd">        |  0 |      1 |      4 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  1 |      2 |      5 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  2 |      3 |      6 |</span>
<span class="sd">        +----+--------+--------+</span>

<span class="sd">        &gt;&gt;&gt; df.shape</span>
<span class="sd">        (3, 2)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_nrows</span><span class="p">()</span>
        <span class="n">num_cols</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">)</span>
        <span class="n">nrows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nrows</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">num_cols</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">columns</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        An Index where the values are the column names of the dataframe.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        arkouda.index.Index</span>
<span class="sd">            The values of the index are the column names of the dataframe.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; import arkouda as ak</span>
<span class="sd">        &gt;&gt;&gt; ak.connect()</span>
<span class="sd">        &gt;&gt;&gt; df = ak.DataFrame({&#39;col1&#39;: [1, 2], &#39;col2&#39;: [3, 4]})</span>
<span class="sd">        &gt;&gt;&gt; df</span>

<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |    |   col1 |   col2 |</span>
<span class="sd">        +====+========+========+</span>
<span class="sd">        |  0 |      1 |      3 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  1 |      2 |      4 |</span>
<span class="sd">        +----+--------+--------+</span>

<span class="sd">        &gt;&gt;&gt; df.columns</span>
<span class="sd">        Index(array([&#39;col1&#39;, &#39;col2&#39;]), dtype=&#39;&lt;U0&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">,</span> <span class="n">ndarray</span><span class="p">):</span>
            <span class="n">column_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">column_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span>

        <span class="k">return</span> <span class="n">Index</span><span class="p">(</span><span class="n">column_names</span><span class="p">,</span> <span class="n">allow_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The index of the dataframe.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        arkouda.index.Index or arkouda.index.MultiIndex</span>
<span class="sd">            The index of the dataframe.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; import arkouda as ak</span>
<span class="sd">        &gt;&gt;&gt; ak.connect()</span>
<span class="sd">        &gt;&gt;&gt; df = ak.DataFrame({&#39;col1&#39;: [1, 2], &#39;col2&#39;: [3, 4]})</span>
<span class="sd">        &gt;&gt;&gt; df</span>

<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |    |   col1 |   col2 |</span>
<span class="sd">        +====+========+========+</span>
<span class="sd">        |  0 |      1 |      3 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  1 |      2 |      4 |</span>
<span class="sd">        +----+--------+--------+</span>

<span class="sd">        &gt;&gt;&gt; df.index</span>
<span class="sd">        Index(array([0 1]), dtype=&#39;int64&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span>

    <span class="k">def</span> <span class="nf">_set_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Index</span><span class="p">)</span> <span class="ow">or</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="n">pdarray</span><span class="p">,</span> <span class="n">Strings</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">=</span> <span class="n">Index</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">=</span> <span class="n">Index</span><span class="p">(</span><span class="n">array</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;DataFrame Index can only be constructed from type ak.Index, pdarray or list.&quot;</span>
                <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="si">}</span><span class="s2"> provided.&quot;</span>
            <span class="p">)</span>

<div class="viewcode-block" id="DataFrame.reset_index">
<a class="viewcode-back" href="../../autoapi/arkouda/index.html#arkouda.dataframe.DataFrame.reset_index">[docs]</a>
    <span class="nd">@typechecked</span>
    <span class="k">def</span> <span class="nf">reset_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">DataFrame</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the index to an integer range.</span>

<span class="sd">        Useful if this dataframe is the result of a slice operation from</span>
<span class="sd">        another dataframe, or if you have permuted the rows and no longer need</span>
<span class="sd">        to keep that ordering on the rows.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        size : int</span>
<span class="sd">            If size is passed, do not attempt to determine size based on</span>
<span class="sd">            existing column sizes. Assume caller handles consistency correctly.</span>
<span class="sd">        inplace: bool, default=False</span>
<span class="sd">            When True, perform the operation on the calling object.</span>
<span class="sd">            When False, return a new object.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        arkouda.dataframe.DataFrame or None</span>
<span class="sd">            DateFrame when `inplace=False`;</span>
<span class="sd">            None when `inplace=True`.</span>

<span class="sd">        NOTE</span>
<span class="sd">        ----------</span>
<span class="sd">        Pandas adds a column &#39;index&#39; to indicate the original index. Arkouda does not currently</span>
<span class="sd">        support this behavior.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>

<span class="sd">        &gt;&gt;&gt; df = ak.DataFrame({&quot;A&quot;: ak.array([1, 2, 3]), &quot;B&quot;: ak.array([4, 5, 6])})</span>
<span class="sd">        &gt;&gt;&gt; display(df)</span>

<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |    |   A |   B |</span>
<span class="sd">        +====+=====+=====+</span>
<span class="sd">        |  0 |   1 |   4 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  1 |   2 |   5 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  2 |   3 |   6 |</span>
<span class="sd">        +----+-----+-----+</span>

<span class="sd">        &gt;&gt;&gt; perm_df = df[ak.array([0,2,1])]</span>
<span class="sd">        &gt;&gt;&gt; display(perm_df)</span>

<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |    |   A |   B |</span>
<span class="sd">        +====+=====+=====+</span>
<span class="sd">        |  0 |   1 |   4 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  1 |   3 |   6 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  2 |   2 |   5 |</span>
<span class="sd">        +----+-----+-----+</span>

<span class="sd">        &gt;&gt;&gt; perm_df.reset_index()</span>

<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |    |   A |   B |</span>
<span class="sd">        +====+=====+=====+</span>
<span class="sd">        |  0 |   1 |   4 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  1 |   3 |   6 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  2 |   2 |   5 |</span>
<span class="sd">        +----+-----+-----+</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span> <span class="k">if</span> <span class="n">inplace</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">size</span><span class="p">:</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">update_nrows</span><span class="p">()</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">_set_index</span><span class="p">(</span><span class="n">arange</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">_nrows</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">_set_index</span><span class="p">(</span><span class="n">arange</span><span class="p">(</span><span class="n">size</span><span class="p">))</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">obj</span>
        <span class="k">return</span> <span class="kc">None</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a summary string of this dataframe.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            A summary string of this dataframe.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; import arkouda as ak</span>
<span class="sd">        &gt;&gt;&gt; ak.connect()</span>
<span class="sd">        &gt;&gt;&gt; df = ak.DataFrame({&#39;col1&#39;: [1, 2], &#39;col2&#39;: [&quot;a&quot;, &quot;b&quot;]})</span>
<span class="sd">        &gt;&gt;&gt; df</span>

<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |    |   col1 | col2   |</span>
<span class="sd">        +====+========+========+</span>
<span class="sd">        |  0 |      1 | a      |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  1 |      2 | b      |</span>
<span class="sd">        +----+--------+--------+</span>

<span class="sd">        &gt;&gt;&gt; df.info</span>
<span class="sd">        &quot;DataFrame([&#39;col1&#39;, &#39;col2&#39;], 2 rows, 20 B)&quot;</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_nrows</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nrows</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;DataFrame([ -- ][ 0 rows : 0 B])&quot;</span>

        <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">)]</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="n">key</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">]</span>
        <span class="n">keystr</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span>

        <span class="c1"># first call to memory_usage() initializes self._bytes</span>
        <span class="n">mem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">()</span>

        <span class="c1"># Get units that make the most sense.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bytes</span> <span class="o">&lt;</span> <span class="mi">1024</span><span class="p">:</span>
            <span class="n">mem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="s2">&quot;B&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bytes</span> <span class="o">&lt;</span> <span class="mi">1024</span><span class="o">**</span><span class="mi">2</span><span class="p">:</span>
            <span class="n">mem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="s2">&quot;KB&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bytes</span> <span class="o">&lt;</span> <span class="mi">1024</span><span class="o">**</span><span class="mi">3</span><span class="p">:</span>
            <span class="n">mem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="s2">&quot;MB&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">mem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="s2">&quot;GB&quot;</span><span class="p">)</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="s2">&quot; rows&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nrows</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">rows</span> <span class="o">=</span> <span class="s2">&quot; row&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;DataFrame([&quot;</span> <span class="o">+</span> <span class="n">keystr</span> <span class="o">+</span> <span class="s2">&quot;], </span><span class="si">{:,}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nrows</span><span class="p">)</span> <span class="o">+</span> <span class="n">rows</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">mem</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>

<div class="viewcode-block" id="DataFrame.update_nrows">
<a class="viewcode-back" href="../../autoapi/arkouda/index.html#arkouda.dataframe.DataFrame.update_nrows">[docs]</a>
    <span class="k">def</span> <span class="nf">update_nrows</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the number of rows on the arkouda server and updates the size parameter.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sizes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">sizes</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sizes</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Size mismatch in DataFrame columns.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sizes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_nrows</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_nrows</span> <span class="o">=</span> <span class="n">sizes</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span></div>


    <span class="nd">@typechecked</span>
    <span class="k">def</span> <span class="nf">_rename_column</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">mapper</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Callable</span><span class="p">,</span> <span class="n">Dict</span><span class="p">],</span> <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DataFrame</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Rename columns within the dataframe</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        mapper : callable or dict-like</span>
<span class="sd">            Function or dictionary mapping existing columns to new columns.</span>
<span class="sd">            Nonexistent names will not raise an error.</span>
<span class="sd">        inplace: bool, default=False</span>
<span class="sd">            When True, perform the operation on the calling object.</span>
<span class="sd">            When False, return a new object.</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        arkouda.dataframe.DataFrame or None</span>
<span class="sd">            DateFrame when `inplace=False`</span>
<span class="sd">            None when `inplace=True`</span>

<span class="sd">        See Also</span>
<span class="sd">        -------</span>
<span class="sd">        ak.DataFrame._rename_index</span>
<span class="sd">        ak.DataFrame.rename</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span> <span class="k">if</span> <span class="n">inplace</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">mapper</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">_columns</span><span class="p">)):</span>
                <span class="n">oldname</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">_columns</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">newname</span> <span class="o">=</span> <span class="n">mapper</span><span class="p">(</span><span class="n">oldname</span><span class="p">)</span>
                <span class="c1"># Only rename if name has changed</span>
                <span class="k">if</span> <span class="n">newname</span> <span class="o">!=</span> <span class="n">oldname</span><span class="p">:</span>
                    <span class="n">obj</span><span class="o">.</span><span class="n">_columns</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">newname</span>
                    <span class="n">obj</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">newname</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">oldname</span><span class="p">]</span>
                    <span class="k">del</span> <span class="n">obj</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">oldname</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mapper</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">oldname</span><span class="p">,</span> <span class="n">newname</span> <span class="ow">in</span> <span class="n">mapper</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="c1"># Only rename if name has changed</span>
                <span class="k">if</span> <span class="n">newname</span> <span class="o">!=</span> <span class="n">oldname</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">i</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">_columns</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">oldname</span><span class="p">)</span>
                        <span class="n">obj</span><span class="o">.</span><span class="n">_columns</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">newname</span>
                        <span class="n">obj</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">newname</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">oldname</span><span class="p">]</span>
                        <span class="k">del</span> <span class="n">obj</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">oldname</span><span class="p">]</span>
                    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                        <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Argument must be callable or dict-like&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">obj</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@typechecked</span>
    <span class="k">def</span> <span class="nf">_rename_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mapper</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Callable</span><span class="p">,</span> <span class="n">Dict</span><span class="p">],</span> <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DataFrame</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Rename indexes within the dataframe</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        mapper : callable or dict-like</span>
<span class="sd">            Function or dictionary mapping existing indexes to new indexes.</span>
<span class="sd">            Nonexistent names will not raise an error.</span>
<span class="sd">        inplace: bool, default=False</span>
<span class="sd">            When True, perform the operation on the calling object.</span>
<span class="sd">            When False, return a new object.</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        arkouda.dataframe.DataFrame or None</span>
<span class="sd">            DateFrame when `inplace=False`</span>
<span class="sd">            None when `inplace=True`</span>
<span class="sd">        See Also</span>
<span class="sd">        -------</span>
<span class="sd">            ak.DataFrame._rename_column</span>
<span class="sd">            ak.DataFrame.rename</span>
<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">            This does not function exactly like pandas. The replacement value here must be</span>
<span class="sd">            the same type as the existing value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span> <span class="k">if</span> <span class="n">inplace</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">mapper</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
                <span class="n">oldval</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">newval</span> <span class="o">=</span> <span class="n">mapper</span><span class="p">(</span><span class="n">oldval</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">oldval</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">type</span><span class="p">(</span><span class="n">newval</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Replacement value must have the same type as the original value&quot;</span><span class="p">)</span>
                <span class="n">obj</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span> <span class="o">==</span> <span class="n">oldval</span><span class="p">]</span> <span class="o">=</span> <span class="n">newval</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mapper</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">mapper</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">type</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Replacement value must have the same type as the original value&quot;</span><span class="p">)</span>
                <span class="n">obj</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span> <span class="o">==</span> <span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Argument must be callable or dict-like&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">obj</span>
        <span class="k">return</span> <span class="kc">None</span>

<div class="viewcode-block" id="DataFrame.rename">
<a class="viewcode-back" href="../../autoapi/arkouda/index.html#arkouda.dataframe.DataFrame.rename">[docs]</a>
    <span class="nd">@typechecked</span>
    <span class="k">def</span> <span class="nf">rename</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">mapper</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Callable</span><span class="p">,</span> <span class="n">Dict</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Callable</span><span class="p">,</span> <span class="n">Dict</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Callable</span><span class="p">,</span> <span class="n">Dict</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">axis</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DataFrame</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Rename indexes or columns according to a mapping.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        mapper : callable or dict-like, Optional</span>
<span class="sd">            Function or dictionary mapping existing values to new values.</span>
<span class="sd">            Nonexistent names will not raise an error.</span>
<span class="sd">            Uses the value of axis to determine if renaming column or index</span>
<span class="sd">        column : callable or dict-like, Optional</span>
<span class="sd">            Function or dictionary mapping existing column names to</span>
<span class="sd">            new column names. Nonexistent names will not raise an</span>
<span class="sd">            error.</span>
<span class="sd">            When this is set, axis is ignored.</span>
<span class="sd">        index : callable or dict-like, Optional</span>
<span class="sd">            Function or dictionary mapping existing index names to</span>
<span class="sd">            new index names. Nonexistent names will not raise an</span>
<span class="sd">            error.</span>
<span class="sd">            When this is set, axis is ignored.</span>
<span class="sd">        axis: int or str, default=0</span>
<span class="sd">            Indicates which axis to perform the rename.</span>
<span class="sd">            0/&quot;index&quot; - Indexes</span>
<span class="sd">            1/&quot;column&quot; - Columns</span>
<span class="sd">        inplace: bool, default=False</span>
<span class="sd">            When True, perform the operation on the calling object.</span>
<span class="sd">            When False, return a new object.</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        arkouda.dataframe.DataFrame or None</span>
<span class="sd">            DateFrame when `inplace=False`;</span>
<span class="sd">            None when `inplace=True`.</span>
<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; import arkouda as ak</span>
<span class="sd">        &gt;&gt;&gt; ak.connect()</span>
<span class="sd">        &gt;&gt;&gt; df = ak.DataFrame({&quot;A&quot;: ak.array([1, 2, 3]), &quot;B&quot;: ak.array([4, 5, 6])})</span>
<span class="sd">        &gt;&gt;&gt; display(df)</span>

<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |    |   A |   B |</span>
<span class="sd">        +====+=====+=====+</span>
<span class="sd">        |  0 |   1 |   4 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  1 |   2 |   5 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  2 |   3 |   6 |</span>
<span class="sd">        +----+-----+-----+</span>

<span class="sd">        Rename columns using a mapping:</span>

<span class="sd">        &gt;&gt;&gt; df.rename(column={&#39;A&#39;:&#39;a&#39;, &#39;B&#39;:&#39;c&#39;})</span>

<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |    |   a |   c |</span>
<span class="sd">        +====+=====+=====+</span>
<span class="sd">        |  0 |   1 |   4 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  1 |   2 |   5 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  2 |   3 |   6 |</span>
<span class="sd">        +----+-----+-----+</span>

<span class="sd">        Rename indexes using a mapping:</span>

<span class="sd">        &gt;&gt;&gt; df.rename(index={0:99, 2:11})</span>

<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |    |   A |   B |</span>
<span class="sd">        +====+=====+=====+</span>
<span class="sd">        |  0 |   1 |   4 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  1 |   2 |   5 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  2 |   3 |   6 |</span>
<span class="sd">        +----+-----+-----+</span>

<span class="sd">        Rename using an axis style parameter:</span>

<span class="sd">        &gt;&gt;&gt; df.rename(str.lower, axis=&#39;column&#39;)</span>

<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |    |   a |   b |</span>
<span class="sd">        +====+=====+=====+</span>
<span class="sd">        |  0 |   1 |   4 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  1 |   2 |   5 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  2 |   3 |   6 |</span>
<span class="sd">        +----+-----+-----+</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">index</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Only column or index can be renamed, cannot rename both at once&quot;</span><span class="p">)</span>

        <span class="c1"># convert the axis to the integer value and validate</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;column&quot;</span> <span class="ow">or</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;1&quot;</span><span class="p">:</span>
                <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;index&quot;</span> <span class="ow">or</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;0&quot;</span><span class="p">:</span>
                <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown axis value </span><span class="si">{</span><span class="n">axis</span><span class="si">}</span><span class="s2">. Expecting 0, 1, &#39;column&#39; or &#39;index&#39;.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rename_column</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">inplace</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">mapper</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">axis</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rename_column</span><span class="p">(</span><span class="n">mapper</span><span class="p">,</span> <span class="n">inplace</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">index</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rename_index</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">inplace</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">mapper</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">axis</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rename_index</span><span class="p">(</span><span class="n">mapper</span><span class="p">,</span> <span class="n">inplace</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Rename expects index or columns to be specified.&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="DataFrame.append">
<a class="viewcode-back" href="../../autoapi/arkouda/index.html#arkouda.dataframe.DataFrame.append">[docs]</a>
    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">ordered</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Concatenate data from &#39;other&#39; onto the end of this DataFrame, in place.</span>

<span class="sd">        Explicitly, use the arkouda concatenate function to append the data</span>
<span class="sd">        from each column in other to the end of self. This operation is done</span>
<span class="sd">        in place, in the sense that the underlying pdarrays are updated from</span>
<span class="sd">        the result of the arkouda concatenate function, rather than returning</span>
<span class="sd">        a new DataFrame object containing the result.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        other : DataFrame</span>
<span class="sd">            The DataFrame object whose data will be appended to this DataFrame.</span>
<span class="sd">        ordered: bool, default=True</span>
<span class="sd">            If False, allow rows to be interleaved for better performance (but</span>
<span class="sd">            data within a row remains together). By default, append all rows</span>
<span class="sd">            to the end, in input order.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self</span>
<span class="sd">            Appending occurs in-place, but result is returned for compatibility.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; import arkouda as ak</span>
<span class="sd">        &gt;&gt;&gt; ak.connect()</span>
<span class="sd">        &gt;&gt;&gt; df1 = ak.DataFrame({&#39;col1&#39;: [1, 2], &#39;col2&#39;: [3, 4]})</span>

<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |    |   col1 |   col2 |</span>
<span class="sd">        +====+========+========+</span>
<span class="sd">        |  0 |      1 |      3 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  1 |      2 |      4 |</span>
<span class="sd">        +----+--------+--------+</span>

<span class="sd">        &gt;&gt;&gt; df2 = ak.DataFrame({&#39;col1&#39;: [3], &#39;col2&#39;: [5]})</span>

<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |    |   col1 |   col2 |</span>
<span class="sd">        +====+========+========+</span>
<span class="sd">        |  0 |      3 |      5 |</span>
<span class="sd">        +----+--------+--------+</span>

<span class="sd">        &gt;&gt;&gt; df1.append(df2)</span>
<span class="sd">        &gt;&gt;&gt; df1</span>

<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |    |   col1 |   col2 |</span>
<span class="sd">        +====+========+========+</span>
<span class="sd">        |  0 |      1 |      3 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  1 |      2 |      4 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  2 |      3 |      5 |</span>
<span class="sd">        +----+--------+--------+</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">arkouda.util</span> <span class="kn">import</span> <span class="n">generic_concat</span> <span class="k">as</span> <span class="n">util_concatenate</span>

        <span class="c1"># Do nothing if the other dataframe is empty</span>
        <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="c1"># Check all the columns to make sure they can be concatenated</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_nrows</span><span class="p">()</span>

        <span class="n">keyset</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">)</span>
        <span class="n">keylist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">)</span>

        <span class="c1"># Allow for starting with an empty dataframe</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="bp">self</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="c1"># Keys don&#39;t match</span>
        <span class="k">elif</span> <span class="n">keyset</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">_columns</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;Key mismatch; keys must be identical in both DataFrames.&quot;</span><span class="p">)</span>
        <span class="c1"># Keys do match</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tmp_data</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keylist</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">tmp_data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">util_concatenate</span><span class="p">([</span><span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">other</span><span class="p">[</span><span class="n">key</span><span class="p">]],</span> <span class="n">ordered</span><span class="o">=</span><span class="n">ordered</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Incompatible types for column </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">])</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">[</span><span class="n">key</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">tmp_data</span>

        <span class="c1"># Clean up</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_nrows</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_empty</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="bp">self</span></div>


<div class="viewcode-block" id="DataFrame.concat">
<a class="viewcode-back" href="../../autoapi/arkouda/index.html#arkouda.dataframe.DataFrame.concat">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">concat</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">items</span><span class="p">,</span> <span class="n">ordered</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Essentially an append, but different formatting.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">arkouda.util</span> <span class="kn">import</span> <span class="n">generic_concat</span> <span class="k">as</span> <span class="n">util_concatenate</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="p">()</span>
        <span class="n">first</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">columnset</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">columnlist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
            <span class="c1"># Allow for an empty dataframe</span>
            <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">first</span><span class="p">:</span>
                <span class="n">columnset</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">_columns</span><span class="p">)</span>
                <span class="n">columnlist</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">_columns</span>
                <span class="n">first</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">_columns</span><span class="p">)</span> <span class="o">!=</span> <span class="n">columnset</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;Cannot concatenate DataFrames with mismatched columns&quot;</span><span class="p">)</span>
        <span class="c1"># if here, columns match</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columnlist</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">ret</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">util_concatenate</span><span class="p">([</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">items</span><span class="p">],</span> <span class="n">ordered</span><span class="o">=</span><span class="n">ordered</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Incompatible types for column </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ret</span></div>


<div class="viewcode-block" id="DataFrame.head">
<a class="viewcode-back" href="../../autoapi/arkouda/index.html#arkouda.dataframe.DataFrame.head">[docs]</a>
    <span class="k">def</span> <span class="nf">head</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the first `n` rows.</span>

<span class="sd">        This function returns the first `n` rows of the the dataframe. It is</span>
<span class="sd">        useful for quickly verifying data, for example, after sorting or</span>
<span class="sd">        appending rows.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        n : int, default = 5</span>
<span class="sd">            Number of rows to select.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        arkouda.dataframe.DataFrame</span>
<span class="sd">            The first `n` rows of the DataFrame.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        tail</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; import arkouda as ak</span>
<span class="sd">        &gt;&gt;&gt; ak.connect()</span>
<span class="sd">        &gt;&gt;&gt; df = ak.DataFrame({&#39;col1&#39;: ak.arange(10), &#39;col2&#39;: -1 * ak.arange(10)})</span>
<span class="sd">        &gt;&gt;&gt; display(df)</span>

<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |    |   col1 |   col2 |</span>
<span class="sd">        +====+========+========+</span>
<span class="sd">        |  0 |      0 |      0 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  1 |      1 |     -1 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  2 |      2 |     -2 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  3 |      3 |     -3 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  4 |      4 |     -4 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  5 |      5 |     -5 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  6 |      6 |     -6 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  7 |      7 |     -7 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  8 |      8 |     -8 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  9 |      9 |     -9 |</span>
<span class="sd">        +----+--------+--------+</span>

<span class="sd">        &gt;&gt;&gt; df.head()</span>

<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |    |   col1 |   col2 |</span>
<span class="sd">        +====+========+========+</span>
<span class="sd">        |  0 |      0 |      0 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  1 |      1 |     -1 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  2 |      2 |     -2 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  3 |      3 |     -3 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  4 |      4 |     -4 |</span>
<span class="sd">        +----+--------+--------+</span>

<span class="sd">        &gt;&gt;&gt; df.head(n=2)</span>

<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |    |   col1 |   col2 |</span>
<span class="sd">        +====+========+========+</span>
<span class="sd">        |  0 |      0 |      0 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  1 |      1 |     -1 |</span>
<span class="sd">        +----+--------+--------+</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="p">[:</span><span class="n">n</span><span class="p">]</span></div>


<div class="viewcode-block" id="DataFrame.tail">
<a class="viewcode-back" href="../../autoapi/arkouda/index.html#arkouda.dataframe.DataFrame.tail">[docs]</a>
    <span class="k">def</span> <span class="nf">tail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the last `n` rows.</span>

<span class="sd">        This function returns the last `n` rows for the dataframe. It is</span>
<span class="sd">        useful for quickly testing if your object has the right type of data in</span>
<span class="sd">        it.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        n : int, default=5</span>
<span class="sd">            Number of rows to select.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        arkouda.dataframe.DataFrame</span>
<span class="sd">            The last `n` rows of the DataFrame.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        arkouda.dataframe.head</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; import arkouda as ak</span>
<span class="sd">        &gt;&gt;&gt; ak.connect()</span>
<span class="sd">        &gt;&gt;&gt; df = ak.DataFrame({&#39;col1&#39;: ak.arange(10), &#39;col2&#39;: -1 * ak.arange(10)})</span>
<span class="sd">        &gt;&gt;&gt; display(df)</span>

<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |    |   col1 |   col2 |</span>
<span class="sd">        +====+========+========+</span>
<span class="sd">        |  0 |      0 |      0 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  1 |      1 |     -1 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  2 |      2 |     -2 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  3 |      3 |     -3 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  4 |      4 |     -4 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  5 |      5 |     -5 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  6 |      6 |     -6 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  7 |      7 |     -7 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  8 |      8 |     -8 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  9 |      9 |     -9 |</span>
<span class="sd">        +----+--------+--------+</span>

<span class="sd">        &gt;&gt;&gt; df.tail()</span>

<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |    |   col1 |   col2 |</span>
<span class="sd">        +====+========+========+</span>
<span class="sd">        |  0 |      5 |     -5 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  1 |      6 |     -6 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  2 |      7 |     -7 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  3 |      8 |     -8 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  4 |      9 |     -9 |</span>
<span class="sd">        +----+--------+--------+</span>

<span class="sd">        &gt;&gt;&gt; df.tail(n=2)</span>

<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |    |   col1 |   col2 |</span>
<span class="sd">        +====+========+========+</span>
<span class="sd">        |  0 |      8 |     -8 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  1 |      9 |     -9 |</span>
<span class="sd">        +----+--------+--------+</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_nrows</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nrows</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_nrows</span> <span class="o">-</span> <span class="n">n</span> <span class="p">:]</span></div>


<div class="viewcode-block" id="DataFrame.sample">
<a class="viewcode-back" href="../../autoapi/arkouda/index.html#arkouda.dataframe.DataFrame.sample">[docs]</a>
    <span class="k">def</span> <span class="nf">sample</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a random sample of `n` rows.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        n : int, default=5</span>
<span class="sd">            Number of rows to return.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        arkouda.dataframe.DataFrame</span>
<span class="sd">            The sampled `n` rows of the DataFrame.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>

<span class="sd">        &gt;&gt;&gt; df = ak.DataFrame({&quot;A&quot;: ak.arange(5), &quot;B&quot;: -1 * ak.arange(5)})</span>
<span class="sd">        &gt;&gt;&gt; display(df)</span>

<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |    |   A |   B |</span>
<span class="sd">        +====+=====+=====+</span>
<span class="sd">        |  0 |   0 |   0 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  1 |   1 |  -1 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  2 |   2 |  -2 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  3 |   3 |  -3 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  4 |   4 |  -4 |</span>
<span class="sd">        +----+-----+-----+</span>

<span class="sd">        Random output of size 3:</span>

<span class="sd">        &gt;&gt;&gt; df.sample(n=3)</span>

<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |    |   A |   B |</span>
<span class="sd">        +====+=====+=====+</span>
<span class="sd">        |  0 |   0 |   0 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  1 |   1 |  -1 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  2 |   4 |  -4 |</span>
<span class="sd">        +----+-----+-----+</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_nrows</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nrows</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">array</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nrows</span><span class="p">),</span> <span class="n">n</span><span class="p">))]</span></div>


<div class="viewcode-block" id="DataFrame.GroupBy">
<a class="viewcode-back" href="../../autoapi/arkouda/index.html#arkouda.dataframe.DataFrame.GroupBy">[docs]</a>
    <span class="k">def</span> <span class="nf">GroupBy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="n">use_series</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dropna</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Group the dataframe by a column or a list of columns.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        keys : str or list of str</span>
<span class="sd">            An (ordered) list of column names or a single string to group by.</span>
<span class="sd">        use_series : bool, default=False</span>
<span class="sd">            If True, returns an arkouda.dataframe.GroupBy object.</span>
<span class="sd">            Otherwise an arkouda.groupbyclass.GroupBy object.</span>
<span class="sd">        as_index: bool, default=True</span>
<span class="sd">            If True, groupby columns will be set as index</span>
<span class="sd">            otherwise, the groupby columns will be treated as DataFrame columns.</span>
<span class="sd">        dropna : bool, default=True</span>
<span class="sd">            If True, and the groupby keys contain NaN values,</span>
<span class="sd">            the NaN values together with the corresponding row will be dropped.</span>
<span class="sd">            Otherwise, the rows corresponding to NaN values will be kept.</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        arkouda.dataframe.GroupBy or arkouda.groupbyclass.GroupBy</span>
<span class="sd">            If use_series = True, returns an arkouda.dataframe.GroupBy object.</span>
<span class="sd">            Otherwise returns an arkouda.groupbyclass.GroupBy object.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        arkouda.GroupBy</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; import arkouda as ak</span>
<span class="sd">        &gt;&gt;&gt; ak.connect()</span>
<span class="sd">        &gt;&gt;&gt; df = ak.DataFrame({&#39;col1&#39;: [1.0, 1.0, 2.0, np.nan], &#39;col2&#39;: [4, 5, 6, 7]})</span>
<span class="sd">        &gt;&gt;&gt; df</span>

<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |    |   col1 |   col2 |</span>
<span class="sd">        +====+========+========+</span>
<span class="sd">        |  0 |      1 |      4 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  1 |      1 |      5 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  2 |      2 |      6 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  3 |    nan |      7 |</span>
<span class="sd">        +----+--------+--------+</span>

<span class="sd">        &gt;&gt;&gt; df.GroupBy(&quot;col1&quot;)</span>
<span class="sd">        &lt;arkouda.groupbyclass.GroupBy at 0x7f2cf23e10c0&gt;</span>
<span class="sd">        &gt;&gt;&gt; df.GroupBy(&quot;col1&quot;).size()</span>
<span class="sd">        (array([1.00000000000000000 2.00000000000000000]), array([2 1]))</span>

<span class="sd">        &gt;&gt;&gt; df.GroupBy(&quot;col1&quot;,use_series=True)</span>
<span class="sd">        col1</span>
<span class="sd">        1.0    2</span>
<span class="sd">        2.0    1</span>
<span class="sd">        dtype: int64</span>
<span class="sd">        &gt;&gt;&gt; df.GroupBy(&quot;col1&quot;,use_series=True, as_index = False).size()</span>

<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |    |   col1 |   size |</span>
<span class="sd">        +====+========+========+</span>
<span class="sd">        |  0 |      1 |      2 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  1 |      2 |      1 |</span>
<span class="sd">        +----+--------+--------+</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_nrows</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">cols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">keys</span><span class="p">]</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;keys must be a column name or a list/tuple of column names&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">cols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">]</span>

        <span class="n">gb</span> <span class="o">=</span> <span class="n">akGroupBy</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span> <span class="n">dropna</span><span class="o">=</span><span class="n">dropna</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">use_series</span><span class="p">:</span>
            <span class="n">gb</span> <span class="o">=</span> <span class="n">GroupBy</span><span class="p">(</span><span class="n">gb</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">gb_key_names</span><span class="o">=</span><span class="n">keys</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="n">as_index</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">gb</span></div>


<div class="viewcode-block" id="DataFrame.memory_usage">
<a class="viewcode-back" href="../../autoapi/arkouda/index.html#arkouda.dataframe.DataFrame.memory_usage">[docs]</a>
    <span class="k">def</span> <span class="nf">memory_usage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;GB&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Print the size of this DataFrame.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        unit : str, default = &quot;GB&quot;</span>
<span class="sd">            Unit to return. One of {&#39;KB&#39;, &#39;MB&#39;, &#39;GB&#39;}.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">            The number of bytes used by this DataFrame in [unit]s.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; import arkouda as ak</span>
<span class="sd">        &gt;&gt;&gt; ak.connect()</span>
<span class="sd">        &gt;&gt;&gt; df = ak.DataFrame({&#39;col1&#39;: ak.arange(1000), &#39;col2&#39;: ak.arange(1000)})</span>
<span class="sd">        &gt;&gt;&gt; df.memory_usage()</span>
<span class="sd">        &#39;0.00 GB&#39;</span>

<span class="sd">        &gt;&gt;&gt; df.memory_usage(unit=&quot;KB&quot;)</span>
<span class="sd">        &#39;15 KB&#39;</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">KB</span> <span class="o">=</span> <span class="mi">1024</span>
        <span class="n">MB</span> <span class="o">=</span> <span class="n">KB</span> <span class="o">*</span> <span class="n">KB</span>
        <span class="n">GB</span> <span class="o">=</span> <span class="n">MB</span> <span class="o">*</span> <span class="n">KB</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bytes</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">pdarray</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_bytes</span> <span class="o">+=</span> <span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span><span class="o">.</span><span class="n">itemsize</span> <span class="o">*</span> <span class="n">val</span><span class="o">.</span><span class="n">size</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Strings</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_bytes</span> <span class="o">+=</span> <span class="n">val</span><span class="o">.</span><span class="n">nbytes</span>
        <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;B&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;</span><span class="si">{:}</span><span class="s2"> B&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_bytes</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;MB&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;</span><span class="si">{:}</span><span class="s2"> MB&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_bytes</span> <span class="o">/</span> <span class="n">MB</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;KB&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;</span><span class="si">{:}</span><span class="s2"> KB&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_bytes</span> <span class="o">/</span> <span class="n">KB</span><span class="p">))</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2"> GB&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_bytes</span> <span class="o">/</span> <span class="n">GB</span><span class="p">)</span></div>


<div class="viewcode-block" id="DataFrame.to_pandas">
<a class="viewcode-back" href="../../autoapi/arkouda/index.html#arkouda.dataframe.DataFrame.to_pandas">[docs]</a>
    <span class="k">def</span> <span class="nf">to_pandas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">datalimit</span><span class="o">=</span><span class="n">maxTransferBytes</span><span class="p">,</span> <span class="n">retain_index</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Send this DataFrame to a pandas DataFrame.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        datalimit : int, default=arkouda.client.maxTransferBytes</span>
<span class="sd">            The maximum number size, in megabytes to transfer. The requested</span>
<span class="sd">            DataFrame will be converted to a pandas DataFrame only if the</span>
<span class="sd">            estimated size of the DataFrame does not exceed this value.</span>

<span class="sd">        retain_index : bool, default=False</span>
<span class="sd">            Normally, to_pandas() creates a new range index object. If you want</span>
<span class="sd">            to keep the index column, set this to True.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pandas.DataFrame</span>
<span class="sd">            The result of converting this DataFrame to a pandas DataFrame.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; import arkouda as ak</span>
<span class="sd">        &gt;&gt;&gt; ak.connect()</span>
<span class="sd">        &gt;&gt;&gt; ak_df = ak.DataFrame({&quot;A&quot;: ak.arange(2), &quot;B&quot;: -1 * ak.arange(2)})</span>
<span class="sd">        &gt;&gt;&gt; type(ak_df)</span>
<span class="sd">        arkouda.dataframe.DataFrame</span>
<span class="sd">        &gt;&gt;&gt; display(ak_df)</span>

<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |    |   A |   B |</span>
<span class="sd">        +====+=====+=====+</span>
<span class="sd">        |  0 |   0 |   0 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  1 |   1 |  -1 |</span>
<span class="sd">        +----+-----+-----+</span>

<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; pd_df = ak_df.to_pandas()</span>
<span class="sd">        &gt;&gt;&gt; type(pd_df)</span>
<span class="sd">        pandas.core.frame.DataFrame</span>
<span class="sd">        &gt;&gt;&gt; display(pd_df)</span>

<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |    |   A |   B |</span>
<span class="sd">        +====+=====+=====+</span>
<span class="sd">        |  0 |   0 |   0 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  1 |   1 |  -1 |</span>
<span class="sd">        +----+-----+-----+</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_nrows</span><span class="p">()</span>

        <span class="c1"># Estimate how much memory would be required for this DataFrame</span>
        <span class="n">nbytes</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">pdarray</span><span class="p">):</span>
                <span class="n">nbytes</span> <span class="o">+=</span> <span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span><span class="o">.</span><span class="n">itemsize</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nrows</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Strings</span><span class="p">):</span>
                <span class="n">nbytes</span> <span class="o">+=</span> <span class="n">val</span><span class="o">.</span><span class="n">nbytes</span>

        <span class="n">KB</span> <span class="o">=</span> <span class="mi">1024</span>
        <span class="n">MB</span> <span class="o">=</span> <span class="n">KB</span> <span class="o">*</span> <span class="n">KB</span>
        <span class="n">GB</span> <span class="o">=</span> <span class="n">MB</span> <span class="o">*</span> <span class="n">KB</span>

        <span class="c1"># Get units that make the most sense.</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="n">nbytes</span> <span class="o">&lt;</span> <span class="n">KB</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:,}</span><span class="s2"> B&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nbytes</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">nbytes</span> <span class="o">&lt;</span> <span class="n">MB</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:,}</span><span class="s2"> KB&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">nbytes</span> <span class="o">/</span> <span class="n">KB</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">nbytes</span> <span class="o">&lt;</span> <span class="n">GB</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:,}</span><span class="s2"> MB&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">nbytes</span> <span class="o">/</span> <span class="n">MB</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;This transfer will use </span><span class="si">{</span><span class="n">msg</span><span class="si">}</span><span class="s2"> .&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:,}</span><span class="s2"> GB&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">nbytes</span> <span class="o">/</span> <span class="n">GB</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;This will transfer </span><span class="si">{</span><span class="n">msg</span><span class="si">}</span><span class="s2"> from arkouda to pandas.&quot;</span><span class="p">)</span>
        <span class="c1"># If the total memory transfer requires more than `datalimit` per</span>
        <span class="c1"># column, we will warn the user and return.</span>
        <span class="k">if</span> <span class="n">nbytes</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">datalimit</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">)</span> <span class="o">*</span> <span class="n">MB</span><span class="p">):</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;This operation would transfer more than </span><span class="si">{</span><span class="n">datalimit</span><span class="si">}</span><span class="s2"> bytes.&quot;</span>
            <span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="ne">UserWarning</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="c1"># Proceed with conversion if possible</span>
        <span class="n">pandas_data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">:</span>
            <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># in order for proper pandas functionality, SegArrays must be seen as 1d</span>
                <span class="c1"># and therefore need to be converted to list</span>
                <span class="n">pandas_data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span><span class="o">.</span><span class="n">to_ndarray</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">SegArray</span><span class="p">)</span> <span class="k">else</span> <span class="n">val</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;Bad index type or format.&quot;</span><span class="p">)</span>

        <span class="c1"># Return a new dataframe with original indices if requested.</span>
        <span class="k">if</span> <span class="n">retain_index</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">pandas_data</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">pandas_data</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">_prep_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># if no columns are stored, we will save all columns</span>
        <span class="k">if</span> <span class="n">columns</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="n">c</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">}</span>

        <span class="k">if</span> <span class="n">index</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Index&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span>
        <span class="k">return</span> <span class="n">data</span>

<div class="viewcode-block" id="DataFrame.to_hdf">
<a class="viewcode-back" href="../../autoapi/arkouda/index.html#arkouda.dataframe.DataFrame.to_hdf">[docs]</a>
    <span class="k">def</span> <span class="nf">to_hdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">file_type</span><span class="o">=</span><span class="s2">&quot;distribute&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Save DataFrame to disk as hdf5, preserving column names.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        path : str</span>
<span class="sd">            File path to save data.</span>
<span class="sd">        index : bool, default=False</span>
<span class="sd">            If True, save the index column. By default, do not save the index.</span>
<span class="sd">        columns: List, default = None</span>
<span class="sd">            List of columns to include in the file. If None, writes out all columns.</span>
<span class="sd">        file_type: str (single | distribute), default=distribute</span>
<span class="sd">            Whether to save to a single file or distribute across Locales.</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            Raised if a server-side error is thrown saving the pdarray.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This method saves one file per locale of the arkouda server. All</span>
<span class="sd">        files are prefixed by the path argument and suffixed by their</span>
<span class="sd">        locale number.</span>

<span class="sd">        See Also</span>
<span class="sd">        ---------</span>
<span class="sd">        to_parquet</span>
<span class="sd">        load</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; import arkouda as ak</span>
<span class="sd">        &gt;&gt;&gt; ak.connect()</span>
<span class="sd">        &gt;&gt;&gt; import os.path</span>
<span class="sd">        &gt;&gt;&gt; from pathlib import Path</span>
<span class="sd">        &gt;&gt;&gt; my_path = os.path.join(os.getcwd(), &#39;hdf_output&#39;)</span>
<span class="sd">        &gt;&gt;&gt; Path(my_path).mkdir(parents=True, exist_ok=True)</span>

<span class="sd">        &gt;&gt;&gt; df = ak.DataFrame({&quot;A&quot;:[1,2],&quot;B&quot;:[3,4]})</span>
<span class="sd">        &gt;&gt;&gt; df.to_hdf(my_path + &quot;/my_data&quot;)</span>
<span class="sd">        &gt;&gt;&gt; df.load(my_path + &quot;/my_data&quot;)</span>

<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |    |   A |   B |</span>
<span class="sd">        +====+=====+=====+</span>
<span class="sd">        |  0 |   1 |   3 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  1 |   2 |   4 |</span>
<span class="sd">        +----+-----+-----+</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">arkouda.io</span> <span class="kn">import</span> <span class="n">to_hdf</span>

        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prep_data</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
        <span class="n">to_hdf</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">prefix_path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="n">file_type</span><span class="o">=</span><span class="n">file_type</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">_to_hdf_snapshot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="s2">&quot;DataFrame&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;truncate&quot;</span><span class="p">,</span> <span class="n">file_type</span><span class="o">=</span><span class="s2">&quot;distribute&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Save a dataframe as a group with columns within the group. This allows saving other</span>
<span class="sd">        datasets in the HDF5 file without impacting the integrity of the dataframe</span>
<span class="sd">        This is only used for the snapshot workflow</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        path : str</span>
<span class="sd">            File path to save data</span>
<span class="sd">        dataset: str</span>
<span class="sd">            Name to save the dataframe under within the file</span>
<span class="sd">            Only used when as_dataset=True</span>
<span class="sd">        mode: str (truncate | append), default=truncate</span>
<span class="sd">            Indicates whether the dataset should truncate the file and write or append</span>
<span class="sd">            to the file</span>
<span class="sd">            Only used when as_dataset=True</span>
<span class="sd">        file_type: str (single | distribute), default=distribute</span>
<span class="sd">            Whether to save to a single file or distribute across Locales</span>
<span class="sd">            Only used when as_dataset=True</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            Raised if a server-side error is thrown saving the pdarray</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">arkouda.categorical</span> <span class="kn">import</span> <span class="n">Categorical</span> <span class="k">as</span> <span class="n">Categorical_</span>
        <span class="kn">from</span> <span class="nn">arkouda.io</span> <span class="kn">import</span> <span class="n">_file_type_to_int</span><span class="p">,</span> <span class="n">_mode_str_to_int</span>

        <span class="n">column_data</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">name</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="p">(</span><span class="n">Categorical_</span><span class="p">,</span> <span class="n">SegArray</span><span class="p">))</span>
            <span class="k">else</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="s2">&quot;codes&quot;</span><span class="p">:</span> <span class="n">obj</span><span class="o">.</span><span class="n">codes</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                    <span class="s2">&quot;categories&quot;</span><span class="p">:</span> <span class="n">obj</span><span class="o">.</span><span class="n">categories</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                    <span class="s2">&quot;NA_codes&quot;</span><span class="p">:</span> <span class="n">obj</span><span class="o">.</span><span class="n">_akNAcode</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                    <span class="o">**</span><span class="p">({</span><span class="s2">&quot;permutation&quot;</span><span class="p">:</span> <span class="n">obj</span><span class="o">.</span><span class="n">permutation</span><span class="o">.</span><span class="n">name</span><span class="p">}</span> <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">permutation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">{}),</span>
                    <span class="o">**</span><span class="p">({</span><span class="s2">&quot;segments&quot;</span><span class="p">:</span> <span class="n">obj</span><span class="o">.</span><span class="n">segments</span><span class="o">.</span><span class="n">name</span><span class="p">}</span> <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">segments</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">{}),</span>
                <span class="p">}</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">Categorical_</span><span class="p">)</span>
            <span class="k">else</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">({</span><span class="s2">&quot;segments&quot;</span><span class="p">:</span> <span class="n">obj</span><span class="o">.</span><span class="n">segments</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;values&quot;</span><span class="p">:</span> <span class="n">obj</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">name</span><span class="p">})</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">]</span>
        <span class="n">dtypes</span> <span class="o">=</span> <span class="p">[</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">categories</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">Categorical_</span><span class="p">)</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        <span class="p">]</span>
        <span class="n">col_objTypes</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">special_objType</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;special_objType&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="n">obj</span><span class="o">.</span><span class="n">objType</span>
            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        <span class="p">]</span>
        <span class="k">return</span> <span class="n">cast</span><span class="p">(</span>
            <span class="nb">str</span><span class="p">,</span>
            <span class="n">generic_msg</span><span class="p">(</span>
                <span class="n">cmd</span><span class="o">=</span><span class="s2">&quot;tohdf&quot;</span><span class="p">,</span>
                <span class="n">args</span><span class="o">=</span><span class="p">{</span>
                    <span class="s2">&quot;filename&quot;</span><span class="p">:</span> <span class="n">path</span><span class="p">,</span>
                    <span class="s2">&quot;dset&quot;</span><span class="p">:</span> <span class="n">dataset</span><span class="p">,</span>
                    <span class="s2">&quot;file_format&quot;</span><span class="p">:</span> <span class="n">_file_type_to_int</span><span class="p">(</span><span class="n">file_type</span><span class="p">),</span>
                    <span class="s2">&quot;write_mode&quot;</span><span class="p">:</span> <span class="n">_mode_str_to_int</span><span class="p">(</span><span class="n">mode</span><span class="p">),</span>
                    <span class="s2">&quot;objType&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">objType</span><span class="p">,</span>
                    <span class="s2">&quot;num_cols&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">),</span>
                    <span class="s2">&quot;column_names&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                    <span class="s2">&quot;column_objTypes&quot;</span><span class="p">:</span> <span class="n">col_objTypes</span><span class="p">,</span>
                    <span class="s2">&quot;column_dtypes&quot;</span><span class="p">:</span> <span class="n">dtypes</span><span class="p">,</span>
                    <span class="s2">&quot;columns&quot;</span><span class="p">:</span> <span class="n">column_data</span><span class="p">,</span>
                    <span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="p">},</span>
            <span class="p">),</span>
        <span class="p">)</span>

<div class="viewcode-block" id="DataFrame.update_hdf">
<a class="viewcode-back" href="../../autoapi/arkouda/index.html#arkouda.dataframe.DataFrame.update_hdf">[docs]</a>
    <span class="k">def</span> <span class="nf">update_hdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prefix_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">repack</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Overwrite the dataset with the name provided with this dataframe. If</span>
<span class="sd">        the dataset does not exist it is added.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        prefix_path : str</span>
<span class="sd">            Directory and filename prefix that all output files share.</span>
<span class="sd">        index : bool, default=False</span>
<span class="sd">            If True, save the index column. By default, do not save the index.</span>
<span class="sd">        columns: List, default=None</span>
<span class="sd">            List of columns to include in the file. If None, writes out all columns.</span>
<span class="sd">        repack: bool, default=True</span>
<span class="sd">            HDF5 does not release memory on delete. When True, the inaccessible</span>
<span class="sd">            data (that was overwritten) is removed. When False, the data remains, but is</span>
<span class="sd">            inaccessible. Setting to false will yield better performance, but will cause</span>
<span class="sd">            file sizes to expand.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            Success message if successful.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            Raised if a server-side error is thrown saving the pdarray.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        If file does not contain File_Format attribute to indicate how it was saved,</span>
<span class="sd">          the file name is checked for _LOCALE#### to determine if it is distributed.</span>
<span class="sd">        If the dataset provided does not exist, it will be added.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; import arkouda as ak</span>
<span class="sd">        &gt;&gt;&gt; ak.connect()</span>
<span class="sd">        &gt;&gt;&gt; import os.path</span>
<span class="sd">        &gt;&gt;&gt; from pathlib import Path</span>
<span class="sd">        &gt;&gt;&gt; my_path = os.path.join(os.getcwd(), &#39;hdf_output&#39;)</span>
<span class="sd">        &gt;&gt;&gt; Path(my_path).mkdir(parents=True, exist_ok=True)</span>

<span class="sd">        &gt;&gt;&gt; df = ak.DataFrame({&quot;A&quot;:[1,2],&quot;B&quot;:[3,4]})</span>
<span class="sd">        &gt;&gt;&gt; df.to_hdf(my_path + &quot;/my_data&quot;)</span>
<span class="sd">        &gt;&gt;&gt; df.load(my_path + &quot;/my_data&quot;)</span>

<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |    |   A |   B |</span>
<span class="sd">        +====+=====+=====+</span>
<span class="sd">        |  0 |   1 |   3 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  1 |   2 |   4 |</span>
<span class="sd">        +----+-----+-----+</span>

<span class="sd">        &gt;&gt;&gt; df2 = ak.DataFrame({&quot;A&quot;:[5,6],&quot;B&quot;:[7,8]})</span>
<span class="sd">        &gt;&gt;&gt; df2.update_hdf(my_path + &quot;/my_data&quot;)</span>
<span class="sd">        &gt;&gt;&gt; df.load(my_path + &quot;/my_data&quot;)</span>

<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |    |   A |   B |</span>
<span class="sd">        +====+=====+=====+</span>
<span class="sd">        |  0 |   5 |   7 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  1 |   6 |   8 |</span>
<span class="sd">        +----+-----+-----+</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">arkouda.io</span> <span class="kn">import</span> <span class="n">update_hdf</span>

        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prep_data</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
        <span class="n">update_hdf</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">prefix_path</span><span class="o">=</span><span class="n">prefix_path</span><span class="p">,</span> <span class="n">repack</span><span class="o">=</span><span class="n">repack</span><span class="p">)</span></div>


<div class="viewcode-block" id="DataFrame.to_parquet">
<a class="viewcode-back" href="../../autoapi/arkouda/index.html#arkouda.dataframe.DataFrame.to_parquet">[docs]</a>
    <span class="k">def</span> <span class="nf">to_parquet</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">path</span><span class="p">,</span>
        <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">compression</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">convert_categoricals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Save DataFrame to disk as parquet, preserving column names.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        path : str</span>
<span class="sd">            File path to save data.</span>
<span class="sd">        index : bool, default=False</span>
<span class="sd">            If True, save the index column. By default, do not save the index.</span>
<span class="sd">        columns: list</span>
<span class="sd">            List of columns to include in the file. If None, writes out all columns.</span>
<span class="sd">        compression : str (Optional), default=None</span>
<span class="sd">            Provide the compression type to use when writing the file.</span>
<span class="sd">            Supported values: snappy, gzip, brotli, zstd, lz4</span>
<span class="sd">        convert_categoricals: bool, default=False</span>
<span class="sd">            Parquet requires all columns to be the same size and Categoricals</span>
<span class="sd">            don&#39;t satisfy that requirement.</span>
<span class="sd">            If set, write the equivalent Strings in place of any Categorical columns.</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            Raised if a server-side error is thrown saving the pdarray</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This method saves one file per locale of the arkouda server. All</span>
<span class="sd">        files are prefixed by the path argument and suffixed by their</span>
<span class="sd">        locale number.</span>

<span class="sd">        See Also</span>
<span class="sd">        ---------</span>
<span class="sd">        to_hdf</span>
<span class="sd">        load</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; import arkouda as ak</span>
<span class="sd">        &gt;&gt;&gt; ak.connect()</span>
<span class="sd">        &gt;&gt;&gt; import os.path</span>
<span class="sd">        &gt;&gt;&gt; from pathlib import Path</span>
<span class="sd">        &gt;&gt;&gt; my_path = os.path.join(os.getcwd(), &#39;parquet_output&#39;)</span>
<span class="sd">        &gt;&gt;&gt; Path(my_path).mkdir(parents=True, exist_ok=True)</span>

<span class="sd">        &gt;&gt;&gt; df = ak.DataFrame({&quot;A&quot;:[1,2],&quot;B&quot;:[3,4]})</span>
<span class="sd">        &gt;&gt;&gt; df.to_parquet(my_path + &quot;/my_data&quot;)</span>
<span class="sd">        &gt;&gt;&gt; df.load(my_path + &quot;/my_data&quot;)</span>

<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |    |   B |   A |</span>
<span class="sd">        +====+=====+=====+</span>
<span class="sd">        |  0 |   3 |   1 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  1 |   4 |   2 |</span>
<span class="sd">        +----+-----+-----+</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">arkouda.io</span> <span class="kn">import</span> <span class="n">to_parquet</span>

        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prep_data</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">convert_categoricals</span> <span class="ow">and</span> <span class="nb">any</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Categorical</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;to_parquet doesn&#39;t support Categorical columns. To write the equivalent &quot;</span>
                <span class="s2">&quot;Strings in place of any Categorical columns, rerun with convert_categoricals &quot;</span>
                <span class="s2">&quot;set to True.&quot;</span>
            <span class="p">)</span>
        <span class="n">to_parquet</span><span class="p">(</span>
            <span class="n">data</span><span class="p">,</span>
            <span class="n">prefix_path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>
            <span class="n">compression</span><span class="o">=</span><span class="n">compression</span><span class="p">,</span>
            <span class="n">convert_categoricals</span><span class="o">=</span><span class="n">convert_categoricals</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="DataFrame.to_csv">
<a class="viewcode-back" href="../../autoapi/arkouda/index.html#arkouda.dataframe.DataFrame.to_csv">[docs]</a>
    <span class="nd">@typechecked</span>
    <span class="k">def</span> <span class="nf">to_csv</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">index</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">col_delim</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span>
        <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes DataFrame to CSV file(s). File will contain a column for each column in the DataFrame.</span>
<span class="sd">        All CSV Files written by Arkouda include a header denoting data types of the columns.</span>
<span class="sd">        Unlike other file formats, CSV files store Strings as their UTF-8 format instead of storing</span>
<span class="sd">        bytes as uint(8).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        path: str</span>
<span class="sd">            The filename prefix to be used for saving files. Files will have _LOCALE#### appended</span>
<span class="sd">            when they are written to disk.</span>
<span class="sd">        index: bool, default=False</span>
<span class="sd">            If True, the index of the DataFrame will be written to the file</span>
<span class="sd">            as a column.</span>
<span class="sd">        columns: list of str (Optional)</span>
<span class="sd">            Column names to assign when writing data.</span>
<span class="sd">        col_delim: str, default=&quot;,&quot;</span>
<span class="sd">            Value to be used to separate columns within the file.</span>
<span class="sd">            Please be sure that the value used DOES NOT appear in your dataset.</span>
<span class="sd">        overwrite: bool, default=False</span>
<span class="sd">            If True, any existing files matching your provided prefix_path will</span>
<span class="sd">            be overwritten. If False, an error will be returned if existing files are found.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Raised if all datasets are not present in all parquet files or if one or</span>
<span class="sd">            more of the specified files do not exist.</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            Raised if one or more of the specified files cannot be opened.</span>
<span class="sd">            If `allow_errors` is true this may be raised if no values are returned</span>
<span class="sd">            from the server.</span>
<span class="sd">        TypeError</span>
<span class="sd">            Raised if we receive an unknown arkouda_type returned from the server.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        - CSV format is not currently supported by load/load_all operations.</span>
<span class="sd">        - The column delimiter is expected to be the same for column names and data.</span>
<span class="sd">        - Be sure that column delimiters are not found within your data.</span>
<span class="sd">        - All CSV files must delimit rows using newline (&quot;\\n&quot;) at this time.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; import arkouda as ak</span>
<span class="sd">        &gt;&gt;&gt; ak.connect()</span>
<span class="sd">        &gt;&gt;&gt; import os.path</span>
<span class="sd">        &gt;&gt;&gt; from pathlib import Path</span>
<span class="sd">        &gt;&gt;&gt; my_path = os.path.join(os.getcwd(), &#39;csv_output&#39;)</span>
<span class="sd">        &gt;&gt;&gt; Path(my_path).mkdir(parents=True, exist_ok=True)</span>

<span class="sd">        &gt;&gt;&gt; df = ak.DataFrame({&quot;A&quot;:[1,2],&quot;B&quot;:[3,4]})</span>
<span class="sd">        &gt;&gt;&gt; df.to_csv(my_path + &quot;/my_data&quot;)</span>
<span class="sd">        &gt;&gt;&gt; df2 = DataFrame.read_csv(my_path + &quot;/my_data&quot; + &quot;_LOCALE0000&quot;)</span>
<span class="sd">        &gt;&gt;&gt; display(df2)</span>

<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |    |   A |   B |</span>
<span class="sd">        +====+=====+=====+</span>
<span class="sd">        |  0 |   1 |   3 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  1 |   2 |   4 |</span>
<span class="sd">        +----+-----+-----+</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">arkouda.io</span> <span class="kn">import</span> <span class="n">to_csv</span>

        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prep_data</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
        <span class="n">to_csv</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">col_delim</span><span class="o">=</span><span class="n">col_delim</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="n">overwrite</span><span class="p">)</span></div>


<div class="viewcode-block" id="DataFrame.read_csv">
<a class="viewcode-back" href="../../autoapi/arkouda/index.html#arkouda.dataframe.DataFrame.read_csv">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">read_csv</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">col_delim</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Read the columns of a CSV file into an Arkouda DataFrame.</span>
<span class="sd">        If the file contains the appropriately formatted header, typed data will be returned.</span>
<span class="sd">        Otherwise, all data will be returned as a Strings objects.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        filename: str</span>
<span class="sd">            Filename to read data from.</span>
<span class="sd">        col_delim: str, default=&quot;,&quot;</span>
<span class="sd">            The delimiter for columns within the data.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        arkouda.dataframe.DataFrame</span>
<span class="sd">            Arkouda DataFrame containing the columns from the CSV file.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Raised if all datasets are not present in all parquet files or if one or</span>
<span class="sd">            more of the specified files do not exist.</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            Raised if one or more of the specified files cannot be opened.</span>
<span class="sd">            If `allow_errors` is true this may be raised if no values are returned</span>
<span class="sd">            from the server.</span>
<span class="sd">        TypeError</span>
<span class="sd">            Raised if we receive an unknown arkouda_type returned from the server.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        to_csv</span>

<span class="sd">        Notes</span>
<span class="sd">        ------</span>
<span class="sd">        - CSV format is not currently supported by load/load_all operations.</span>
<span class="sd">        - The column delimiter is expected to be the same for column names and data.</span>
<span class="sd">        - Be sure that column delimiters are not found within your data.</span>
<span class="sd">        - All CSV files must delimit rows using newline (&quot;\\n&quot;) at this time.</span>
<span class="sd">        - Unlike other file formats, CSV files store Strings as their UTF-8 format instead of storing</span>
<span class="sd">        bytes as uint(8).</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; import arkouda as ak</span>
<span class="sd">        &gt;&gt;&gt; ak.connect()</span>
<span class="sd">        &gt;&gt;&gt; import os.path</span>
<span class="sd">        &gt;&gt;&gt; from pathlib import Path</span>
<span class="sd">        &gt;&gt;&gt; my_path = os.path.join(os.getcwd(), &#39;csv_output&#39;,&#39;my_data&#39;)</span>
<span class="sd">        &gt;&gt;&gt; Path(my_path).mkdir(parents=True, exist_ok=True)</span>

<span class="sd">        &gt;&gt;&gt; df = ak.DataFrame({&quot;A&quot;:[1,2],&quot;B&quot;:[3,4]})</span>
<span class="sd">        &gt;&gt;&gt; df.to_csv(my_path)</span>
<span class="sd">        &gt;&gt;&gt; df2 = DataFrame.read_csv(my_path + &quot;_LOCALE0000&quot;)</span>
<span class="sd">        &gt;&gt;&gt; display(df2)</span>

<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |    |   A |   B |</span>
<span class="sd">        +====+=====+=====+</span>
<span class="sd">        |  0 |   1 |   3 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  1 |   2 |   4 |</span>
<span class="sd">        +----+-----+-----+</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">arkouda.io</span> <span class="kn">import</span> <span class="n">read_csv</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">read_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">column_delim</span><span class="o">=</span><span class="n">col_delim</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></div>


<div class="viewcode-block" id="DataFrame.save">
<a class="viewcode-back" href="../../autoapi/arkouda/index.html#arkouda.dataframe.DataFrame.save">[docs]</a>
    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">path</span><span class="p">,</span>
        <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">file_format</span><span class="o">=</span><span class="s2">&quot;HDF5&quot;</span><span class="p">,</span>
        <span class="n">file_type</span><span class="o">=</span><span class="s2">&quot;distribute&quot;</span><span class="p">,</span>
        <span class="n">compression</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        DEPRECATED</span>
<span class="sd">        Save DataFrame to disk, preserving column names.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        path : str</span>
<span class="sd">            File path to save data.</span>
<span class="sd">        index : bool, default=False</span>
<span class="sd">            If True, save the index column. By default, do not save the index.</span>
<span class="sd">        columns: list, default=None</span>
<span class="sd">            List of columns to include in the file. If None, writes out all columns.</span>
<span class="sd">        file_format : str, default=&#39;HDF5&#39;</span>
<span class="sd">            &#39;HDF5&#39; or &#39;Parquet&#39;. Defaults to &#39;HDF5&#39;</span>
<span class="sd">        file_type : str, default=distribute</span>
<span class="sd">            &quot;single&quot; or &quot;distribute&quot;</span>
<span class="sd">            If single, will right a single file to locale 0.</span>
<span class="sd">        compression: str (Optional)</span>
<span class="sd">            (None | &quot;snappy&quot; | &quot;gzip&quot; | &quot;brotli&quot; | &quot;zstd&quot; | &quot;lz4&quot;)</span>
<span class="sd">            Compression type. Only used for Parquet</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This method saves one file per locale of the arkouda server. All</span>
<span class="sd">        files are prefixed by the path argument and suffixed by their</span>
<span class="sd">        locale number.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        to_parquet, to_hdf</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; import arkouda as ak</span>
<span class="sd">        &gt;&gt;&gt; ak.connect()</span>
<span class="sd">        &gt;&gt;&gt; import os.path</span>
<span class="sd">        &gt;&gt;&gt; from pathlib import Path</span>
<span class="sd">        &gt;&gt;&gt; my_path = os.path.join(os.getcwd(), &#39;hdf5_output&#39;)</span>
<span class="sd">        &gt;&gt;&gt; Path(my_path).mkdir(parents=True, exist_ok=True)</span>

<span class="sd">        &gt;&gt;&gt; df = ak.DataFrame({&quot;A&quot;: ak.arange(5), &quot;B&quot;: -1 * ak.arange(5)})</span>
<span class="sd">        &gt;&gt;&gt; df.save(my_path + &#39;/my_data&#39;, file_type=&quot;single&quot;)</span>
<span class="sd">        &gt;&gt;&gt; df.load(my_path + &#39;/my_data&#39;)</span>

<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |    |   A |   B |</span>
<span class="sd">        +====+=====+=====+</span>
<span class="sd">        |  0 |   0 |   0 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  1 |   1 |  -1 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  2 |   2 |  -2 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  3 |   3 |  -3 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  4 |   4 |  -4 |</span>
<span class="sd">        +----+-----+-----+</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;ak.DataFrame.save has been deprecated. &quot;</span>
            <span class="s2">&quot;Please use ak.DataFrame.to_hdf or ak.DataFrame.to_parquet&quot;</span><span class="p">,</span>
            <span class="ne">DeprecationWarning</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">file_format</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;hdf5&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">file_type</span><span class="o">=</span><span class="n">file_type</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">file_format</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;parquet&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">compression</span><span class="o">=</span><span class="n">compression</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Valid file types are HDF5 or Parquet&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="DataFrame.load">
<a class="viewcode-back" href="../../autoapi/arkouda/index.html#arkouda.dataframe.DataFrame.load">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prefix_path</span><span class="p">,</span> <span class="n">file_format</span><span class="o">=</span><span class="s2">&quot;INFER&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Load dataframe from file.</span>
<span class="sd">        file_format needed for consistency with other load functions.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        prefix_path : str</span>
<span class="sd">            The prefix path for the data.</span>

<span class="sd">        file_format : string, default = &quot;INFER&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        arkouda.dataframe.DataFrame</span>
<span class="sd">            A dataframe loaded from the prefix_path.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        To store data in &lt;my_dir&gt;/my_data_LOCALE0000,</span>
<span class="sd">        use &quot;&lt;my_dir&gt;/my_data&quot; as the prefix.</span>

<span class="sd">        &gt;&gt;&gt; import arkouda as ak</span>
<span class="sd">        &gt;&gt;&gt; ak.connect()</span>
<span class="sd">        &gt;&gt;&gt; import os.path</span>
<span class="sd">        &gt;&gt;&gt; from pathlib import Path</span>
<span class="sd">        &gt;&gt;&gt; my_path = os.path.join(os.getcwd(), &#39;hdf5_output&#39;,&#39;my_data&#39;)</span>
<span class="sd">        &gt;&gt;&gt; Path(my_path).mkdir(parents=True, exist_ok=True)</span>
<span class="sd">        &gt;&gt;&gt; df = ak.DataFrame({&quot;A&quot;: ak.arange(5), &quot;B&quot;: -1 * ak.arange(5)})</span>
<span class="sd">        &gt;&gt;&gt; df.save(my_path, file_type=&quot;distribute&quot;)</span>
<span class="sd">        &gt;&gt;&gt; df.load(my_path)</span>

<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |    |   A |   B |</span>
<span class="sd">        +====+=====+=====+</span>
<span class="sd">        |  0 |   0 |   0 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  1 |   1 |  -1 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  2 |   2 |  -2 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  3 |   3 |  -3 |</span>
<span class="sd">        +----+-----+-----+</span>
<span class="sd">        |  4 |   4 |  -4 |</span>
<span class="sd">        +----+-----+-----+</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">arkouda.io</span> <span class="kn">import</span> <span class="p">(</span>
            <span class="n">_dict_recombine_segarrays_categoricals</span><span class="p">,</span>
            <span class="n">get_filetype</span><span class="p">,</span>
            <span class="n">load_all</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">prefix</span><span class="p">,</span> <span class="n">extension</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">prefix_path</span><span class="p">)</span>
        <span class="n">first_file</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">_LOCALE0000</span><span class="si">{</span><span class="n">extension</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">filetype</span> <span class="o">=</span> <span class="n">get_filetype</span><span class="p">(</span><span class="n">first_file</span><span class="p">)</span> <span class="k">if</span> <span class="n">file_format</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;infer&quot;</span> <span class="k">else</span> <span class="n">file_format</span>

        <span class="c1"># columns load backwards</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="n">_dict_recombine_segarrays_categoricals</span><span class="p">(</span><span class="n">load_all</span><span class="p">(</span><span class="n">prefix_path</span><span class="p">,</span> <span class="n">file_format</span><span class="o">=</span><span class="n">filetype</span><span class="p">)))</span>
        <span class="c1"># if parquet, return reversed dataframe to match what was saved</span>
        <span class="k">return</span> <span class="n">df</span> <span class="k">if</span> <span class="n">filetype</span> <span class="o">==</span> <span class="s2">&quot;HDF5&quot;</span> <span class="k">else</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span></div>


<div class="viewcode-block" id="DataFrame.argsort">
<a class="viewcode-back" href="../../autoapi/arkouda/index.html#arkouda.dataframe.DataFrame.argsort">[docs]</a>
    <span class="k">def</span> <span class="nf">argsort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the permutation that sorts the dataframe by `key`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key : str</span>
<span class="sd">            The key to sort on.</span>
<span class="sd">        ascending : bool, default = True</span>
<span class="sd">            If true, sort the key in ascending order.</span>
<span class="sd">            Otherwise, sort the key in descending order.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        arkouda.pdarrayclass.pdarray</span>
<span class="sd">            The permutation array that sorts the data on `key`.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        coargsort</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; import arkouda as ak</span>
<span class="sd">        &gt;&gt;&gt; ak.connect()</span>
<span class="sd">        &gt;&gt;&gt; df = ak.DataFrame({&#39;col1&#39;: [1.1, 3.1, 2.1], &#39;col2&#39;: [6, 5, 4]})</span>
<span class="sd">        &gt;&gt;&gt; display(df)</span>

<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |    |   col1 |   col2 |</span>
<span class="sd">        +====+========+========+</span>
<span class="sd">        |  0 |    1.1 |      6 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  1 |    3.1 |      5 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  2 |    2.1 |      4 |</span>
<span class="sd">        +----+--------+--------+</span>

<span class="sd">        &gt;&gt;&gt; df.argsort(&#39;col1&#39;)</span>
<span class="sd">        array([0 2 1])</span>
<span class="sd">        &gt;&gt;&gt; sorted_df1 = df[df.argsort(&#39;col1&#39;)]</span>
<span class="sd">        &gt;&gt;&gt; display(sorted_df1)</span>

<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |    |   col1 |   col2 |</span>
<span class="sd">        +====+========+========+</span>
<span class="sd">        |  0 |    1.1 |      6 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  1 |    2.1 |      4 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  2 |    3.1 |      5 |</span>
<span class="sd">        +----+--------+--------+</span>

<span class="sd">        &gt;&gt;&gt; df.argsort(&#39;col2&#39;)</span>
<span class="sd">        array([2 1 0])</span>
<span class="sd">        &gt;&gt;&gt; sorted_df2 = df[df.argsort(&#39;col2&#39;)]</span>
<span class="sd">        &gt;&gt;&gt; display(sorted_df2)</span>

<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |    |   col1 |   col2 |</span>
<span class="sd">        +====+========+========+</span>
<span class="sd">        |  0 |    2.1 |      4 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  1 |    3.1 |      5 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  2 |    1.1 |      6 |</span>
<span class="sd">        +----+--------+--------+</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_empty</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">akint64</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ascending</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">argsort</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">pdarray</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">in</span> <span class="p">(</span>
                <span class="n">akint64</span><span class="p">,</span>
                <span class="n">akfloat64</span><span class="p">,</span>
            <span class="p">):</span>
                <span class="k">return</span> <span class="n">argsort</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">argsort</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">])[</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nrows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)]</span></div>


<div class="viewcode-block" id="DataFrame.coargsort">
<a class="viewcode-back" href="../../autoapi/arkouda/index.html#arkouda.dataframe.DataFrame.coargsort">[docs]</a>
    <span class="k">def</span> <span class="nf">coargsort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the permutation that sorts the dataframe by `keys`.</span>

<span class="sd">        Note: Sorting using Strings may not yield correct sort order.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        keys : list of str</span>
<span class="sd">            The keys to sort on.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        arkouda.pdarrayclass.pdarray</span>
<span class="sd">            The permutation array that sorts the data on `keys`.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>

<span class="sd">        &gt;&gt;&gt; df = ak.DataFrame({&#39;col1&#39;: [2, 2, 1], &#39;col2&#39;: [3, 4, 3], &#39;col3&#39;:[5, 6, 7]})</span>
<span class="sd">        &gt;&gt;&gt; display(df)</span>

<span class="sd">        +----+--------+--------+--------+</span>
<span class="sd">        |    |   col1 |   col2 |   col3 |</span>
<span class="sd">        +====+========+========+========+</span>
<span class="sd">        |  0 |      2 |      3 |      5 |</span>
<span class="sd">        +----+--------+--------+--------+</span>
<span class="sd">        |  1 |      2 |      4 |      6 |</span>
<span class="sd">        +----+--------+--------+--------+</span>
<span class="sd">        |  2 |      1 |      3 |      7 |</span>
<span class="sd">        +----+--------+--------+--------+</span>

<span class="sd">        &gt;&gt;&gt; df.coargsort([&#39;col1&#39;, &#39;col2&#39;])</span>
<span class="sd">        array([2 0 1])</span>
<span class="sd">        &gt;&gt;&gt;</span>


<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_empty</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">akint64</span><span class="p">)</span>
        <span class="n">arrays</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
            <span class="n">arrays</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">coargsort</span><span class="p">(</span><span class="n">arrays</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ascending</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nrows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
        <span class="k">return</span> <span class="n">i</span></div>


    <span class="k">def</span> <span class="nf">_reindex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">MultiIndex</span><span class="p">):</span>
            <span class="n">new_index</span> <span class="o">=</span> <span class="n">MultiIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">Index</span><span class="p">):</span>
            <span class="n">new_index</span> <span class="o">=</span> <span class="n">Index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_index</span> <span class="o">=</span> <span class="n">Index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">new_index</span><span class="p">)</span>

<div class="viewcode-block" id="DataFrame.sort_index">
<a class="viewcode-back" href="../../autoapi/arkouda/index.html#arkouda.dataframe.DataFrame.sort_index">[docs]</a>
    <span class="k">def</span> <span class="nf">sort_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sort the DataFrame by indexed columns.</span>

<span class="sd">        Note: Fails on sort order of arkouda.strings.Strings columns when multiple columns being sorted.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ascending : bool, default = True</span>
<span class="sd">            Sort values in ascending (default) or descending order.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>

<span class="sd">        &gt;&gt;&gt; df = ak.DataFrame({&#39;col1&#39;: [1.1, 3.1, 2.1], &#39;col2&#39;: [6, 5, 4]},</span>
<span class="sd">        ...          index = Index(ak.array([2,0,1]), name=&quot;idx&quot;))</span>

<span class="sd">        &gt;&gt;&gt; display(df)</span>

<span class="sd">        +----+--------+--------+</span>
<span class="sd">        | idx|   col1 |   col2 |</span>
<span class="sd">        +====+========+========+</span>
<span class="sd">        |  0 |    1.1 |      6 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  1 |    3.1 |      5 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  2 |    2.1 |      4 |</span>
<span class="sd">        +----+--------+--------+</span>

<span class="sd">        &gt;&gt;&gt; df.sort_index()</span>

<span class="sd">        +----+--------+--------+</span>
<span class="sd">        | idx|   col1 |   col2 |</span>
<span class="sd">        +====+========+========+</span>
<span class="sd">        |  0 |    3.1 |      5 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  1 |    2.1 |      4 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  2 |    1.1 |      6 |</span>
<span class="sd">        +----+--------+--------+</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="n">ascending</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reindex</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span></div>


<div class="viewcode-block" id="DataFrame.sort_values">
<a class="viewcode-back" href="../../autoapi/arkouda/index.html#arkouda.dataframe.DataFrame.sort_values">[docs]</a>
    <span class="k">def</span> <span class="nf">sort_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sort the DataFrame by one or more columns.</span>

<span class="sd">        If no column is specified, all columns are used.</span>

<span class="sd">        Note: Fails on order of arkouda.strings.Strings columns when multiple columns being sorted.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        by : str or list/tuple of str, default = None</span>
<span class="sd">            The name(s) of the column(s) to sort by.</span>
<span class="sd">        ascending : bool, default = True</span>
<span class="sd">            Sort values in ascending (default) or descending order.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        apply_permutation</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; import arkouda as ak</span>
<span class="sd">        &gt;&gt;&gt; ak.connect()</span>
<span class="sd">        &gt;&gt;&gt; df = ak.DataFrame({&#39;col1&#39;: [2, 2, 1], &#39;col2&#39;: [3, 4, 3], &#39;col3&#39;:[5, 6, 7]})</span>
<span class="sd">        &gt;&gt;&gt; display(df)</span>

<span class="sd">        +----+--------+--------+--------+</span>
<span class="sd">        |    |   col1 |   col2 |   col3 |</span>
<span class="sd">        +====+========+========+========+</span>
<span class="sd">        |  0 |      2 |      3 |      5 |</span>
<span class="sd">        +----+--------+--------+--------+</span>
<span class="sd">        |  1 |      2 |      4 |      6 |</span>
<span class="sd">        +----+--------+--------+--------+</span>
<span class="sd">        |  2 |      1 |      3 |      7 |</span>
<span class="sd">        +----+--------+--------+--------+</span>

<span class="sd">        &gt;&gt;&gt; df.sort_values()</span>

<span class="sd">        +----+--------+--------+--------+</span>
<span class="sd">        |    |   col1 |   col2 |   col3 |</span>
<span class="sd">        +====+========+========+========+</span>
<span class="sd">        |  0 |      1 |      3 |      7 |</span>
<span class="sd">        +----+--------+--------+--------+</span>
<span class="sd">        |  1 |      2 |      3 |      5 |</span>
<span class="sd">        +----+--------+--------+--------+</span>
<span class="sd">        |  2 |      2 |      4 |      6 |</span>
<span class="sd">        +----+--------+--------+--------+</span>

<span class="sd">        &gt;&gt;&gt; df.sort_values(&quot;col3&quot;)</span>

<span class="sd">        +----+--------+--------+--------+</span>
<span class="sd">        |    |   col1 |   col2 |   col3 |</span>
<span class="sd">        +====+========+========+========+</span>
<span class="sd">        |  0 |      1 |      3 |      7 |</span>
<span class="sd">        +----+--------+--------+--------+</span>
<span class="sd">        |  1 |      2 |      3 |      5 |</span>
<span class="sd">        +----+--------+--------+--------+</span>
<span class="sd">        |  2 |      2 |      4 |      6 |</span>
<span class="sd">        +----+--------+--------+--------+</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_empty</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">akint64</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">by</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="n">ascending</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coargsort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="n">ascending</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">by</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">by</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="n">ascending</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">by</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coargsort</span><span class="p">(</span><span class="n">by</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="n">ascending</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Column name(s) must be str or list/tuple of str&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></div>


<div class="viewcode-block" id="DataFrame.apply_permutation">
<a class="viewcode-back" href="../../autoapi/arkouda/index.html#arkouda.dataframe.DataFrame.apply_permutation">[docs]</a>
    <span class="k">def</span> <span class="nf">apply_permutation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">perm</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply a permutation to an entire DataFrame.  The operation is done in</span>
<span class="sd">        place and the original DataFrame will be modified.</span>

<span class="sd">        This may be useful if you want to unsort an DataFrame, or even to</span>
<span class="sd">        apply an arbitrary permutation such as the inverse of a sorting</span>
<span class="sd">        permutation.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        perm : pdarray</span>
<span class="sd">            A permutation array. Should be the same size as the data</span>
<span class="sd">            arrays, and should consist of the integers [0,size-1] in</span>
<span class="sd">            some order. Very minimal testing is done to ensure this</span>
<span class="sd">            is a permutation.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        sort</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; import arkouda as ak</span>
<span class="sd">        &gt;&gt;&gt; ak.connect()</span>
<span class="sd">        &gt;&gt;&gt; df = ak.DataFrame({&#39;col1&#39;: [1, 2, 3], &#39;col2&#39;: [4, 5, 6]})</span>

<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |    |   col1 |   col2 |</span>
<span class="sd">        +====+========+========+</span>
<span class="sd">        |  0 |      1 |      4 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  1 |      2 |      5 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  2 |      3 |      6 |</span>
<span class="sd">        +----+--------+--------+</span>

<span class="sd">        &gt;&gt;&gt; perm_arry = ak.array([0, 2, 1])</span>
<span class="sd">        &gt;&gt;&gt; df.apply_permutation(perm_arry)</span>
<span class="sd">        &gt;&gt;&gt; display(df)</span>

<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |    |   col1 |   col2 |</span>
<span class="sd">        +====+========+========+</span>
<span class="sd">        |  0 |      1 |      4 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  1 |      3 |      6 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  2 |      2 |      5 |</span>
<span class="sd">        +----+--------+--------+</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">perm</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">perm</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">!=</span> <span class="n">perm</span><span class="o">.</span><span class="n">size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The indicated permutation is invalid.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">unique</span><span class="p">(</span><span class="n">perm</span><span class="p">)</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">perm</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The indicated permutation is invalid.&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="n">perm</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">perm</span><span class="p">])</span></div>


<div class="viewcode-block" id="DataFrame.filter_by_range">
<a class="viewcode-back" href="../../autoapi/arkouda/index.html#arkouda.dataframe.DataFrame.filter_by_range">[docs]</a>
    <span class="k">def</span> <span class="nf">filter_by_range</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="n">low</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Find all rows where the value count of the items in a given set of</span>
<span class="sd">        columns (keys) is within the range [low, high].</span>

<span class="sd">        To filter by a specific value, set low == high.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        keys : str or list of str</span>
<span class="sd">            The names of the columns to group by.</span>
<span class="sd">        low : int, default=1</span>
<span class="sd">            The lowest value count.</span>
<span class="sd">        high : int, default=None</span>
<span class="sd">            The highest value count, default to unlimited.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        arkouda.pdarrayclass.pdarray</span>
<span class="sd">            An array of boolean values for qualified rows in this DataFrame.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>

<span class="sd">        &gt;&gt;&gt; df = ak.DataFrame({&#39;col1&#39;: [1, 2, 2, 2, 3, 3], &#39;col2&#39;: [4, 5, 6, 7, 8, 9]})</span>
<span class="sd">        &gt;&gt;&gt; display(df)</span>

<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |    |   col1 |   col2 |</span>
<span class="sd">        +====+========+========+</span>
<span class="sd">        |  0 |      1 |      4 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  1 |      2 |      5 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  2 |      2 |      6 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  3 |      2 |      7 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  4 |      3 |      8 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  5 |      3 |      9 |</span>
<span class="sd">        +----+--------+--------+</span>

<span class="sd">        &gt;&gt;&gt; df.filter_by_range(&quot;col1&quot;, low=1, high=2)</span>
<span class="sd">        array([True False False False True True])</span>

<span class="sd">        &gt;&gt;&gt; filtered_df = df[df.filter_by_range(&quot;col1&quot;, low=1, high=2)]</span>
<span class="sd">        &gt;&gt;&gt; display(filtered_df)</span>

<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |    |   col1 |   col2 |</span>
<span class="sd">        +====+========+========+</span>
<span class="sd">        |  0 |      1 |      4 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  1 |      3 |      8 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  2 |      3 |      9 |</span>
<span class="sd">        +----+--------+--------+</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">keys</span><span class="p">]</span>
        <span class="n">gb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GroupBy</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">use_series</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">vals</span><span class="p">,</span> <span class="n">cts</span> <span class="o">=</span> <span class="n">gb</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">high</span><span class="p">:</span>
            <span class="n">positions</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">cts</span> <span class="o">&gt;=</span> <span class="n">low</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">positions</span> <span class="o">=</span> <span class="n">where</span><span class="p">(((</span><span class="n">cts</span> <span class="o">&gt;=</span> <span class="n">low</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">cts</span> <span class="o">&lt;=</span> <span class="n">high</span><span class="p">)),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="n">broadcast</span> <span class="o">=</span> <span class="n">gb</span><span class="o">.</span><span class="n">broadcast</span><span class="p">(</span><span class="n">positions</span><span class="p">,</span> <span class="n">permute</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">broadcast</span> <span class="o">=</span> <span class="n">broadcast</span> <span class="o">==</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">broadcast</span><span class="p">[</span><span class="n">invert_permutation</span><span class="p">(</span><span class="n">gb</span><span class="o">.</span><span class="n">permutation</span><span class="p">)]</span></div>


<div class="viewcode-block" id="DataFrame.copy">
<a class="viewcode-back" href="../../autoapi/arkouda/index.html#arkouda.dataframe.DataFrame.copy">[docs]</a>
    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Make a copy of this object&#39;s data.</span>

<span class="sd">        When `deep = True` (default), a new object will be created with a copy of</span>
<span class="sd">        the calling object&#39;s data. Modifications to the data of the copy will not</span>
<span class="sd">        be reflected in the original object.</span>


<span class="sd">        When `deep = False` a new object will be created without copying the</span>
<span class="sd">        calling object&#39;s data. Any changes to the data of the original object will</span>
<span class="sd">        be reflected in the shallow copy, and vice versa.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        deep : bool, default=True</span>
<span class="sd">            When True, return a deep copy. Otherwise, return a shallow copy.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        arkouda.dataframe.DataFrame</span>
<span class="sd">            A deep or shallow copy according to caller specification.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; import arkouda as ak</span>
<span class="sd">        &gt;&gt;&gt; ak.connect()</span>
<span class="sd">        &gt;&gt;&gt; df = ak.DataFrame({&#39;col1&#39;: [1, 2], &#39;col2&#39;: [3, 4]})</span>
<span class="sd">        &gt;&gt;&gt; display(df)</span>

<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |    |   col1 |   col2 |</span>
<span class="sd">        +====+========+========+</span>
<span class="sd">        |  0 |      1 |      3 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  1 |      2 |      4 |</span>
<span class="sd">        +----+--------+--------+</span>

<span class="sd">        &gt;&gt;&gt; df_deep = df.copy(deep=True)</span>
<span class="sd">        &gt;&gt;&gt; df_deep[&#39;col1&#39;] +=1</span>
<span class="sd">        &gt;&gt;&gt; display(df)</span>

<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |    |   col1 |   col2 |</span>
<span class="sd">        +====+========+========+</span>
<span class="sd">        |  0 |      1 |      3 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  1 |      2 |      4 |</span>
<span class="sd">        +----+--------+--------+</span>

<span class="sd">        &gt;&gt;&gt; df_shallow = df.copy(deep=False)</span>
<span class="sd">        &gt;&gt;&gt; df_shallow[&#39;col1&#39;] +=1</span>
<span class="sd">        &gt;&gt;&gt; display(df)</span>

<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |    |   col1 |   col2 |</span>
<span class="sd">        +====+========+========+</span>
<span class="sd">        |  0 |      2 |      3 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  1 |      3 |      4 |</span>
<span class="sd">        +----+--------+--------+</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">deep</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">()</span>
            <span class="n">res</span><span class="o">.</span><span class="n">_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nrows</span>
            <span class="n">res</span><span class="o">.</span><span class="n">_bytes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bytes</span>
            <span class="n">res</span><span class="o">.</span><span class="n">_empty</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_empty</span>
            <span class="n">res</span><span class="o">.</span><span class="n">_columns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">[:]</span>  <span class="c1"># if this is not a slice, droping columns modifies both</span>

            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">res</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span><span class="p">[:]</span>

            <span class="c1"># if this is not a slice, renaming indexes with update both</span>
            <span class="n">res</span><span class="o">.</span><span class="n">_set_index</span><span class="p">(</span><span class="n">Index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">index</span><span class="p">[:]))</span>

            <span class="k">return</span> <span class="n">res</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>


<div class="viewcode-block" id="DataFrame.groupby">
<a class="viewcode-back" href="../../autoapi/arkouda/index.html#arkouda.dataframe.DataFrame.groupby">[docs]</a>
    <span class="k">def</span> <span class="nf">groupby</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="n">use_series</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dropna</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Group the dataframe by a column or a list of columns.  Alias for GroupBy.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        keys : str or list of str</span>
<span class="sd">            An (ordered) list of column names or a single string to group by.</span>
<span class="sd">        use_series : bool, default=True</span>
<span class="sd">            If True, returns an arkouda.dataframe.GroupBy object.</span>
<span class="sd">            Otherwise an arkouda.groupbyclass.GroupBy object.</span>
<span class="sd">        as_index: bool, default=True</span>
<span class="sd">            If True, groupby columns will be set as index</span>
<span class="sd">            otherwise, the groupby columns will be treated as DataFrame columns.</span>
<span class="sd">        dropna : bool, default=True</span>
<span class="sd">            If True, and the groupby keys contain NaN values,</span>
<span class="sd">            the NaN values together with the corresponding row will be dropped.</span>
<span class="sd">            Otherwise, the rows corresponding to NaN values will be kept.</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        arkouda.dataframe.GroupBy or arkouda.groupbyclass.GroupBy</span>
<span class="sd">            If use_series = True, returns an arkouda.dataframe.GroupBy object.</span>
<span class="sd">            Otherwise returns an arkouda.groupbyclass.GroupBy object.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        arkouda.GroupBy</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; import arkouda as ak</span>
<span class="sd">        &gt;&gt;&gt; ak.connect()</span>
<span class="sd">        &gt;&gt;&gt; df = ak.DataFrame({&#39;col1&#39;: [1.0, 1.0, 2.0, np.nan], &#39;col2&#39;: [4, 5, 6, 7]})</span>
<span class="sd">        &gt;&gt;&gt; df</span>

<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |    |   col1 |   col2 |</span>
<span class="sd">        +====+========+========+</span>
<span class="sd">        |  0 |      1 |      4 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  1 |      1 |      5 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  2 |      2 |      6 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  3 |    nan |      7 |</span>
<span class="sd">        +----+--------+--------+</span>

<span class="sd">        &gt;&gt;&gt; df.GroupBy(&quot;col1&quot;)</span>
<span class="sd">        &lt;arkouda.groupbyclass.GroupBy at 0x7f2cf23e10c0&gt;</span>
<span class="sd">        &gt;&gt;&gt; df.GroupBy(&quot;col1&quot;).size()</span>
<span class="sd">        (array([1.00000000000000000 2.00000000000000000]), array([2 1]))</span>

<span class="sd">        &gt;&gt;&gt; df.GroupBy(&quot;col1&quot;,use_series=True)</span>
<span class="sd">        col1</span>
<span class="sd">        1.0    2</span>
<span class="sd">        2.0    1</span>
<span class="sd">        dtype: int64</span>
<span class="sd">        &gt;&gt;&gt; df.GroupBy(&quot;col1&quot;,use_series=True, as_index = False).size()</span>

<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |    |   col1 |   size |</span>
<span class="sd">        +====+========+========+</span>
<span class="sd">        |  0 |      1 |      2 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  1 |      2 |      1 |</span>
<span class="sd">        +----+--------+--------+</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">GroupBy</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">use_series</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="n">as_index</span><span class="p">,</span> <span class="n">dropna</span><span class="o">=</span><span class="n">dropna</span><span class="p">)</span></div>


<div class="viewcode-block" id="DataFrame.isin">
<a class="viewcode-back" href="../../autoapi/arkouda/index.html#arkouda.dataframe.DataFrame.isin">[docs]</a>
    <span class="nd">@typechecked</span>
    <span class="k">def</span> <span class="nf">isin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pdarray</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Series</span><span class="p">,</span> <span class="n">DataFrame</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determine whether each element in the DataFrame is contained in values.</span>

<span class="sd">        Parameters</span>
<span class="sd">        __________</span>
<span class="sd">        values : pdarray, dict, Series, or DataFrame</span>
<span class="sd">            The values to check for in DataFrame. Series can only have a single index.</span>

<span class="sd">        Returns</span>
<span class="sd">        _______</span>
<span class="sd">        arkouda.dataframe.DataFrame</span>
<span class="sd">            Arkouda DataFrame of booleans showing whether each element in the DataFrame is</span>
<span class="sd">            contained in values.</span>

<span class="sd">        See Also</span>
<span class="sd">        ________</span>
<span class="sd">        ak.Series.isin</span>

<span class="sd">        Notes</span>
<span class="sd">        _____</span>
<span class="sd">        - Pandas supports values being an iterable type. In arkouda, we replace this with pdarray.</span>
<span class="sd">        - Pandas supports ~ operations. Currently, ak.DataFrame does not support this.</span>

<span class="sd">        Examples</span>
<span class="sd">        ________</span>

<span class="sd">        &gt;&gt;&gt; import arkouda as ak</span>
<span class="sd">        &gt;&gt;&gt; ak.connect()</span>
<span class="sd">        &gt;&gt;&gt; df = ak.DataFrame({&#39;col_A&#39;: ak.array([7, 3]), &#39;col_B&#39;:ak.array([1, 9])})</span>
<span class="sd">        &gt;&gt;&gt; display(df)</span>

<span class="sd">        +----+---------+---------+</span>
<span class="sd">        |    |   col_A |   col_B |</span>
<span class="sd">        +====+=========+=========+</span>
<span class="sd">        |  0 |       7 |       1 |</span>
<span class="sd">        +----+---------+---------+</span>
<span class="sd">        |  1 |       3 |       9 |</span>
<span class="sd">        +----+---------+---------+</span>

<span class="sd">        When `values` is a pdarray, check every value in the DataFrame to determine if</span>
<span class="sd">        it exists in values.</span>

<span class="sd">        &gt;&gt;&gt; df.isin(ak.array([0, 1]))</span>

<span class="sd">        +----+---------+---------+</span>
<span class="sd">        |    |   col_A |   col_B |</span>
<span class="sd">        +====+=========+=========+</span>
<span class="sd">        |  0 |       0 |       1 |</span>
<span class="sd">        +----+---------+---------+</span>
<span class="sd">        |  1 |       0 |       0 |</span>
<span class="sd">        +----+---------+---------+</span>

<span class="sd">        When `values` is a dict, the values in the dict are passed to check the column</span>
<span class="sd">        indicated by the key.</span>

<span class="sd">        &gt;&gt;&gt; df.isin({&#39;col_A&#39;: ak.array([0, 3])})</span>

<span class="sd">        +----+---------+---------+</span>
<span class="sd">        |    |   col_A |   col_B |</span>
<span class="sd">        +====+=========+=========+</span>
<span class="sd">        |  0 |       0 |       0 |</span>
<span class="sd">        +----+---------+---------+</span>
<span class="sd">        |  1 |       1 |       0 |</span>
<span class="sd">        +----+---------+---------+</span>

<span class="sd">        When `values` is a Series, each column is checked if values is present positionally.</span>
<span class="sd">        This means that for `True` to be returned, the indexes must be the same.</span>

<span class="sd">        &gt;&gt;&gt; i = ak.Index(ak.arange(2))</span>
<span class="sd">        &gt;&gt;&gt; s = ak.Series(data=[3, 9], index=i)</span>
<span class="sd">        &gt;&gt;&gt; df.isin(s)</span>

<span class="sd">        +----+---------+---------+</span>
<span class="sd">        |    |   col_A |   col_B |</span>
<span class="sd">        +====+=========+=========+</span>
<span class="sd">        |  0 |       0 |       0 |</span>
<span class="sd">        +----+---------+---------+</span>
<span class="sd">        |  1 |       0 |       1 |</span>
<span class="sd">        +----+---------+---------+</span>

<span class="sd">        When `values` is a DataFrame, the index and column must match.</span>
<span class="sd">        Note that 9 is not found because the column name does not match.</span>

<span class="sd">        &gt;&gt;&gt; other_df = ak.DataFrame({&#39;col_A&#39;:ak.array([7, 3]), &#39;col_C&#39;:ak.array([0, 9])})</span>
<span class="sd">        &gt;&gt;&gt; df.isin(other_df)</span>

<span class="sd">        +----+---------+---------+</span>
<span class="sd">        |    |   col_A |   col_B |</span>
<span class="sd">        +====+=========+=========+</span>
<span class="sd">        |  0 |       1 |       0 |</span>
<span class="sd">        +----+---------+---------+</span>
<span class="sd">        |  1 |       1 |       0 |</span>
<span class="sd">        +----+---------+---------+</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">pdarray</span><span class="p">):</span>
            <span class="c1"># flatten the DataFrame so single in1d can be used.</span>
            <span class="n">flat_in1d</span> <span class="o">=</span> <span class="n">in1d</span><span class="p">(</span><span class="n">concatenate</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">())),</span> <span class="n">values</span><span class="p">)</span>
            <span class="n">segs</span> <span class="o">=</span> <span class="n">concatenate</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">]),</span>
                    <span class="n">cumsum</span><span class="p">(</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">size</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">])),</span>
                <span class="p">]</span>
            <span class="p">)</span>
            <span class="n">df_def</span> <span class="o">=</span> <span class="p">{</span><span class="n">col</span><span class="p">:</span> <span class="n">flat_in1d</span><span class="p">[</span><span class="n">segs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">:</span> <span class="n">segs</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">)}</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">Dict</span><span class="p">):</span>
            <span class="c1"># key is column name, val is the list of values to check</span>
            <span class="n">df_def</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">col</span><span class="p">:</span> <span class="p">(</span>
                    <span class="n">in1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">values</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>
                    <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">values</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
                    <span class="k">else</span> <span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nrows</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">akbool</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span>
            <span class="p">}</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">DataFrame</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
            <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">Series</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">Index</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="c1"># create the dataframe with all false</span>
            <span class="n">df_def</span> <span class="o">=</span> <span class="p">{</span><span class="n">col</span><span class="p">:</span> <span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nrows</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">akbool</span><span class="p">)</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">}</span>
            <span class="c1"># identify the indexes in both</span>
            <span class="n">rows_self</span><span class="p">,</span> <span class="n">rows_val</span> <span class="o">=</span> <span class="n">intersect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">values</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="c1"># used to sort the rows with only the indexes in both</span>
            <span class="n">sort_self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">rows_self</span><span class="p">]</span><span class="o">.</span><span class="n">argsort</span><span class="p">()</span>
            <span class="n">sort_val</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">rows_val</span><span class="p">]</span><span class="o">.</span><span class="n">argsort</span><span class="p">()</span>
            <span class="c1"># update values in columns that exist in both. only update the rows whose indexes match</span>

            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">DataFrame</span><span class="p">)</span> <span class="ow">and</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">values</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                    <span class="n">df_def</span><span class="p">[</span><span class="n">col</span><span class="p">][</span><span class="n">rows_self</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">][</span><span class="n">rows_self</span><span class="p">][</span><span class="n">sort_self</span><span class="p">]</span> <span class="o">==</span> <span class="n">values</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">][</span><span class="n">rows_val</span><span class="p">][</span><span class="n">sort_val</span><span class="p">]</span>
                    <span class="p">)</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">Series</span><span class="p">):</span>
                    <span class="n">df_def</span><span class="p">[</span><span class="n">col</span><span class="p">][</span><span class="n">rows_self</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">][</span><span class="n">rows_self</span><span class="p">][</span><span class="n">sort_self</span><span class="p">]</span> <span class="o">==</span> <span class="n">values</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">rows_val</span><span class="p">][</span><span class="n">sort_val</span><span class="p">]</span>
                    <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># pandas provides the same error in this case</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot compute isin with duplicate axis.&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">df_def</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">)</span></div>


<div class="viewcode-block" id="DataFrame.corr">
<a class="viewcode-back" href="../../autoapi/arkouda/index.html#arkouda.dataframe.DataFrame.corr">[docs]</a>
    <span class="k">def</span> <span class="nf">corr</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return new DataFrame with pairwise correlation of columns.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        arkouda.dataframe.DataFrame</span>
<span class="sd">            Arkouda DataFrame containing correlation matrix of all columns.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            Raised if there&#39;s a server-side error thrown.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        pdarray.corr</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Generates the correlation matrix using Pearson R for all columns.</span>

<span class="sd">        Attempts to convert to numeric values where possible for inclusion in the matrix.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>

<span class="sd">        &gt;&gt;&gt; df = ak.DataFrame({&#39;col1&#39;: [1, 2], &#39;col2&#39;: [-1, -2]})</span>
<span class="sd">        &gt;&gt;&gt; display(df)</span>

<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |    |   col1 |   col2 |</span>
<span class="sd">        +====+========+========+</span>
<span class="sd">        |  0 |      1 |     -1 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  1 |      2 |     -2 |</span>
<span class="sd">        +----+--------+--------+</span>

<span class="sd">        &gt;&gt;&gt; corr = df.corr()</span>

<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |    |   col1 |   col2 |</span>
<span class="sd">        +====+========+========+</span>
<span class="sd">        |  0 |      1 |     -1 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  1 |     -1 |      1 |</span>
<span class="sd">        +----+--------+--------+</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">numeric_help</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">Strings</span><span class="p">):</span>
                <span class="n">d</span> <span class="o">=</span> <span class="n">Categorical</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">d</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">pdarray</span><span class="p">)</span> <span class="k">else</span> <span class="n">d</span><span class="o">.</span><span class="n">codes</span>

        <span class="n">args</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">),</span>
            <span class="s2">&quot;columns&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
            <span class="s2">&quot;data_names&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">numeric_help</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">c</span><span class="p">])</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">],</span>
        <span class="p">}</span>

        <span class="n">ret_dict</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">generic_msg</span><span class="p">(</span><span class="n">cmd</span><span class="o">=</span><span class="s2">&quot;corrMatrix&quot;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">({</span><span class="n">c</span><span class="p">:</span> <span class="n">create_pdarray</span><span class="p">(</span><span class="n">ret_dict</span><span class="p">[</span><span class="n">c</span><span class="p">])</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">})</span></div>


<div class="viewcode-block" id="DataFrame.merge">
<a class="viewcode-back" href="../../autoapi/arkouda/index.html#arkouda.dataframe.DataFrame.merge">[docs]</a>
    <span class="nd">@typechecked</span>
    <span class="k">def</span> <span class="nf">merge</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">right</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span>
        <span class="n">on</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">how</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;inner&quot;</span><span class="p">,</span>
        <span class="n">left_suffix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;_x&quot;</span><span class="p">,</span>
        <span class="n">right_suffix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;_y&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Merge Arkouda DataFrames with a database-style join.</span>
<span class="sd">        The resulting dataframe contains rows from both DataFrames as specified by</span>
<span class="sd">        the merge condition (based on the &quot;how&quot; and &quot;on&quot; parameters).</span>

<span class="sd">        Based on pandas merge functionality.</span>
<span class="sd">        https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.merge.html</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        right: DataFrame</span>
<span class="sd">            The Right DataFrame to be joined.</span>
<span class="sd">        on: Optional[Union[str, List[str]]] = None</span>
<span class="sd">            The name or list of names of the DataFrame column(s) to join on.</span>
<span class="sd">            If on is None, this defaults to the intersection of the columns in both DataFrames.</span>
<span class="sd">        how:  {&quot;inner&quot;, &quot;left&quot;, &quot;right}, default = &quot;inner&quot;</span>
<span class="sd">            The merge condition.</span>
<span class="sd">            Must be &quot;inner&quot;, &quot;left&quot;, or &quot;right&quot;.</span>
<span class="sd">        left_suffix: str, default = &quot;_x&quot;</span>
<span class="sd">            A string indicating the suffix to add to columns from the left dataframe for overlapping</span>
<span class="sd">            column names in both left and right. Defaults to &quot;_x&quot;. Only used when how is &quot;inner&quot;.</span>
<span class="sd">        right_suffix: str, default = &quot;_y&quot;</span>
<span class="sd">            A string indicating the suffix to add to columns from the right dataframe for overlapping</span>
<span class="sd">            column names in both left and right. Defaults to &quot;_y&quot;. Only used when how is &quot;inner&quot;.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        arkouda.dataframe.DataFrame</span>
<span class="sd">            Joined Arkouda DataFrame.</span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        Multiple column joins are only supported for integer columns.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; import arkouda as ak</span>
<span class="sd">        &gt;&gt;&gt; ak.connect()</span>
<span class="sd">        &gt;&gt;&gt; left_df = ak.DataFrame({&#39;col1&#39;: ak.arange(5), &#39;col2&#39;: -1 * ak.arange(5)})</span>
<span class="sd">        &gt;&gt;&gt; display(left_df)</span>

<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |    |   col1 |   col2 |</span>
<span class="sd">        +====+========+========+</span>
<span class="sd">        |  0 |      0 |      0 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  1 |      1 |     -1 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  2 |      2 |     -2 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  3 |      3 |     -3 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  4 |      4 |     -4 |</span>
<span class="sd">        +----+--------+--------+</span>

<span class="sd">        &gt;&gt;&gt; right_df = ak.DataFrame({&#39;col1&#39;: 2 * ak.arange(5), &#39;col2&#39;: 2 * ak.arange(5)})</span>
<span class="sd">        &gt;&gt;&gt; display(right_df)</span>

<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |    |   col1 |   col2 |</span>
<span class="sd">        +====+========+========+</span>
<span class="sd">        |  0 |      0 |      0 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  1 |      2 |      2 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  2 |      4 |      4 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  3 |      6 |      6 |</span>
<span class="sd">        +----+--------+--------+</span>
<span class="sd">        |  4 |      8 |      8 |</span>
<span class="sd">        +----+--------+--------+</span>

<span class="sd">        &gt;&gt;&gt; left_df.merge(right_df, on = &quot;col1&quot;)</span>

<span class="sd">        +----+--------+----------+----------+</span>
<span class="sd">        |    |   col1 |   col2_x |   col2_y |</span>
<span class="sd">        +====+========+==========+==========+</span>
<span class="sd">        |  0 |      0 |        0 |        0 |</span>
<span class="sd">        +----+--------+----------+----------+</span>
<span class="sd">        |  1 |      2 |       -2 |        2 |</span>
<span class="sd">        +----+--------+----------+----------+</span>
<span class="sd">        |  2 |      4 |       -4 |        4 |</span>
<span class="sd">        +----+--------+----------+----------+</span>

<span class="sd">        &gt;&gt;&gt; left_df.merge(right_df, on = &quot;col1&quot;, how = &quot;left&quot;)</span>

<span class="sd">        +----+--------+----------+----------+</span>
<span class="sd">        |    |   col1 |   col2_y |   col2_x |</span>
<span class="sd">        +====+========+==========+==========+</span>
<span class="sd">        |  0 |      0 |        0 |        0 |</span>
<span class="sd">        +----+--------+----------+----------+</span>
<span class="sd">        |  1 |      2 |        2 |       -2 |</span>
<span class="sd">        +----+--------+----------+----------+</span>
<span class="sd">        |  2 |      4 |        4 |       -4 |</span>
<span class="sd">        +----+--------+----------+----------+</span>
<span class="sd">        |  3 |      1 |      nan |       -1 |</span>
<span class="sd">        +----+--------+----------+----------+</span>
<span class="sd">        |  4 |      3 |      nan |       -3 |</span>
<span class="sd">        +----+--------+----------+----------+</span>

<span class="sd">        &gt;&gt;&gt; left_df.merge(right_df, on = &quot;col1&quot;, how = &quot;right&quot;)</span>

<span class="sd">        +----+--------+----------+----------+</span>
<span class="sd">        |    |   col1 |   col2_x |   col2_y |</span>
<span class="sd">        +====+========+==========+==========+</span>
<span class="sd">        |  0 |      0 |        0 |        0 |</span>
<span class="sd">        +----+--------+----------+----------+</span>
<span class="sd">        |  1 |      2 |       -2 |        2 |</span>
<span class="sd">        +----+--------+----------+----------+</span>
<span class="sd">        |  2 |      4 |       -4 |        4 |</span>
<span class="sd">        +----+--------+----------+----------+</span>
<span class="sd">        |  3 |      6 |      nan |        6 |</span>
<span class="sd">        +----+--------+----------+----------+</span>
<span class="sd">        |  4 |      8 |      nan |        8 |</span>
<span class="sd">        +----+--------+----------+----------+</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">merge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">on</span><span class="p">,</span> <span class="n">how</span><span class="p">,</span> <span class="n">left_suffix</span><span class="p">,</span> <span class="n">right_suffix</span><span class="p">)</span></div>


<div class="viewcode-block" id="DataFrame.register">
<a class="viewcode-back" href="../../autoapi/arkouda/index.html#arkouda.dataframe.DataFrame.register">[docs]</a>
    <span class="nd">@typechecked</span>
    <span class="k">def</span> <span class="nf">register</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_defined_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Register this DataFrame object and underlying components with the Arkouda server.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        user_defined_name : str</span>
<span class="sd">            User defined name the DataFrame is to be registered under.</span>
<span class="sd">            This will be the root name for underlying components.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        arkouda.dataframe.DataFrame</span>
<span class="sd">            The same DataFrame which is now registered with the arkouda server and has an updated name.</span>
<span class="sd">            This is an in-place modification, the original is returned to support a</span>
<span class="sd">            fluid programming style.</span>
<span class="sd">            Please note you cannot register two different DataFrames with the same name.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        TypeError</span>
<span class="sd">            Raised if user_defined_name is not a str.</span>
<span class="sd">        RegistrationError</span>
<span class="sd">            If the server was unable to register the DataFrame with the user_defined_name.</span>

<span class="sd">        See also</span>
<span class="sd">        --------</span>
<span class="sd">        unregister</span>
<span class="sd">        attach</span>
<span class="sd">        unregister_dataframe_by_name</span>
<span class="sd">        is_registered</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Objects registered with the server are immune to deletion until</span>
<span class="sd">        they are unregistered.</span>

<span class="sd">        Any changes made to a DataFrame object after registering with the server may not be reflected</span>
<span class="sd">        in attached copies.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>

<span class="sd">        &gt;&gt;&gt; df = ak.DataFrame({&#39;col1&#39;: [1, 2, 3], &#39;col2&#39;: [4, 5, 6]})</span>
<span class="sd">        &gt;&gt;&gt; df.register(&quot;my_table_name&quot;)</span>
<span class="sd">        &gt;&gt;&gt; df.attach(&quot;my_table_name&quot;)</span>
<span class="sd">        &gt;&gt;&gt; df.is_registered()</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; df.unregister()</span>
<span class="sd">        &gt;&gt;&gt; df.is_registered()</span>
<span class="sd">        False</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">arkouda.categorical</span> <span class="kn">import</span> <span class="n">Categorical</span> <span class="k">as</span> <span class="n">Categorical_</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">registered_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_registered</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">RegistrationError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;This object is already registered as </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">registered_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">column_data</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">name</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="p">(</span><span class="n">Categorical_</span><span class="p">,</span> <span class="n">SegArray</span><span class="p">,</span> <span class="n">BitVector</span><span class="p">))</span>
            <span class="k">else</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="s2">&quot;codes&quot;</span><span class="p">:</span> <span class="n">obj</span><span class="o">.</span><span class="n">codes</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                    <span class="s2">&quot;categories&quot;</span><span class="p">:</span> <span class="n">obj</span><span class="o">.</span><span class="n">categories</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                    <span class="s2">&quot;NA_codes&quot;</span><span class="p">:</span> <span class="n">obj</span><span class="o">.</span><span class="n">_akNAcode</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                    <span class="o">**</span><span class="p">({</span><span class="s2">&quot;permutation&quot;</span><span class="p">:</span> <span class="n">obj</span><span class="o">.</span><span class="n">permutation</span><span class="o">.</span><span class="n">name</span><span class="p">}</span> <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">permutation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">{}),</span>
                    <span class="o">**</span><span class="p">({</span><span class="s2">&quot;segments&quot;</span><span class="p">:</span> <span class="n">obj</span><span class="o">.</span><span class="n">segments</span><span class="o">.</span><span class="n">name</span><span class="p">}</span> <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">segments</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">{}),</span>
                <span class="p">}</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">Categorical_</span><span class="p">)</span>
            <span class="k">else</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">({</span><span class="s2">&quot;segments&quot;</span><span class="p">:</span> <span class="n">obj</span><span class="o">.</span><span class="n">segments</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;values&quot;</span><span class="p">:</span> <span class="n">obj</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">name</span><span class="p">})</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">SegArray</span><span class="p">)</span>
            <span class="k">else</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                    <span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="n">obj</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
                    <span class="s2">&quot;reverse&quot;</span><span class="p">:</span> <span class="n">obj</span><span class="o">.</span><span class="n">reverse</span><span class="p">,</span>
                <span class="p">}</span>  <span class="c1"># BitVector Case</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        <span class="p">]</span>

        <span class="n">col_objTypes</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">special_objType</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;special_objType&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="n">obj</span><span class="o">.</span><span class="n">objType</span>
            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        <span class="p">]</span>

        <span class="n">generic_msg</span><span class="p">(</span>
            <span class="n">cmd</span><span class="o">=</span><span class="s2">&quot;register&quot;</span><span class="p">,</span>
            <span class="n">args</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">user_defined_name</span><span class="p">,</span>
                <span class="s2">&quot;objType&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">objType</span><span class="p">,</span>
                <span class="s2">&quot;idx&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="s2">&quot;num_cols&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">),</span>
                <span class="s2">&quot;column_names&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                <span class="s2">&quot;columns&quot;</span><span class="p">:</span> <span class="n">column_data</span><span class="p">,</span>
                <span class="s2">&quot;col_objTypes&quot;</span><span class="p">:</span> <span class="n">col_objTypes</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">registered_name</span> <span class="o">=</span> <span class="n">user_defined_name</span>
        <span class="k">return</span> <span class="bp">self</span></div>


<div class="viewcode-block" id="DataFrame.unregister">
<a class="viewcode-back" href="../../autoapi/arkouda/index.html#arkouda.dataframe.DataFrame.unregister">[docs]</a>
    <span class="k">def</span> <span class="nf">unregister</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Unregister this DataFrame object in the arkouda server which was previously</span>
<span class="sd">        registered using register() and/or attached to using attach().</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RegistrationError</span>
<span class="sd">            If the object is already unregistered or if there is a server error</span>
<span class="sd">            when attempting to unregister.</span>

<span class="sd">        See also</span>
<span class="sd">        --------</span>
<span class="sd">        register</span>
<span class="sd">        attach</span>
<span class="sd">        unregister_dataframe_by_name</span>
<span class="sd">        is_registered</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Objects registered with the server are immune to deletion until</span>
<span class="sd">        they are unregistered.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>

<span class="sd">        &gt;&gt;&gt; df = ak.DataFrame({&#39;col1&#39;: [1, 2, 3], &#39;col2&#39;: [4, 5, 6]})</span>
<span class="sd">        &gt;&gt;&gt; df.register(&quot;my_table_name&quot;)</span>
<span class="sd">        &gt;&gt;&gt; df.attach(&quot;my_table_name&quot;)</span>
<span class="sd">        &gt;&gt;&gt; df.is_registered()</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; df.unregister()</span>
<span class="sd">        &gt;&gt;&gt; df.is_registered()</span>
<span class="sd">        False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">arkouda.util</span> <span class="kn">import</span> <span class="n">unregister</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">registered_name</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">RegistrationError</span><span class="p">(</span><span class="s2">&quot;This object is not registered&quot;</span><span class="p">)</span>
        <span class="n">unregister</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">registered_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">registered_name</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Clear our internal DataFrame object name</span></div>


<div class="viewcode-block" id="DataFrame.is_registered">
<a class="viewcode-back" href="../../autoapi/arkouda/index.html#arkouda.dataframe.DataFrame.is_registered">[docs]</a>
    <span class="k">def</span> <span class="nf">is_registered</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return True if the object is contained in the registry.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            Indicates if the object is contained in the registry.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RegistrationError</span>
<span class="sd">            Raised if there&#39;s a server-side error or a mismatch of registered components.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        register</span>
<span class="sd">        attach</span>
<span class="sd">        unregister</span>
<span class="sd">        unregister_dataframe_by_name</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Objects registered with the server are immune to deletion until</span>
<span class="sd">        they are unregistered.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>

<span class="sd">        &gt;&gt;&gt; df = ak.DataFrame({&#39;col1&#39;: [1, 2, 3], &#39;col2&#39;: [4, 5, 6]})</span>
<span class="sd">        &gt;&gt;&gt; df.register(&quot;my_table_name&quot;)</span>
<span class="sd">        &gt;&gt;&gt; df.attach(&quot;my_table_name&quot;)</span>
<span class="sd">        &gt;&gt;&gt; df.is_registered()</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; df.unregister()</span>
<span class="sd">        &gt;&gt;&gt; df.is_registered()</span>
<span class="sd">        False</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">arkouda.util</span> <span class="kn">import</span> <span class="n">is_registered</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">registered_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>  <span class="c1"># Dataframe cannot be registered as a component</span>
        <span class="k">return</span> <span class="n">is_registered</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">registered_name</span><span class="p">)</span></div>


<div class="viewcode-block" id="DataFrame.attach">
<a class="viewcode-back" href="../../autoapi/arkouda/index.html#arkouda.dataframe.DataFrame.attach">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">attach</span><span class="p">(</span><span class="n">user_defined_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function to return a DataFrame object attached to the registered name in the</span>
<span class="sd">        arkouda server which was registered using register().</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        user_defined_name : str</span>
<span class="sd">            user defined name which DataFrame object was registered under.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        arkouda.dataframe.DataFrame</span>
<span class="sd">               The DataFrame object created by re-attaching to the corresponding server components.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RegistrationError</span>
<span class="sd">            if user_defined_name is not registered</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        register, is_registered, unregister</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>

<span class="sd">        &gt;&gt;&gt; df = ak.DataFrame({&#39;col1&#39;: [1, 2, 3], &#39;col2&#39;: [4, 5, 6]})</span>
<span class="sd">        &gt;&gt;&gt; df.register(&quot;my_table_name&quot;)</span>
<span class="sd">        &gt;&gt;&gt; df.attach(&quot;my_table_name&quot;)</span>
<span class="sd">        &gt;&gt;&gt; df.is_registered()</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; df.unregister()</span>
<span class="sd">        &gt;&gt;&gt; df.is_registered()</span>
<span class="sd">        False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">warnings</span>

        <span class="kn">from</span> <span class="nn">arkouda.util</span> <span class="kn">import</span> <span class="n">attach</span>

        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;ak.DataFrame.attach() is deprecated. Please use ak.attach() instead.&quot;</span><span class="p">,</span>
            <span class="ne">DeprecationWarning</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">attach</span><span class="p">(</span><span class="n">user_defined_name</span><span class="p">)</span></div>


<div class="viewcode-block" id="DataFrame.unregister_dataframe_by_name">
<a class="viewcode-back" href="../../autoapi/arkouda/index.html#arkouda.dataframe.DataFrame.unregister_dataframe_by_name">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="nd">@typechecked</span>
    <span class="k">def</span> <span class="nf">unregister_dataframe_by_name</span><span class="p">(</span><span class="n">user_defined_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function to unregister DataFrame object by name which was registered</span>
<span class="sd">        with the arkouda server via register().</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        user_defined_name : str</span>
<span class="sd">            Name under which the DataFrame object was registered.</span>

<span class="sd">        Raises</span>
<span class="sd">        -------</span>
<span class="sd">        TypeError</span>
<span class="sd">            If user_defined_name is not a string.</span>
<span class="sd">        RegistrationError</span>
<span class="sd">            If there is an issue attempting to unregister any underlying components.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        register</span>
<span class="sd">        unregister</span>
<span class="sd">        attach</span>
<span class="sd">        is_registered</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>

<span class="sd">        &gt;&gt;&gt; df = ak.DataFrame({&#39;col1&#39;: [1, 2, 3], &#39;col2&#39;: [4, 5, 6]})</span>
<span class="sd">        &gt;&gt;&gt; df.register(&quot;my_table_name&quot;)</span>
<span class="sd">        &gt;&gt;&gt; df.attach(&quot;my_table_name&quot;)</span>
<span class="sd">        &gt;&gt;&gt; df.is_registered()</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; df.unregister_dataframe_by_name(&quot;my_table_name&quot;)</span>
<span class="sd">        &gt;&gt;&gt; df.is_registered()</span>
<span class="sd">        False</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">warnings</span>

        <span class="kn">from</span> <span class="nn">arkouda.util</span> <span class="kn">import</span> <span class="n">unregister</span>

        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;ak.DataFrame.unregister_dataframe_by_name() is deprecated. &quot;</span>
            <span class="s2">&quot;Please use ak.unregister() instead.&quot;</span><span class="p">,</span>
            <span class="ne">DeprecationWarning</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">unregister</span><span class="p">(</span><span class="n">user_defined_name</span><span class="p">)</span></div>


    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_parse_col_name</span><span class="p">(</span><span class="n">entryName</span><span class="p">,</span> <span class="n">dfName</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Helper method used by from_return_msg to parse the registered name of the data component</span>
<span class="sd">        and pull out the column type and column name</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        entryName : string</span>
<span class="sd">            The full registered name of the data component</span>

<span class="sd">        dfName : string</span>
<span class="sd">            The name of the DataFrame</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tuple</span>
<span class="sd">            (columnName, columnType)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nameParts</span> <span class="o">=</span> <span class="n">entryName</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
        <span class="n">regName</span> <span class="o">=</span> <span class="n">nameParts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nameParts</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">nameParts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">colParts</span> <span class="o">=</span> <span class="n">regName</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>
        <span class="n">colType</span> <span class="o">=</span> <span class="n">colParts</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

        <span class="c1"># Case of &#39;_&#39; in the column or dataframe name</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">colParts</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
            <span class="n">nameInd</span> <span class="o">=</span> <span class="n">regName</span><span class="o">.</span><span class="n">rindex</span><span class="p">(</span><span class="n">dfName</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="n">startInd</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">colType</span><span class="p">)</span> <span class="o">+</span> <span class="mi">9</span>
            <span class="k">return</span> <span class="n">regName</span><span class="p">[</span><span class="n">startInd</span><span class="p">:</span><span class="n">nameInd</span><span class="p">],</span> <span class="n">colType</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">colParts</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">colType</span>

<div class="viewcode-block" id="DataFrame.from_return_msg">
<a class="viewcode-back" href="../../autoapi/arkouda/index.html#arkouda.dataframe.DataFrame.from_return_msg">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_return_msg</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">rep_msg</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a DataFrame object from an arkouda server response message.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        rep_msg : string</span>
<span class="sd">            Server response message used to create a DataFrame.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        arkouda.dataframe.DataFrame</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">arkouda.categorical</span> <span class="kn">import</span> <span class="n">Categorical</span> <span class="k">as</span> <span class="n">Categorical_</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">rep_msg</span><span class="p">)</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">create_data</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">comps</span> <span class="o">=</span> <span class="n">create_data</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;+|+&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;index&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">comps</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">Strings</span><span class="o">.</span><span class="n">objType</span><span class="o">.</span><span class="n">upper</span><span class="p">():</span>
                    <span class="n">idx</span> <span class="o">=</span> <span class="n">Index</span><span class="p">(</span><span class="n">Strings</span><span class="o">.</span><span class="n">from_return_msg</span><span class="p">(</span><span class="n">comps</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">idx</span> <span class="o">=</span> <span class="n">Index</span><span class="p">(</span><span class="n">create_pdarray</span><span class="p">(</span><span class="n">comps</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">comps</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">pdarray</span><span class="o">.</span><span class="n">objType</span><span class="o">.</span><span class="n">upper</span><span class="p">():</span>
                    <span class="n">columns</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">create_pdarray</span><span class="p">(</span><span class="n">comps</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">elif</span> <span class="n">comps</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">Strings</span><span class="o">.</span><span class="n">objType</span><span class="o">.</span><span class="n">upper</span><span class="p">():</span>
                    <span class="n">columns</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">Strings</span><span class="o">.</span><span class="n">from_return_msg</span><span class="p">(</span><span class="n">comps</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">elif</span> <span class="n">comps</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">IPv4</span><span class="o">.</span><span class="n">special_objType</span><span class="o">.</span><span class="n">upper</span><span class="p">():</span>
                    <span class="n">columns</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">IPv4</span><span class="p">(</span><span class="n">create_pdarray</span><span class="p">(</span><span class="n">comps</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                <span class="k">elif</span> <span class="n">comps</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">Datetime</span><span class="o">.</span><span class="n">special_objType</span><span class="o">.</span><span class="n">upper</span><span class="p">():</span>
                    <span class="n">columns</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">Datetime</span><span class="p">(</span><span class="n">create_pdarray</span><span class="p">(</span><span class="n">comps</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                <span class="k">elif</span> <span class="n">comps</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">Timedelta</span><span class="o">.</span><span class="n">special_objType</span><span class="o">.</span><span class="n">upper</span><span class="p">():</span>
                    <span class="n">columns</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">Timedelta</span><span class="p">(</span><span class="n">create_pdarray</span><span class="p">(</span><span class="n">comps</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                <span class="k">elif</span> <span class="n">comps</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">Categorical_</span><span class="o">.</span><span class="n">objType</span><span class="o">.</span><span class="n">upper</span><span class="p">():</span>
                    <span class="n">columns</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">Categorical_</span><span class="o">.</span><span class="n">from_return_msg</span><span class="p">(</span><span class="n">comps</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">elif</span> <span class="n">comps</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">SegArray</span><span class="o">.</span><span class="n">objType</span><span class="o">.</span><span class="n">upper</span><span class="p">():</span>
                    <span class="n">columns</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">SegArray</span><span class="o">.</span><span class="n">from_return_msg</span><span class="p">(</span><span class="n">comps</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">elif</span> <span class="n">comps</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">BitVector</span><span class="o">.</span><span class="n">special_objType</span><span class="o">.</span><span class="n">upper</span><span class="p">():</span>
                    <span class="n">columns</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">BitVector</span><span class="o">.</span><span class="n">from_return_msg</span><span class="p">(</span><span class="n">comps</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="intx">
<a class="viewcode-back" href="../../autoapi/arkouda/index.html#arkouda.dataframe.intx">[docs]</a>
<span class="k">def</span> <span class="nf">intx</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Find all the rows that are in both dataframes.</span>
<span class="sd">    Columns should be in identical order.</span>

<span class="sd">    Note: does not work for columns of floating point values, but does work for</span>
<span class="sd">    Strings, pdarrays of int64 type, and Categorical *should* work.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    &gt;&gt;&gt; import arkouda as ak</span>
<span class="sd">    &gt;&gt;&gt; ak.connect()</span>
<span class="sd">    &gt;&gt;&gt; a = ak.DataFrame({&#39;a&#39;:ak.arange(5),&#39;b&#39;: 2* ak.arange(5)})</span>
<span class="sd">    &gt;&gt;&gt; display(a)</span>

<span class="sd">    +----+-----+-----+</span>
<span class="sd">    |    |   a |   b |</span>
<span class="sd">    +====+=====+=====+</span>
<span class="sd">    |  0 |   0 |   0 |</span>
<span class="sd">    +----+-----+-----+</span>
<span class="sd">    |  1 |   1 |   2 |</span>
<span class="sd">    +----+-----+-----+</span>
<span class="sd">    |  2 |   2 |   4 |</span>
<span class="sd">    +----+-----+-----+</span>
<span class="sd">    |  3 |   3 |   6 |</span>
<span class="sd">    +----+-----+-----+</span>
<span class="sd">    |  4 |   4 |   8 |</span>
<span class="sd">    +----+-----+-----+</span>

<span class="sd">    &gt;&gt;&gt; b = ak.DataFrame({&#39;a&#39;:ak.arange(5),&#39;b&#39;:ak.array([0,3,4,7,8])})</span>
<span class="sd">    &gt;&gt;&gt; display(b)</span>

<span class="sd">    +----+-----+-----+</span>
<span class="sd">    |    |   a |   b |</span>
<span class="sd">    +====+=====+=====+</span>
<span class="sd">    |  0 |   0 |   0 |</span>
<span class="sd">    +----+-----+-----+</span>
<span class="sd">    |  1 |   1 |   3 |</span>
<span class="sd">    +----+-----+-----+</span>
<span class="sd">    |  2 |   2 |   4 |</span>
<span class="sd">    +----+-----+-----+</span>
<span class="sd">    |  3 |   3 |   7 |</span>
<span class="sd">    +----+-----+-----+</span>
<span class="sd">    |  4 |   4 |   8 |</span>
<span class="sd">    +----+-----+-----+</span>

<span class="sd">    &gt;&gt;&gt; intx(a,b)</span>
<span class="sd">    &gt;&gt;&gt; intersect_df = a[intx(a,b)]</span>
<span class="sd">    &gt;&gt;&gt; display(intersect_df)</span>

<span class="sd">    +----+-----+-----+</span>
<span class="sd">    |    |   a |   b |</span>
<span class="sd">    +====+=====+=====+</span>
<span class="sd">    |  0 |   0 |   0 |</span>
<span class="sd">    +----+-----+-----+</span>
<span class="sd">    |  1 |   2 |   4 |</span>
<span class="sd">    +----+-----+-----+</span>
<span class="sd">    |  2 |   4 |   8 |</span>
<span class="sd">    +----+-----+-----+</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">list</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">data</span><span class="p">):</span>
        <span class="n">a_cols</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">b_cols</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">a</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span> <span class="o">!=</span> <span class="s2">&quot;index&quot;</span><span class="p">:</span>
                <span class="n">a_cols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">b</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span> <span class="o">!=</span> <span class="s2">&quot;index&quot;</span><span class="p">:</span>
                <span class="n">b_cols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">in1d</span><span class="p">(</span><span class="n">a_cols</span><span class="p">,</span> <span class="n">b_cols</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Column mismatch.&quot;</span><span class="p">)</span></div>



<div class="viewcode-block" id="intersect">
<a class="viewcode-back" href="../../autoapi/arkouda/index.html#arkouda.dataframe.intersect">[docs]</a>
<span class="k">def</span> <span class="nf">intersect</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">positions</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Find the intersection of two arkouda arrays.</span>

<span class="sd">    This function can be especially useful when `positions=True` so</span>
<span class="sd">    that the caller gets the indices of values present in both arrays.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : Strings or pdarray</span>
<span class="sd">        An array of strings.</span>

<span class="sd">    b : Strings or pdarray</span>
<span class="sd">        An array of strings.</span>

<span class="sd">    positions : bool, default=True</span>
<span class="sd">        Return tuple of boolean pdarrays that indicate positions in `a` and `b`</span>
<span class="sd">        of the intersection values.</span>

<span class="sd">    unique : bool, default=False</span>
<span class="sd">        If the number of distinct values in `a` (and `b`) is equal to the size of</span>
<span class="sd">        `a` (and `b`), there is a more efficient method to compute the intersection.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    (arkouda.pdarrayclass.pdarray, arkouda.pdarrayclass.pdarray) or arkouda.pdarrayclass.pdarray</span>
<span class="sd">        The indices of `a` and `b` where any element occurs at least once in both</span>
<span class="sd">        arrays.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    &gt;&gt;&gt; import arkouda as ak</span>
<span class="sd">    &gt;&gt;&gt; ak.connect()</span>
<span class="sd">    &gt;&gt;&gt; a = ak.arange(10)</span>
<span class="sd">    &gt;&gt;&gt; print(a)</span>
<span class="sd">    [0 1 2 3 4 5 6 7 8 9]</span>

<span class="sd">    &gt;&gt;&gt; b = 2 * ak.arange(10)</span>
<span class="sd">    &gt;&gt;&gt; print(b)</span>
<span class="sd">    [0 2 4 6 8 10 12 14 16 18]</span>

<span class="sd">    &gt;&gt;&gt; intersect(a,b, positions=True)</span>
<span class="sd">    (array([True False True False True False True False True False]),</span>
<span class="sd">    array([True True True True True False False False False False]))</span>

<span class="sd">    &gt;&gt;&gt; intersect(a,b, positions=False)</span>
<span class="sd">    array([0 2 4 6 8])</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># To ensure compatibility with all types of arrays:</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">pdarray</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">pdarray</span><span class="p">):</span>
        <span class="n">intx</span> <span class="o">=</span> <span class="n">intersect1d</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">positions</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">intx</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">maska</span> <span class="o">=</span> <span class="n">in1d</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">intx</span><span class="p">)</span>
            <span class="n">maskb</span> <span class="o">=</span> <span class="n">in1d</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">intx</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">maska</span><span class="p">,</span> <span class="n">maskb</span><span class="p">)</span>

    <span class="c1"># It takes more effort to do this with ak.Strings arrays.</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">Strings</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">Strings</span><span class="p">):</span>
        <span class="c1"># Hash the two arrays first</span>
        <span class="n">hash_a00</span><span class="p">,</span> <span class="n">hash_a01</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">hash</span><span class="p">()</span>
        <span class="n">hash_b00</span><span class="p">,</span> <span class="n">hash_b01</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">hash</span><span class="p">()</span>

        <span class="c1"># a and b do not have duplicate entries, so the hashes are distinct</span>
        <span class="k">if</span> <span class="n">unique</span><span class="p">:</span>
            <span class="n">hash0</span> <span class="o">=</span> <span class="n">concatenate</span><span class="p">([</span><span class="n">hash_a00</span><span class="p">,</span> <span class="n">hash_b00</span><span class="p">])</span>
            <span class="n">hash1</span> <span class="o">=</span> <span class="n">concatenate</span><span class="p">([</span><span class="n">hash_a01</span><span class="p">,</span> <span class="n">hash_b01</span><span class="p">])</span>

            <span class="c1"># Group by the unique hashes</span>
            <span class="n">gb</span> <span class="o">=</span> <span class="n">akGroupBy</span><span class="p">([</span><span class="n">hash0</span><span class="p">,</span> <span class="n">hash1</span><span class="p">])</span>
            <span class="n">val</span><span class="p">,</span> <span class="n">cnt</span> <span class="o">=</span> <span class="n">gb</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>

            <span class="c1"># Hash counts, in groupby order</span>
            <span class="n">counts</span> <span class="o">=</span> <span class="n">gb</span><span class="o">.</span><span class="n">broadcast</span><span class="p">(</span><span class="n">cnt</span><span class="p">,</span> <span class="n">permute</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

            <span class="c1"># Same, in original order</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="n">counts</span><span class="p">[:]</span>
            <span class="n">counts</span><span class="p">[</span><span class="n">gb</span><span class="o">.</span><span class="n">permutation</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp</span>
            <span class="k">del</span> <span class="n">tmp</span>

            <span class="c1"># Masks</span>
            <span class="n">maska</span> <span class="o">=</span> <span class="p">(</span><span class="n">counts</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)[:</span> <span class="n">a</span><span class="o">.</span><span class="n">size</span><span class="p">]</span>
            <span class="n">maskb</span> <span class="o">=</span> <span class="p">(</span><span class="n">counts</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)[</span><span class="n">a</span><span class="o">.</span><span class="n">size</span> <span class="p">:]</span>

            <span class="c1"># The intersection for each array of hash values</span>
            <span class="k">if</span> <span class="n">positions</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">(</span><span class="n">maska</span><span class="p">,</span> <span class="n">maskb</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">a</span><span class="p">[</span><span class="n">maska</span><span class="p">]</span>

        <span class="c1"># a and b may have duplicate entries, so get the unique hash values</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">gba</span> <span class="o">=</span> <span class="n">akGroupBy</span><span class="p">([</span><span class="n">hash_a00</span><span class="p">,</span> <span class="n">hash_a01</span><span class="p">])</span>
            <span class="n">gbb</span> <span class="o">=</span> <span class="n">akGroupBy</span><span class="p">([</span><span class="n">hash_b00</span><span class="p">,</span> <span class="n">hash_b01</span><span class="p">])</span>

            <span class="c1"># Take the unique keys as the hash we&#39;ll work with</span>
            <span class="n">a0</span><span class="p">,</span> <span class="n">a1</span> <span class="o">=</span> <span class="n">gba</span><span class="o">.</span><span class="n">unique_keys</span>
            <span class="n">b0</span><span class="p">,</span> <span class="n">b1</span> <span class="o">=</span> <span class="n">gbb</span><span class="o">.</span><span class="n">unique_keys</span>
            <span class="n">hash0</span> <span class="o">=</span> <span class="n">concatenate</span><span class="p">([</span><span class="n">a0</span><span class="p">,</span> <span class="n">b0</span><span class="p">])</span>
            <span class="n">hash1</span> <span class="o">=</span> <span class="n">concatenate</span><span class="p">([</span><span class="n">a1</span><span class="p">,</span> <span class="n">b1</span><span class="p">])</span>

            <span class="c1"># Group by the unique hashes</span>
            <span class="n">gb</span> <span class="o">=</span> <span class="n">akGroupBy</span><span class="p">([</span><span class="n">hash0</span><span class="p">,</span> <span class="n">hash1</span><span class="p">])</span>
            <span class="n">val</span><span class="p">,</span> <span class="n">cnt</span> <span class="o">=</span> <span class="n">gb</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>

            <span class="c1"># Hash counts, in groupby order</span>
            <span class="n">counts</span> <span class="o">=</span> <span class="n">gb</span><span class="o">.</span><span class="n">broadcast</span><span class="p">(</span><span class="n">cnt</span><span class="p">,</span> <span class="n">permute</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

            <span class="c1"># Restore the original order</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="n">counts</span><span class="p">[:]</span>
            <span class="n">counts</span><span class="p">[</span><span class="n">gb</span><span class="o">.</span><span class="n">permutation</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp</span>
            <span class="k">del</span> <span class="n">tmp</span>

            <span class="c1"># Broadcast back up one more level</span>
            <span class="n">countsa</span> <span class="o">=</span> <span class="n">counts</span><span class="p">[:</span> <span class="n">a0</span><span class="o">.</span><span class="n">size</span><span class="p">]</span>
            <span class="n">countsb</span> <span class="o">=</span> <span class="n">counts</span><span class="p">[</span><span class="n">a0</span><span class="o">.</span><span class="n">size</span> <span class="p">:]</span>
            <span class="n">counts2a</span> <span class="o">=</span> <span class="n">gba</span><span class="o">.</span><span class="n">broadcast</span><span class="p">(</span><span class="n">countsa</span><span class="p">,</span> <span class="n">permute</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">counts2b</span> <span class="o">=</span> <span class="n">gbb</span><span class="o">.</span><span class="n">broadcast</span><span class="p">(</span><span class="n">countsb</span><span class="p">,</span> <span class="n">permute</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

            <span class="c1"># Restore the original orders</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="n">counts2a</span><span class="p">[:]</span>
            <span class="n">counts2a</span><span class="p">[</span><span class="n">gba</span><span class="o">.</span><span class="n">permutation</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp</span>
            <span class="k">del</span> <span class="n">tmp</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="n">counts2b</span><span class="p">[:]</span>
            <span class="n">counts2b</span><span class="p">[</span><span class="n">gbb</span><span class="o">.</span><span class="n">permutation</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp</span>
            <span class="k">del</span> <span class="n">tmp</span>

            <span class="c1"># Masks</span>
            <span class="n">maska</span> <span class="o">=</span> <span class="n">counts2a</span> <span class="o">&gt;</span> <span class="mi">1</span>
            <span class="n">maskb</span> <span class="o">=</span> <span class="n">counts2b</span> <span class="o">&gt;</span> <span class="mi">1</span>

            <span class="c1"># The intersection for each array of hash values</span>
            <span class="k">if</span> <span class="n">positions</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">(</span><span class="n">maska</span><span class="p">,</span> <span class="n">maskb</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">a</span><span class="p">[</span><span class="n">maska</span><span class="p">]</span></div>



<div class="viewcode-block" id="invert_permutation">
<a class="viewcode-back" href="../../autoapi/arkouda/index.html#arkouda.dataframe.invert_permutation">[docs]</a>
<span class="k">def</span> <span class="nf">invert_permutation</span><span class="p">(</span><span class="n">perm</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Find the inverse of a permutation array.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    perm : pdarray</span>
<span class="sd">        The permutation array.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    arkouda.pdarrayclass.pdarray</span>
<span class="sd">        The inverse of the permutation array.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    &gt;&gt;&gt; import arkouda as ak</span>
<span class="sd">    &gt;&gt;&gt; ak.connect()</span>
<span class="sd">    &gt;&gt;&gt; from arkouda.index import Index</span>
<span class="sd">    &gt;&gt;&gt; i = Index(ak.array([1,2,0,5,4]))</span>
<span class="sd">    &gt;&gt;&gt; perm = i.argsort()</span>
<span class="sd">    &gt;&gt;&gt; print(perm)</span>
<span class="sd">    [2 0 1 4 3]</span>
<span class="sd">    &gt;&gt;&gt; invert_permutation(perm)</span>
<span class="sd">    array([1 2 0 4 3])</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Test if the array is actually a permutation</span>
    <span class="n">rng</span> <span class="o">=</span> <span class="n">perm</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">perm</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">unique</span><span class="p">(</span><span class="n">perm</span><span class="p">)</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">perm</span><span class="o">.</span><span class="n">size</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">perm</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">rng</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The array is not a permutation.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">coargsort</span><span class="p">([</span><span class="n">perm</span><span class="p">,</span> <span class="n">arange</span><span class="p">(</span><span class="n">perm</span><span class="o">.</span><span class="n">size</span><span class="p">)])</span></div>



<span class="nd">@typechecked</span>
<span class="k">def</span> <span class="nf">_inner_join_merge</span><span class="p">(</span>
    <span class="n">left</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">right</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">on</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">col_intersect</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">left_suffix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;_x&quot;</span><span class="p">,</span>
    <span class="n">right_suffix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;_y&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Utilizes the ak.join.inner_join function to return an ak</span>
<span class="sd">    DataFrame object containing only rows that are in both</span>
<span class="sd">    the left and right Dataframes, (based on the &quot;on&quot; param),</span>
<span class="sd">    as well as their associated values.</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    left: DataFrame</span>
<span class="sd">        The Left DataFrame to be joined</span>
<span class="sd">    right: DataFrame</span>
<span class="sd">        The Right DataFrame to be joined</span>
<span class="sd">    on: Optional[Union[str, List[str]]] = None</span>
<span class="sd">        The name or list of names of the DataFrame column(s) to join on.</span>
<span class="sd">        If on is None, this defaults to the intersection of the columns in both DataFrames.</span>
<span class="sd">    left_suffix: str = &quot;_x&quot;</span>
<span class="sd">        A string indicating the suffix to add to columns from the left dataframe for overlapping</span>
<span class="sd">        column names in both left and right. Defaults to &quot;_x&quot;</span>
<span class="sd">    right_suffix: str = &quot;_y&quot;</span>
<span class="sd">        A string indicating the suffix to add to columns from the right dataframe for overlapping</span>
<span class="sd">        column names in both left and right. Defaults to &quot;_y&quot;</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    arkouda.dataframe.DataFrame</span>
<span class="sd">        Inner-Joined Arkouda DataFrame</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">left_cols</span><span class="p">,</span> <span class="n">right_cols</span> <span class="o">=</span> <span class="n">left</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">right</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">on</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">left_inds</span><span class="p">,</span> <span class="n">right_inds</span> <span class="o">=</span> <span class="n">inner_join</span><span class="p">(</span><span class="n">left</span><span class="p">[</span><span class="n">on</span><span class="p">],</span> <span class="n">right</span><span class="p">[</span><span class="n">on</span><span class="p">])</span>
        <span class="n">new_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">on</span><span class="p">:</span> <span class="n">left</span><span class="p">[</span><span class="n">on</span><span class="p">][</span><span class="n">left_inds</span><span class="p">]}</span>
        <span class="n">left_cols</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">on</span><span class="p">)</span>
        <span class="n">right_cols</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">on</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">left_inds</span><span class="p">,</span> <span class="n">right_inds</span> <span class="o">=</span> <span class="n">inner_join</span><span class="p">([</span><span class="n">left</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">on</span><span class="p">],</span> <span class="p">[</span><span class="n">right</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">on</span><span class="p">])</span>
        <span class="n">new_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">col</span><span class="p">:</span> <span class="n">left</span><span class="p">[</span><span class="n">col</span><span class="p">][</span><span class="n">left_inds</span><span class="p">]</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">on</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">on</span><span class="p">:</span>
            <span class="n">left_cols</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
            <span class="n">right_cols</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">left_cols</span><span class="p">:</span>
        <span class="n">new_col</span> <span class="o">=</span> <span class="n">col</span> <span class="o">+</span> <span class="n">left_suffix</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">col_intersect</span> <span class="k">else</span> <span class="n">col</span>
        <span class="n">new_dict</span><span class="p">[</span><span class="n">new_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">left</span><span class="p">[</span><span class="n">col</span><span class="p">][</span><span class="n">left_inds</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">right_cols</span><span class="p">:</span>
        <span class="n">new_col</span> <span class="o">=</span> <span class="n">col</span> <span class="o">+</span> <span class="n">right_suffix</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">col_intersect</span> <span class="k">else</span> <span class="n">col</span>
        <span class="n">new_dict</span><span class="p">[</span><span class="n">new_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">right</span><span class="p">[</span><span class="n">col</span><span class="p">][</span><span class="n">right_inds</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">new_dict</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_right_join_merge</span><span class="p">(</span>
    <span class="n">left</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">right</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">on</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">col_intersect</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">left_suffix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;_x&quot;</span><span class="p">,</span>
    <span class="n">right_suffix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;_y&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Utilizes the ak.join.inner_join_merge function to return an</span>
<span class="sd">    ak DataFrame object containing all the rows in the right Dataframe,</span>
<span class="sd">    as well as corresponding rows in the left (based on the &quot;on&quot; param),</span>
<span class="sd">    and all of their associated values.</span>
<span class="sd">    Based on pandas merge functionality.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    left: DataFrame</span>
<span class="sd">        The Left DataFrame to be joined</span>
<span class="sd">    right: DataFrame</span>
<span class="sd">        The Right DataFrame to be joined</span>
<span class="sd">    on: Optional[Union[str, List[str]]] = None</span>
<span class="sd">        The name or list of names of the DataFrame column(s) to join on.</span>
<span class="sd">        If on is None, this defaults to the intersection of the columns in both DataFrames.</span>
<span class="sd">    left_suffix: str = &quot;_x&quot;</span>
<span class="sd">        A string indicating the suffix to add to columns from the left dataframe for overlapping</span>
<span class="sd">        column names in both left and right. Defaults to &quot;_x&quot;</span>
<span class="sd">    right_suffix: str = &quot;_y&quot;</span>
<span class="sd">        A string indicating the suffix to add to columns from the right dataframe for overlapping</span>
<span class="sd">        column names in both left and right. Defaults to &quot;_y&quot;</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    arkouda.dataframe.DataFrame</span>
<span class="sd">        Right-Joined Arkouda DataFrame</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">in_left</span> <span class="o">=</span> <span class="n">_inner_join_merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">on</span><span class="p">,</span> <span class="n">col_intersect</span><span class="p">,</span> <span class="n">left_suffix</span><span class="p">,</span> <span class="n">right_suffix</span><span class="p">)</span>
    <span class="n">in_left_cols</span><span class="p">,</span> <span class="n">left_cols</span> <span class="o">=</span> <span class="n">in_left</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">left</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">on</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">left_at_on</span> <span class="o">=</span> <span class="n">left</span><span class="p">[</span><span class="n">on</span><span class="p">]</span>
        <span class="n">right_at_on</span> <span class="o">=</span> <span class="n">right</span><span class="p">[</span><span class="n">on</span><span class="p">]</span>
        <span class="n">left_cols</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">on</span><span class="p">)</span>
        <span class="n">in_left_cols</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">on</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">left_at_on</span> <span class="o">=</span> <span class="p">[</span><span class="n">left</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">on</span><span class="p">]</span>
        <span class="n">right_at_on</span> <span class="o">=</span> <span class="p">[</span><span class="n">right</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">on</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">on</span><span class="p">:</span>
            <span class="n">left_cols</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
            <span class="n">in_left_cols</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>

    <span class="n">not_in_left</span> <span class="o">=</span> <span class="n">right</span><span class="p">[</span><span class="o">~</span><span class="n">in1d</span><span class="p">(</span><span class="n">right_at_on</span><span class="p">,</span> <span class="n">left_at_on</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">not_in_left</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">left_cols</span><span class="p">:</span>
            <span class="n">not_in_left</span><span class="p">[</span><span class="n">col</span> <span class="o">+</span> <span class="n">right_suffix</span><span class="p">]</span> <span class="o">=</span> <span class="n">not_in_left</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
            <span class="n">not_in_left</span> <span class="o">=</span> <span class="n">not_in_left</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">nan_cols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">in_left</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">in_left</span><span class="p">)</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">not_in_left</span><span class="p">)))</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">nan_cols</span><span class="p">:</span>
        <span class="c1"># Create a nan array for all values not in the left df</span>
        <span class="n">nan_arr</span> <span class="o">=</span> <span class="n">full</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">not_in_left</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">in_left</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="nb">int</span><span class="p">:</span>
            <span class="n">in_left</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">akcast</span><span class="p">(</span><span class="n">in_left</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">akfloat64</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nan_arr</span> <span class="o">=</span> <span class="n">akcast</span><span class="p">(</span><span class="n">nan_arr</span><span class="p">,</span> <span class="n">in_left</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
        <span class="n">not_in_left</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">nan_arr</span>
    <span class="k">return</span> <span class="n">DataFrame</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">in_left</span><span class="p">,</span> <span class="n">not_in_left</span><span class="p">)</span>


<div class="viewcode-block" id="merge">
<a class="viewcode-back" href="../../autoapi/arkouda/index.html#arkouda.dataframe.merge">[docs]</a>
<span class="nd">@typechecked</span>
<span class="k">def</span> <span class="nf">merge</span><span class="p">(</span>
    <span class="n">left</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">right</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">on</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">how</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;inner&quot;</span><span class="p">,</span>
    <span class="n">left_suffix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;_x&quot;</span><span class="p">,</span>
    <span class="n">right_suffix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;_y&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Merge Arkouda DataFrames with a database-style join.</span>
<span class="sd">    The resulting dataframe contains rows from both DataFrames as specified by</span>
<span class="sd">    the merge condition (based on the &quot;how&quot; and &quot;on&quot; parameters).</span>

<span class="sd">    Based on pandas merge functionality.</span>
<span class="sd">    https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.merge.html</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    left: DataFrame</span>
<span class="sd">        The Left DataFrame to be joined.</span>
<span class="sd">    right: DataFrame</span>
<span class="sd">        The Right DataFrame to be joined.</span>
<span class="sd">    on: Optional[Union[str, List[str]]] = None</span>
<span class="sd">        The name or list of names of the DataFrame column(s) to join on.</span>
<span class="sd">        If on is None, this defaults to the intersection of the columns in both DataFrames.</span>
<span class="sd">    how: str, default = &quot;inner&quot;</span>
<span class="sd">        The merge condition.</span>
<span class="sd">        Must be one of &quot;inner&quot;, &quot;left&quot;, or &quot;right&quot;.</span>
<span class="sd">    left_suffix: str, default = &quot;_x&quot;</span>
<span class="sd">        A string indicating the suffix to add to columns from the left dataframe for overlapping</span>
<span class="sd">        column names in both left and right. Defaults to &quot;_x&quot;. Only used when how is &quot;inner&quot;.</span>
<span class="sd">    right_suffix: str, default = &quot;_y&quot;</span>
<span class="sd">        A string indicating the suffix to add to columns from the right dataframe for overlapping</span>
<span class="sd">        column names in both left and right. Defaults to &quot;_y&quot;. Only used when how is &quot;inner&quot;.</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    arkouda.dataframe.DataFrame</span>
<span class="sd">        Joined Arkouda DataFrame.</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    Multiple column joins are only supported for integer columns.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    &gt;&gt;&gt; import arkouda as ak</span>
<span class="sd">    &gt;&gt;&gt; ak.connect()</span>
<span class="sd">    &gt;&gt;&gt; left_df = ak.DataFrame({&#39;col1&#39;: ak.arange(5), &#39;col2&#39;: -1 * ak.arange(5)})</span>
<span class="sd">    &gt;&gt;&gt; display(left_df)</span>

<span class="sd">    +----+--------+--------+</span>
<span class="sd">    |    |   col1 |   col2 |</span>
<span class="sd">    +====+========+========+</span>
<span class="sd">    |  0 |      0 |      0 |</span>
<span class="sd">    +----+--------+--------+</span>
<span class="sd">    |  1 |      1 |     -1 |</span>
<span class="sd">    +----+--------+--------+</span>
<span class="sd">    |  2 |      2 |     -2 |</span>
<span class="sd">    +----+--------+--------+</span>
<span class="sd">    |  3 |      3 |     -3 |</span>
<span class="sd">    +----+--------+--------+</span>
<span class="sd">    |  4 |      4 |     -4 |</span>
<span class="sd">    +----+--------+--------+</span>

<span class="sd">    &gt;&gt;&gt; right_df = ak.DataFrame({&#39;col1&#39;: 2 * ak.arange(5), &#39;col2&#39;: 2 * ak.arange(5)})</span>
<span class="sd">    &gt;&gt;&gt; display(right_df)</span>

<span class="sd">    +----+--------+--------+</span>
<span class="sd">    |    |   col1 |   col2 |</span>
<span class="sd">    +====+========+========+</span>
<span class="sd">    |  0 |      0 |      0 |</span>
<span class="sd">    +----+--------+--------+</span>
<span class="sd">    |  1 |      2 |      2 |</span>
<span class="sd">    +----+--------+--------+</span>
<span class="sd">    |  2 |      4 |      4 |</span>
<span class="sd">    +----+--------+--------+</span>
<span class="sd">    |  3 |      6 |      6 |</span>
<span class="sd">    +----+--------+--------+</span>
<span class="sd">    |  4 |      8 |      8 |</span>
<span class="sd">    +----+--------+--------+</span>

<span class="sd">    &gt;&gt;&gt; merge(left_df, right_df, on = &quot;col1&quot;)</span>

<span class="sd">    +----+--------+----------+----------+</span>
<span class="sd">    |    |   col1 |   col2_x |   col2_y |</span>
<span class="sd">    +====+========+==========+==========+</span>
<span class="sd">    |  0 |      0 |        0 |        0 |</span>
<span class="sd">    +----+--------+----------+----------+</span>
<span class="sd">    |  1 |      2 |       -2 |        2 |</span>
<span class="sd">    +----+--------+----------+----------+</span>
<span class="sd">    |  2 |      4 |       -4 |        4 |</span>
<span class="sd">    +----+--------+----------+----------+</span>

<span class="sd">    &gt;&gt;&gt; merge(left_df, right_df, on = &quot;col1&quot;, how = &quot;left&quot;)</span>

<span class="sd">    +----+--------+----------+----------+</span>
<span class="sd">    |    |   col1 |   col2_y |   col2_x |</span>
<span class="sd">    +====+========+==========+==========+</span>
<span class="sd">    |  0 |      0 |        0 |        0 |</span>
<span class="sd">    +----+--------+----------+----------+</span>
<span class="sd">    |  1 |      2 |        2 |       -2 |</span>
<span class="sd">    +----+--------+----------+----------+</span>
<span class="sd">    |  2 |      4 |        4 |       -4 |</span>
<span class="sd">    +----+--------+----------+----------+</span>
<span class="sd">    |  3 |      1 |      nan |       -1 |</span>
<span class="sd">    +----+--------+----------+----------+</span>
<span class="sd">    |  4 |      3 |      nan |       -3 |</span>
<span class="sd">    +----+--------+----------+----------+</span>

<span class="sd">    &gt;&gt;&gt; merge(left_df, right_df, on = &quot;col1&quot;, how = &quot;right&quot;)</span>

<span class="sd">    +----+--------+----------+----------+</span>
<span class="sd">    |    |   col1 |   col2_x |   col2_y |</span>
<span class="sd">    +====+========+==========+==========+</span>
<span class="sd">    |  0 |      0 |        0 |        0 |</span>
<span class="sd">    +----+--------+----------+----------+</span>
<span class="sd">    |  1 |      2 |       -2 |        2 |</span>
<span class="sd">    +----+--------+----------+----------+</span>
<span class="sd">    |  2 |      4 |       -4 |        4 |</span>
<span class="sd">    +----+--------+----------+----------+</span>
<span class="sd">    |  3 |      6 |      nan |        6 |</span>
<span class="sd">    +----+--------+----------+----------+</span>
<span class="sd">    |  4 |      8 |      nan |        8 |</span>
<span class="sd">    +----+--------+----------+----------+</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">col_intersect</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">left</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">right</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
    <span class="n">on</span> <span class="o">=</span> <span class="n">on</span> <span class="k">if</span> <span class="n">on</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">col_intersect</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">on</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span>
            <span class="nb">isinstance</span><span class="p">(</span><span class="n">left</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="p">(</span><span class="n">pdarray</span><span class="p">,</span> <span class="n">Strings</span><span class="p">))</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">right</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="p">(</span><span class="n">pdarray</span><span class="p">,</span> <span class="n">Strings</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">on</span>
        <span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;All columns of a multi-column merge must be pdarrays&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">how</span> <span class="o">==</span> <span class="s2">&quot;inner&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_inner_join_merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">on</span><span class="p">,</span> <span class="n">col_intersect</span><span class="p">,</span> <span class="n">left_suffix</span><span class="p">,</span> <span class="n">right_suffix</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">how</span> <span class="o">==</span> <span class="s2">&quot;right&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_right_join_merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">on</span><span class="p">,</span> <span class="n">col_intersect</span><span class="p">,</span> <span class="n">left_suffix</span><span class="p">,</span> <span class="n">right_suffix</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">how</span> <span class="o">==</span> <span class="s2">&quot;left&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_right_join_merge</span><span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">on</span><span class="p">,</span> <span class="n">col_intersect</span><span class="p">,</span> <span class="n">right_suffix</span><span class="p">,</span> <span class="n">left_suffix</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unexpected value of </span><span class="si">{</span><span class="n">how</span><span class="si">}</span><span class="s2"> for how. Must choose: &#39;inner&#39;, &#39;left&#39;, or &#39;right&#39;&quot;</span><span class="p">)</span></div>

</pre></div>
        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2020, Michael Merrill and William Reus
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=32e29ea5"></script>
    </body>
</html>